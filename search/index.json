[{"content":"å…¨å±€æ•°ç»„è¶Šç•Œè®¿é—®è¡Œä¸ºåˆ†ææŠ¥å‘Š ğŸ“‹ ç›®å½• é—®é¢˜èƒŒæ™¯ æµ‹è¯•ç¯å¢ƒ æµ‹è¯•è®¾è®¡ å®éªŒç»“æœ æ·±å…¥åˆ†æ å®‰å…¨æ€§è®¨è®º æœ€ä½³å®è·µå»ºè®® é™„å½• é—®é¢˜èƒŒæ™¯ åœ¨Cè¯­è¨€ç¼–ç¨‹ä¸­ï¼Œæ•°ç»„è¶Šç•Œè®¿é—®æ˜¯ä¸€ä¸ªå¸¸è§ä¸”å±é™©çš„é—®é¢˜ã€‚æœ¬æŠ¥å‘Šä¸“é—¨ç ”ç©¶ä»¥ä¸‹åœºæ™¯ï¼š\nç ”ç©¶é—®é¢˜ï¼šåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­å®šä¹‰ä¸¤ä¸ªå…¨å±€å­—ç¬¦æ•°ç»„Aã€Bï¼ˆå¤§å°å‡ä¸º10ï¼‰ï¼Œå½“æ•°ç»„Aç›´æ¥è®¿é—®ç¬¬12ä½ï¼ˆA[12]ï¼‰æ—¶ï¼Œç¨‹åºæ˜¯å¦ä¼šå´©æºƒï¼Ÿèƒ½å¦æ­£å¸¸è®¿é—®ï¼Ÿ\nè¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°ï¼š\nå…¨å±€å˜é‡çš„å†…å­˜å¸ƒå±€ æ“ä½œç³»ç»Ÿçš„å†…å­˜ä¿æŠ¤æœºåˆ¶ ç¼–è¯‘å™¨çš„å†…å­˜å¯¹é½ç­–ç•¥ æœªå®šä¹‰è¡Œä¸ºçš„å®é™…è¡¨ç° æµ‹è¯•ç¯å¢ƒ é¡¹ç›® è¯¦æƒ… æ“ä½œç³»ç»Ÿ Linux 5.15.0-138-generic (Ubuntu) æ¶æ„ x86_64 ç¼–è¯‘å™¨ GCC (GNU Compiler Collection) ç¼–è¯‘é€‰é¡¹ -Wall -Wextra -g -O0 æµ‹è¯•å·¥å…· AddressSanitizer, Valgrind, objdump æµ‹è¯•è®¾è®¡ æµ‹è¯•ç¨‹åºç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 // å…¨å±€æ•°ç»„å®šä¹‰ char A[10]; // æ•°ç»„Aï¼Œå¤§å°10å­—èŠ‚ char B[10]; // æ•°ç»„Bï¼Œå¤§å°10å­—èŠ‚ // æµ‹è¯•å†…å®¹ 1. å†…å­˜å¸ƒå±€åˆ†æ 2. æ­£å¸¸èŒƒå›´è®¿é—®æµ‹è¯• 3. è¶Šç•Œè¯»å–æµ‹è¯• (A[10] ~ A[15]) 4. è¶Šç•Œå†™å…¥æµ‹è¯• (A[10] ~ A[12]) 5. å¤§èŒƒå›´è¶Šç•Œæµ‹è¯• (A[10] ~ A[100]) 6. æ®µé”™è¯¯æ•è·æœºåˆ¶ æµ‹è¯•æ–¹æ³• åŸºç¡€æµ‹è¯•ï¼šä½¿ç”¨æ ‡å‡†ç¼–è¯‘é€‰é¡¹è¿›è¡Œæµ‹è¯• å†…å­˜æ£€æµ‹ï¼šä½¿ç”¨AddressSanitizeræ£€æµ‹å†…å­˜é”™è¯¯ ç¬¦å·åˆ†æï¼šä½¿ç”¨objdumpåˆ†æå†…å­˜å¸ƒå±€ å¼‚å¸¸å¤„ç†ï¼šå®ç°ä¿¡å·å¤„ç†æœºåˆ¶æ•è·æ®µé”™è¯¯ å®éªŒç»“æœ ğŸ¯ æ ¸å¿ƒç»“è®º A[12] ä¸ä¼šå´©æºƒï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ï¼\nAæ•°ç»„å¯ä»¥ç›´æ¥æ”¹å†™Bæ•°ç»„çš„å†…å®¹ï¼\nè¯¦ç»†æµ‹è¯•æ•°æ® 1. å†…å­˜å¸ƒå±€åˆ†æ 1 2 3 4 5 6 === æ•°ç»„ä¿¡æ¯ === æ•°ç»„Aåœ°å€: 0x564e0133f120 æ•°ç»„Båœ°å€: 0x564e0133f110 æ•°ç»„Aå¤§å°: 10 å­—èŠ‚ æ•°ç»„Bå¤§å°: 10 å­—èŠ‚ Aå’ŒBä¹‹é—´çš„è·ç¦»: -16 å­—èŠ‚ ç¬¦å·è¡¨ä¿¡æ¯ï¼ˆé€šè¿‡objdumpè·å–ï¼‰ï¼š\n1 2 0000000000004110 g O .bss 000000000000000a B 0000000000004120 g O .bss 000000000000000a A 2. è¶Šç•Œè®¿é—®æµ‹è¯•ç»“æœ è®¿é—®ä½ç½® è¯»å–ç»“æœ å†™å…¥ç»“æœ æ˜¯å¦å´©æºƒ A[10] âœ… æˆåŠŸ âœ… æˆåŠŸ âŒ æ— å´©æºƒ A[11] âœ… æˆåŠŸ âœ… æˆåŠŸ âŒ æ— å´©æºƒ A[12] âœ… æˆåŠŸ âœ… æˆåŠŸ âŒ æ— å´©æºƒ A[13-15] âœ… æˆåŠŸ - âŒ æ— å´©æºƒ A[20-100] âœ… æˆåŠŸ - âŒ æ— å´©æºƒ 4. æ–°å¢ï¼šAæ•°ç»„æ”¹å†™Bæ•°ç»„æµ‹è¯• æµ‹è¯•æ–¹æ³• è®¿é—®æ–¹å¼ ç»“æœ è¯´æ˜ è´Ÿç´¢å¼•è®¿é—® A[-16] âœ… æˆåŠŸæ”¹å†™B[0] Båœ¨Aå‰16å­—èŠ‚ ç³»ç»Ÿæ€§æµ‹è¯• A[-16] ~ A[-7] âœ… å®Œå…¨æ§åˆ¶Bæ•°ç»„ å¯æ”¹å†™B[0] ~ B[9] AddressSanitizer A[-20] âŒ æ£€æµ‹åˆ°æº¢å‡º å…¨å±€ç¼“å†²åŒºæº¢å‡ºé”™è¯¯ 5. å†…å­˜å¸ƒå±€è¯¦ç»†åˆ†æ å®é™…å†…å­˜å¸ƒå±€ï¼š\n1 2 3 4 5 6 7 8 9 å†…å­˜åœ°å€ä»ä½åˆ°é«˜ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ•°ç»„B â”‚ å¡«å……åŒºåŸŸ â”‚ æ•°ç»„A â”‚ â”‚ (10å­—èŠ‚) â”‚ (6å­—èŠ‚) â”‚ (10å­—èŠ‚) â”‚ â”‚0x...1110 â”‚ â”‚0x...1120 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†‘ â†‘ A[-16]~A[-7] A[0]~A[9] å¯ä»¥æ”¹å†™B[0]~B[9] æ­£å¸¸Aæ•°ç»„èŒƒå›´ å…³é”®å‘ç°ï¼š\nBæ•°ç»„åœ¨Aæ•°ç»„å‰é¢16å­—èŠ‚ A[-16] å¯¹åº” B[0]ï¼ŒA[-15] å¯¹åº” B[1]ï¼Œä»¥æ­¤ç±»æ¨ A[-16] ~ A[-7] å¯ä»¥å®Œå…¨æ§åˆ¶Bæ•°ç»„çš„æ‰€æœ‰10ä¸ªå…ƒç´  6. åŸå§‹å†…å­˜å†…å®¹åˆ†æ 1 2 3 4 5 6 7 8 9 10 ä»A[0]å¼€å§‹çš„20ä¸ªå­—èŠ‚å†…å®¹: åç§» 0: åœ°å€0x564e0133f120, å€¼=A (ASCII: 65) åç§» 1: åœ°å€0x564e0133f121, å€¼=B (ASCII: 66) ... åç§» 9: åœ°å€0x564e0133f129, å€¼=J (ASCII: 74) åç§»10: åœ°å€0x564e0133f12a, å€¼=X (ASCII: 88) â† A[10]å†™å…¥æˆåŠŸ åç§»11: åœ°å€0x564e0133f12b, å€¼=X (ASCII: 88) â† A[11]å†™å…¥æˆåŠŸ åç§»12: åœ°å€0x564e0133f12c, å€¼=X (ASCII: 88) â† A[12]å†™å…¥æˆåŠŸ åç§»13: åœ°å€0x564e0133f12d, å€¼=? (ASCII: 0) ... æ·±å…¥åˆ†æ ğŸ” ä¸ºä»€ä¹ˆA[12]ä¸ä¼šå´©æºƒï¼Ÿä¸ºä»€ä¹ˆAå¯ä»¥æ”¹å†™Bï¼Ÿ 1. å†…å­˜æ®µç‰¹æ€§ å…¨å±€æ•°ç»„ä½äº.bssæ®µ\n.bssæ®µï¼šå­˜å‚¨æœªåˆå§‹åŒ–çš„å…¨å±€å’Œé™æ€å˜é‡ è¿ç»­å†…å­˜ï¼šåŒä¸€æ®µå†…çš„å˜é‡é€šå¸¸åˆ†é…åœ¨è¿ç»­å†…å­˜ä¸­ é›¶åˆå§‹åŒ–ï¼š.bssæ®µåœ¨ç¨‹åºå¯åŠ¨æ—¶è¢«é›¶åˆå§‹åŒ– 2. å†…å­˜å¯¹é½æœºåˆ¶ 1 2 3 4 5 6 7 8 9 å†…å­˜å¸ƒå±€ç¤ºæ„å›¾ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ•°ç»„B â”‚ å¡«å……åŒºåŸŸ â”‚ æ•°ç»„A â”‚ â”‚ (10å­—èŠ‚) â”‚ (6å­—èŠ‚) â”‚ (10å­—èŠ‚) â”‚ â”‚0x...4110 â”‚ â”‚0x...4120 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†‘ A[10], A[11], A[12] è®¿é—®è¿™ä¸ªåŒºåŸŸ ç¼–è¯‘å™¨å¯¹é½ç­–ç•¥ï¼š\nä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œç¼–è¯‘å™¨ä¼šè¿›è¡Œå†…å­˜å¯¹é½ åœ¨æ•°ç»„ä¹‹é—´å¯èƒ½æ’å…¥å¡«å……å­—èŠ‚ è¿™äº›å¡«å……åŒºåŸŸé€šå¸¸å¯ä»¥å®‰å…¨è®¿é—® 3. æ“ä½œç³»ç»Ÿä¿æŠ¤æœºåˆ¶ é¡µçº§å†…å­˜ä¿æŠ¤ï¼š\nLinuxå†…å­˜ä¿æŠ¤ä»¥é¡µä¸ºå•ä½ï¼ˆé€šå¸¸4KBï¼‰ å°èŒƒå›´è¶Šç•Œï¼ˆå‡ ä¸ªå­—èŠ‚ï¼‰ä¸ä¼šè·¨è¶Šé¡µè¾¹ç•Œ åªè¦åœ¨åŒä¸€é¡µå†…ï¼Œä¸ä¼šè§¦å‘æ®µé”™è¯¯ è™šæ‹Ÿå†…å­˜ç®¡ç†ï¼š\nå…¨å±€å˜é‡åœ¨è¿›ç¨‹å¯åŠ¨æ—¶å°±åˆ†é…å¥½å†…å­˜ .bssæ®µé€šå¸¸æœ‰è¾ƒå¤§çš„è¿ç»­ç©ºé—´ è¶Šç•Œè®¿é—®ä»åœ¨è¿›ç¨‹çš„åˆæ³•åœ°å€ç©ºé—´å†… ğŸ§ª ä¸åŒç¼–è¯‘é€‰é¡¹çš„å½±å“ AddressSanitizeræµ‹è¯• è¶Šç•Œè®¿é—®æµ‹è¯•ï¼š\n1 2 3 gcc -fsanitize=address -o test test.c ./test # ç»“æœï¼šA[12]è®¿é—®ä»ç„¶æ²¡æœ‰æ£€æµ‹åˆ°é”™è¯¯ æ”¹å†™Bæ•°ç»„æµ‹è¯•ï¼š\n1 2 3 4 # å½“æµ‹è¯•A[-20]æ—¶ï¼ŒAddressSanitizeræ£€æµ‹åˆ°é”™è¯¯ï¼š ERROR: AddressSanitizer: global-buffer-overflow WRITE of size 1 at 0x5574cb8f61dc thread T0 SUMMARY: AddressSanitizer: global-buffer-overflow åŸå› åˆ†æï¼š\nAddressSanitizerå¯¹å…¨å±€æ•°ç»„çš„å°èŒƒå›´è¶Šç•Œæ£€æµ‹ä¸å¤Ÿæ•æ„Ÿ ä½†å¯¹äºè¾ƒå¤§èŒƒå›´çš„è¶Šç•Œè®¿é—®ï¼ˆå¦‚A[-20]ï¼‰èƒ½å¤Ÿæ£€æµ‹åˆ° A[-16] ~ A[-7]çš„è®¿é—®æ²¡æœ‰è¢«æ£€æµ‹åˆ°ï¼Œè¯´æ˜åœ¨\u0026quot;å®‰å…¨\u0026quot;èŒƒå›´å†… ä¸åŒä¼˜åŒ–çº§åˆ« -O0ï¼šæ— ä¼˜åŒ–ï¼Œè¶Šç•Œè®¿é—®æˆåŠŸ -O2/-O3ï¼šå¯èƒ½æ”¹å˜å†…å­˜å¸ƒå±€ï¼Œä½†é€šå¸¸ä»å¯è®¿é—® å®‰å…¨æ€§è®¨è®º âš ï¸ é£é™©è¯„ä¼° 1. æ•°æ®ç ´åé£é™© 1 2 // å±é™©ç¤ºä¾‹ A[12] = \u0026#39;X\u0026#39;; // å¯èƒ½è¦†ç›–å…¶ä»–é‡è¦æ•°æ® 2. ç¼“å†²åŒºæº¢å‡ºæ”»å‡» è™½ç„¶ä¸ä¼šç«‹å³å´©æºƒï¼Œä½†å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ æ”»å‡»è€…å¯èƒ½é€šè¿‡è¶Šç•Œå†™å…¥æ³¨å…¥æ¶æ„ä»£ç  ç‰¹åˆ«å±é™©ï¼šAæ•°ç»„å¯ä»¥å®Œå…¨æ§åˆ¶Bæ•°ç»„ï¼Œå¦‚æœBæ•°ç»„å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€æƒé™æ ‡å¿—ï¼‰ï¼Œåæœä¸¥é‡ 3. è°ƒè¯•å›°éš¾ è¶Šç•Œè®¿é—®å¯èƒ½å¯¼è‡´éš¾ä»¥é‡ç°çš„bug æ•°æ®æŸåå¯èƒ½åœ¨å¾ˆä¹…ä¹‹åæ‰è¡¨ç°å‡ºæ¥ ğŸ›¡ï¸ æœªå®šä¹‰è¡Œä¸ºçš„å±é™©æ€§ Cæ ‡å‡†è§‚ç‚¹ï¼š\næ•°ç»„è¶Šç•Œè®¿é—®æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼ˆUndefined Behaviorï¼‰ï¼Œç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ç¯å¢ƒä¸ä¿è¯ä»»ä½•ç‰¹å®šçš„è¡Œä¸ºã€‚\nå®é™…å½±å“ï¼š\nç¼–è¯‘å™¨å·®å¼‚ï¼šä¸åŒç¼–è¯‘å™¨å¯èƒ½æœ‰ä¸åŒçš„å†…å­˜å¸ƒå±€ å¹³å°å·®å¼‚ï¼šä¸åŒæ“ä½œç³»ç»Ÿã€æ¶æ„å¯èƒ½è¡¨ç°ä¸åŒ ç‰ˆæœ¬å·®å¼‚ï¼šåŒä¸€ç¼–è¯‘å™¨çš„ä¸åŒç‰ˆæœ¬å¯èƒ½æ”¹å˜è¡Œä¸º ä¼˜åŒ–å½±å“ï¼šç¼–è¯‘å™¨ä¼˜åŒ–å¯èƒ½æ”¹å˜å†…å­˜å¸ƒå±€ æœ€ä½³å®è·µå»ºè®® âœ… å®‰å…¨ç¼–ç¨‹å®è·µ 1. è¾¹ç•Œæ£€æŸ¥ 1 2 3 4 5 6 7 8 // æ¨èåšæ³• void safe_array_access(char* arr, int size, int index, char value) { if (index \u0026gt;= 0 \u0026amp;\u0026amp; index \u0026lt; size) { arr[index] = value; } else { fprintf(stderr, \u0026#34;æ•°ç»„è¶Šç•Œï¼šç´¢å¼• %d è¶…å‡ºèŒƒå›´ [0, %d)\\n\u0026#34;, index, size); } } 2. ä½¿ç”¨å®‰å…¨çš„æ•°æ®ç»“æ„ 1 2 3 4 5 6 7 8 9 10 11 12 13 // ä½¿ç”¨ç»“æ„ä½“å°è£…æ•°ç»„ typedef struct { char data[10]; int size; } SafeArray; int safe_set(SafeArray* arr, int index, char value) { if (index \u0026gt;= 0 \u0026amp;\u0026amp; index \u0026lt; arr-\u0026gt;size) { arr-\u0026gt;data[index] = value; return 1; // æˆåŠŸ } return 0; // å¤±è´¥ } 3. ç¼–è¯‘æ—¶æ£€æŸ¥ 1 2 3 4 5 6 7 8 # å¯ç”¨æ‰€æœ‰è­¦å‘Š gcc -Wall -Wextra -Werror -o program program.c # ä½¿ç”¨é™æ€åˆ†æå·¥å…· gcc -fanalyzer -o program program.c # ä½¿ç”¨è¿è¡Œæ—¶æ£€æŸ¥ gcc -fsanitize=address -fsanitize=bounds -o program program.c 4. ä»£ç å®¡æŸ¥æ¸…å• æ‰€æœ‰æ•°ç»„è®¿é—®éƒ½æœ‰è¾¹ç•Œæ£€æŸ¥ ä½¿ç”¨sizeof()è€Œä¸æ˜¯ç¡¬ç¼–ç æ•°ç»„å¤§å° å¾ªç¯è¾¹ç•Œæ­£ç¡®è®¾ç½® æŒ‡é’ˆè¿ç®—æœ‰èŒƒå›´éªŒè¯ ğŸ”§ å¼€å‘å·¥å…·æ¨è å·¥å…· ç”¨é€” å‘½ä»¤ç¤ºä¾‹ AddressSanitizer å†…å­˜é”™è¯¯æ£€æµ‹ gcc -fsanitize=address Valgrind å†…å­˜æ³„æ¼æ£€æµ‹ valgrind --tool=memcheck ./program Clang Static Analyzer é™æ€ä»£ç åˆ†æ clang --analyze program.c Cppcheck é™æ€åˆ†æ cppcheck program.c é™„å½• A. å®Œæ•´æµ‹è¯•ä»£ç  1. åŸºç¡€è¶Šç•Œè®¿é—®æµ‹è¯•ç¨‹åº (array_bounds_test.c) è¿™æ˜¯æœ€åŸºç¡€çš„æµ‹è¯•ç¨‹åºï¼ŒéªŒè¯A[12]æ˜¯å¦å¯ä»¥è®¿é—®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;setjmp.h\u0026gt; // å®šä¹‰ä¸¤ä¸ªå…¨å±€å­—ç¬¦æ•°ç»„ï¼Œå¤§å°ä¸º10 char A[10]; char B[10]; // ç”¨äºæ•è·æ®µé”™è¯¯çš„è·³è½¬ç¼“å†²åŒº static jmp_buf segfault_buf; static int segfault_occurred = 0; // æ®µé”™è¯¯ä¿¡å·å¤„ç†å‡½æ•° void segfault_handler(int sig) { segfault_occurred = 1; longjmp(segfault_buf, 1); } void print_array_info() { printf(\u0026#34;=== æ•°ç»„ä¿¡æ¯ ===\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Aåœ°å€: %p\\n\u0026#34;, (void*)A); printf(\u0026#34;æ•°ç»„Båœ°å€: %p\\n\u0026#34;, (void*)B); printf(\u0026#34;æ•°ç»„Aå¤§å°: %zu å­—èŠ‚\\n\u0026#34;, sizeof(A)); printf(\u0026#34;æ•°ç»„Bå¤§å°: %zu å­—èŠ‚\\n\u0026#34;, sizeof(B)); printf(\u0026#34;Aå’ŒBä¹‹é—´çš„è·ç¦»: %ld å­—èŠ‚\\n\u0026#34;, (char*)B - (char*)A); printf(\u0026#34;\\n\u0026#34;); } void initialize_arrays() { // åˆå§‹åŒ–æ•°ç»„A for (int i = 0; i \u0026lt; 10; i++) { A[i] = \u0026#39;A\u0026#39; + i; // A[0]=\u0026#39;A\u0026#39;, A[1]=\u0026#39;B\u0026#39;, ..., A[9]=\u0026#39;J\u0026#39; } // åˆå§‹åŒ–æ•°ç»„B for (int i = 0; i \u0026lt; 10; i++) { B[i] = \u0026#39;a\u0026#39; + i; // B[0]=\u0026#39;a\u0026#39;, B[1]=\u0026#39;b\u0026#39;, ..., B[9]=\u0026#39;j\u0026#39; } printf(\u0026#34;=== æ•°ç»„åˆå§‹åŒ–å®Œæˆ ===\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Aå†…å®¹: \u0026#34;); for (int i = 0; i \u0026lt; 10; i++) { printf(\u0026#34;%c \u0026#34;, A[i]); } printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Bå†…å®¹: \u0026#34;); for (int i = 0; i \u0026lt; 10; i++) { printf(\u0026#34;%c \u0026#34;, B[i]); } printf(\u0026#34;\\n\\n\u0026#34;); } void test_array_access() { printf(\u0026#34;=== æµ‹è¯•æ•°ç»„è®¿é—® ===\\n\u0026#34;); // æµ‹è¯•æ­£å¸¸è®¿é—® printf(\u0026#34;æ­£å¸¸è®¿é—®æµ‹è¯•:\\n\u0026#34;); printf(\u0026#34;A[0] = %c\\n\u0026#34;, A[0]); printf(\u0026#34;A[9] = %c\\n\u0026#34;, A[9]); printf(\u0026#34;B[0] = %c\\n\u0026#34;, B[0]); printf(\u0026#34;B[9] = %c\\n\u0026#34;, B[9]); printf(\u0026#34;\\n\u0026#34;); // æµ‹è¯•è¶Šç•Œè®¿é—® printf(\u0026#34;è¶Šç•Œè®¿é—®æµ‹è¯•:\\n\u0026#34;); // è®¾ç½®ä¿¡å·å¤„ç†å™¨ signal(SIGSEGV, segfault_handler); // æµ‹è¯•è®¿é—®A[10], A[11], A[12]ç­‰ for (int i = 10; i \u0026lt;= 15; i++) { segfault_occurred = 0; if (setjmp(segfault_buf) == 0) { // å°è¯•è¯»å– char value = A[i]; printf(\u0026#34;A[%d] = %c (ASCII: %d) - æˆåŠŸè¯»å–\\n\u0026#34;, i, (value \u0026gt;= 32 \u0026amp;\u0026amp; value \u0026lt;= 126) ? value : \u0026#39;?\u0026#39;, (int)value); } else { printf(\u0026#34;A[%d] - è®¿é—®æ—¶å‘ç”Ÿæ®µé”™è¯¯ï¼\\n\u0026#34;, i); } } printf(\u0026#34;\\n\u0026#34;); // æµ‹è¯•å†™å…¥è¶Šç•Œä½ç½® printf(\u0026#34;è¶Šç•Œå†™å…¥æµ‹è¯•:\\n\u0026#34;); for (int i = 10; i \u0026lt;= 12; i++) { segfault_occurred = 0; if (setjmp(segfault_buf) == 0) { A[i] = \u0026#39;X\u0026#39;; printf(\u0026#34;A[%d] = \u0026#39;X\u0026#39; - æˆåŠŸå†™å…¥\\n\u0026#34;, i); } else { printf(\u0026#34;A[%d] - å†™å…¥æ—¶å‘ç”Ÿæ®µé”™è¯¯ï¼\\n\u0026#34;, i); } } printf(\u0026#34;\\n\u0026#34;); // æ£€æŸ¥Bæ•°ç»„æ˜¯å¦è¢«å½±å“ printf(\u0026#34;æ£€æŸ¥Bæ•°ç»„æ˜¯å¦è¢«å½±å“:\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Bå½“å‰å†…å®¹: \u0026#34;); for (int i = 0; i \u0026lt; 10; i++) { printf(\u0026#34;%c \u0026#34;, B[i]); } printf(\u0026#34;\\n\u0026#34;); } void test_memory_layout() { printf(\u0026#34;=== å†…å­˜å¸ƒå±€åˆ†æ ===\\n\u0026#34;); // æ˜¾ç¤ºå†…å­˜ä¸­çš„å®é™…å†…å®¹ printf(\u0026#34;ä»A[0]å¼€å§‹çš„20ä¸ªå­—èŠ‚å†…å®¹:\\n\u0026#34;); for (int i = 0; i \u0026lt; 20; i++) { char* ptr = (char*)A + i; printf(\u0026#34;åç§»%2d: åœ°å€%p, å€¼=%c (ASCII:%3d)\\n\u0026#34;, i, (void*)ptr, (*ptr \u0026gt;= 32 \u0026amp;\u0026amp; *ptr \u0026lt;= 126) ? *ptr : \u0026#39;?\u0026#39;, (int)*ptr); } printf(\u0026#34;\\n\u0026#34;); // æ£€æŸ¥Aå’ŒBçš„ç›¸å¯¹ä½ç½® if ((char*)B \u0026gt; (char*)A) { long distance = (char*)B - (char*)A; printf(\u0026#34;Bæ•°ç»„åœ¨Aæ•°ç»„ä¹‹å %ld å­—èŠ‚\\n\u0026#34;, distance); if (distance == 10) { printf(\u0026#34;Aå’ŒBåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„ï¼A[10]å®é™…ä¸Šå°±æ˜¯B[0]\\n\u0026#34;); } else if (distance \u0026lt; 20) { printf(\u0026#34;Aå’ŒBåœ¨å†…å­˜ä¸­å¾ˆæ¥è¿‘ï¼Œå¯èƒ½å­˜åœ¨é‡å è®¿é—®\\n\u0026#34;); } } else { long distance = (char*)A - (char*)B; printf(\u0026#34;Aæ•°ç»„åœ¨Bæ•°ç»„ä¹‹å %ld å­—èŠ‚\\n\u0026#34;, distance); } } int main() { printf(\u0026#34;å…¨å±€å­—ç¬¦æ•°ç»„è¶Šç•Œè®¿é—®æµ‹è¯•ç¨‹åº\\n\u0026#34;); printf(\u0026#34;=====================================\\n\\n\u0026#34;); print_array_info(); initialize_arrays(); test_array_access(); test_memory_layout(); printf(\u0026#34;=== æµ‹è¯•æ€»ç»“ ===\\n\u0026#34;); printf(\u0026#34;1. å…¨å±€æ•°ç»„é€šå¸¸åˆ†é…åœ¨æ•°æ®æ®µ(.dataæˆ–.bss)\\n\u0026#34;); printf(\u0026#34;2. ç¼–è¯‘å™¨å¯èƒ½ä¼šå°†ç›¸é‚»å£°æ˜çš„å…¨å±€æ•°ç»„æ”¾åœ¨è¿ç»­å†…å­˜ä¸­\\n\u0026#34;); printf(\u0026#34;3. è¶Šç•Œè®¿é—®å¯èƒ½ä¸ä¼šç«‹å³å´©æºƒï¼Œä½†ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸º\\n\u0026#34;); printf(\u0026#34;4. å®é™…è¡Œä¸ºå–å†³äºç¼–è¯‘å™¨ã€é“¾æ¥å™¨å’Œè¿è¡Œæ—¶ç¯å¢ƒ\\n\u0026#34;); printf(\u0026#34;5. åœ¨ç”Ÿäº§ä»£ç ä¸­åº”è¯¥é¿å…ä»»ä½•å½¢å¼çš„è¶Šç•Œè®¿é—®\\n\u0026#34;); return 0; } 2. æ•°ç»„æ”¹å†™æµ‹è¯•ç¨‹åº (array_overwrite_test.c) è¿™ä¸ªç¨‹åºä¸“é—¨æµ‹è¯•Aæ•°ç»„æ˜¯å¦å¯ä»¥æ”¹å†™Bæ•°ç»„çš„å†…å®¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;setjmp.h\u0026gt; // å®šä¹‰ä¸¤ä¸ªå…¨å±€å­—ç¬¦æ•°ç»„ï¼Œå¤§å°ä¸º10 char A[10]; char B[10]; // ç”¨äºæ•è·æ®µé”™è¯¯çš„è·³è½¬ç¼“å†²åŒº static jmp_buf segfault_buf; static int segfault_occurred = 0; // æ®µé”™è¯¯ä¿¡å·å¤„ç†å‡½æ•° void segfault_handler(int sig) { segfault_occurred = 1; longjmp(segfault_buf, 1); } void print_memory_layout() { printf(\u0026#34;=== å†…å­˜å¸ƒå±€ä¿¡æ¯ ===\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Aåœ°å€: %p\\n\u0026#34;, (void*)A); printf(\u0026#34;æ•°ç»„Båœ°å€: %p\\n\u0026#34;, (void*)B); printf(\u0026#34;Aå’ŒBä¹‹é—´çš„è·ç¦»: %ld å­—èŠ‚\\n\u0026#34;, (char*)B - (char*)A); // åˆ¤æ–­Aå’ŒBçš„ç›¸å¯¹ä½ç½® if ((char*)A \u0026lt; (char*)B) { printf(\u0026#34;å†…å­˜å¸ƒå±€: Aåœ¨å‰ï¼ŒBåœ¨å\\n\u0026#34;); printf(\u0026#34;A[10]åŠä»¥åå¯èƒ½å½±å“Bæ•°ç»„\\n\u0026#34;); } else { printf(\u0026#34;å†…å­˜å¸ƒå±€: Båœ¨å‰ï¼ŒAåœ¨å\\n\u0026#34;); printf(\u0026#34;Açš„è´Ÿç´¢å¼•å¯èƒ½å½±å“Bæ•°ç»„\\n\u0026#34;); } printf(\u0026#34;\\n\u0026#34;); } void initialize_arrays() { printf(\u0026#34;=== åˆå§‹åŒ–æ•°ç»„ ===\\n\u0026#34;); // åˆå§‹åŒ–æ•°ç»„A for (int i = 0; i \u0026lt; 10; i++) { A[i] = \u0026#39;A\u0026#39; + i; // A[0]=\u0026#39;A\u0026#39;, A[1]=\u0026#39;B\u0026#39;, ..., A[9]=\u0026#39;J\u0026#39; } // åˆå§‹åŒ–æ•°ç»„B for (int i = 0; i \u0026lt; 10; i++) { B[i] = \u0026#39;a\u0026#39; + i; // B[0]=\u0026#39;a\u0026#39;, B[1]=\u0026#39;b\u0026#39;, ..., B[9]=\u0026#39;j\u0026#39; } printf(\u0026#34;æ•°ç»„Aåˆå§‹å†…å®¹: \u0026#34;); for (int i = 0; i \u0026lt; 10; i++) { printf(\u0026#34;%c \u0026#34;, A[i]); } printf(\u0026#34;\\n\u0026#34;); printf(\u0026#34;æ•°ç»„Båˆå§‹å†…å®¹: \u0026#34;); for (int i = 0; i \u0026lt; 10; i++) { printf(\u0026#34;%c \u0026#34;, B[i]); } printf(\u0026#34;\\n\\n\u0026#34;); } int test_overwrite_via_negative_index() { printf(\u0026#34;=== æµ‹è¯•é€šè¿‡è´Ÿç´¢å¼•æ”¹å†™Bæ•°ç»„ ===\\n\u0026#34;); long distance = (char*)A - (char*)B; int b_changed = 0; if (distance \u0026gt; 0) { // Aåœ¨Båé¢ï¼Œå°è¯•é€šè¿‡Açš„è´Ÿç´¢å¼•è®¿é—®B printf(\u0026#34;Aåœ¨Båé¢ï¼Œè·ç¦»%ldå­—èŠ‚ï¼Œå°è¯•é€šè¿‡A[-%ld]è®¿é—®B[0]\\n\u0026#34;, distance, distance); segfault_occurred = 0; if (setjmp(segfault_buf) == 0) { char old_b0 = B[0]; A[-distance] = \u0026#39;Y\u0026#39;; // å°è¯•é€šè¿‡Açš„è´Ÿç´¢å¼•ä¿®æ”¹B[0] if (B[0] != old_b0) { printf(\u0026#34;âœ… æˆåŠŸï¼A[-%ld] = \u0026#39;Y\u0026#39; æ”¹å˜äº†B[0]: \u0026#39;%c\u0026#39; -\u0026gt; \u0026#39;%c\u0026#39;\\n\u0026#34;, distance, old_b0, B[0]); b_changed = 1; } else { printf(\u0026#34;âŒ A[-%ld] = \u0026#39;Y\u0026#39; æ²¡æœ‰å½±å“B[0]\\n\u0026#34;, distance); } } else { printf(\u0026#34;âŒ è®¿é—®A[-%ld]æ—¶å‘ç”Ÿæ®µé”™è¯¯\\n\u0026#34;, distance); } } else { printf(\u0026#34;Båœ¨Aåé¢ï¼Œæ— æ³•é€šè¿‡è´Ÿç´¢å¼•ç›´æ¥è®¿é—®B\\n\u0026#34;); } return b_changed; } void test_systematic_overwrite() { printf(\u0026#34;=== ç³»ç»Ÿæ€§æµ‹è¯•ï¼šå¯»æ‰¾èƒ½å½±å“Bçš„Aç´¢å¼• ===\\n\u0026#34;); // é‡æ–°åˆå§‹åŒ–æ•°ç»„ initialize_arrays(); printf(\u0026#34;æµ‹è¯•èŒƒå›´ï¼šA[-20] åˆ° A[30]\\n\u0026#34;); for (int offset = -20; offset \u0026lt;= 30; offset++) { // ä¿å­˜Bæ•°ç»„çš„åŸå§‹çŠ¶æ€ char original_b[10]; memcpy(original_b, B, 10); segfault_occurred = 0; if (setjmp(segfault_buf) == 0) { // å°è¯•å†™å…¥ä¸€ä¸ªç‰¹æ®Šå€¼ A[offset] = \u0026#39;Z\u0026#39;; // æ£€æŸ¥Bæ•°ç»„æ˜¯å¦è¢«æ”¹å˜ int b_index_changed = -1; for (int i = 0; i \u0026lt; 10; i++) { if (B[i] != original_b[i]) { b_index_changed = i; break; } } if (b_index_changed \u0026gt;= 0) { printf(\u0026#34;ğŸ¯ A[%d] = \u0026#39;Z\u0026#39; å½±å“äº†B[%d]: \u0026#39;%c\u0026#39; -\u0026gt; \u0026#39;%c\u0026#39;\\n\u0026#34;, offset, b_index_changed, original_b[b_index_changed], B[b_index_changed]); // æ¢å¤Bæ•°ç»„ B[b_index_changed] = original_b[b_index_changed]; } } else { printf(\u0026#34;ğŸ’¥ A[%d] è®¿é—®æ—¶å‘ç”Ÿæ®µé”™è¯¯\\n\u0026#34;, offset); } } } // ... å…¶ä»–å‡½æ•°çœç•¥ ... int main() { printf(\u0026#34;å…¨å±€æ•°ç»„Aæ”¹å†™æ•°ç»„Bæµ‹è¯•ç¨‹åº\\n\u0026#34;); printf(\u0026#34;================================\\n\\n\u0026#34;); print_memory_layout(); initialize_arrays(); int negative_success = test_overwrite_via_negative_index(); test_systematic_overwrite(); printf(\u0026#34;=== æµ‹è¯•æ€»ç»“ ===\\n\u0026#34;); printf(\u0026#34;1. é€šè¿‡è´Ÿç´¢å¼•æ”¹å†™B: %s\\n\u0026#34;, negative_success ? \u0026#34;æˆåŠŸ\u0026#34; : \u0026#34;å¤±è´¥\u0026#34;); printf(\u0026#34;2. Aæ•°ç»„%sç›´æ¥æ”¹å†™Bæ•°ç»„çš„å†…å®¹\\n\u0026#34;, negative_success ? \u0026#34;å¯ä»¥\u0026#34; : \u0026#34;æ— æ³•\u0026#34;); printf(\u0026#34;3. è¿™ç§è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„ï¼Œä¸åº”åœ¨ç”Ÿäº§ä»£ç ä¸­ä½¿ç”¨\\n\u0026#34;); return 0; } 3. å®‰å…¨å¨èƒæ¼”ç¤ºç¨‹åº (dangerous_demo.c) è¿™ä¸ªç¨‹åºæ¼”ç¤ºäº†æ•°ç»„è¶Šç•Œè®¿é—®å¦‚ä½•è¢«æ¶æ„åˆ©ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;string.h\u0026gt; // æ¨¡æ‹Ÿä¸€ä¸ªçœŸå®çš„å®‰å…¨åœºæ™¯ char user_input[10]; // ç”¨æˆ·è¾“å…¥ç¼“å†²åŒº char admin_flag[10]; // ç®¡ç†å‘˜æƒé™æ ‡å¿— void initialize_system() { // åˆå§‹åŒ–ç®¡ç†å‘˜æ ‡å¿—ä¸º\u0026#34;NOADMIN\u0026#34; strcpy(admin_flag, \u0026#34;NOADMIN\u0026#34;); printf(\u0026#34;ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ\\n\u0026#34;); printf(\u0026#34;ç®¡ç†å‘˜æƒé™: %s\\n\u0026#34;, admin_flag); } void process_user_input(const char* input) { printf(\u0026#34;\\nå¤„ç†ç”¨æˆ·è¾“å…¥: %s\\n\u0026#34;, input); // å±é™©çš„æ“ä½œï¼šæ²¡æœ‰è¾¹ç•Œæ£€æŸ¥çš„å¤åˆ¶ for (int i = 0; input[i] != \u0026#39;\\0\u0026#39;; i++) { user_input[i] = input[i]; // æ½œåœ¨çš„ç¼“å†²åŒºæº¢å‡º } printf(\u0026#34;ç”¨æˆ·è¾“å…¥å·²ä¿å­˜\\n\u0026#34;); } void check_admin_privileges() { printf(\u0026#34;\\næ£€æŸ¥ç®¡ç†å‘˜æƒé™...\\n\u0026#34;); printf(\u0026#34;å½“å‰ç®¡ç†å‘˜æ ‡å¿—: %s\\n\u0026#34;, admin_flag); if (strncmp(admin_flag, \u0026#34;ADMIN\u0026#34;, 5) == 0) { printf(\u0026#34;ğŸ”“ ç®¡ç†å‘˜æƒé™å·²æ¿€æ´»ï¼å¯ä»¥æ‰§è¡Œç‰¹æƒæ“ä½œã€‚\\n\u0026#34;); } else { printf(\u0026#34;ğŸ”’ æ™®é€šç”¨æˆ·æƒé™ï¼Œæ— æ³•æ‰§è¡Œç‰¹æƒæ“ä½œã€‚\\n\u0026#34;); } } int main() { printf(\u0026#34;å±é™©çš„æ•°ç»„è¶Šç•Œè®¿é—®æ¼”ç¤º\\n\u0026#34;); printf(\u0026#34;========================\\n\u0026#34;); initialize_system(); // æ­£å¸¸çš„ç”¨æˆ·è¾“å…¥ printf(\u0026#34;\\n--- æµ‹è¯•1: æ­£å¸¸è¾“å…¥ ---\\n\u0026#34;); process_user_input(\u0026#34;hello\u0026#34;); check_admin_privileges(); // å±é™©çš„é•¿è¾“å…¥ï¼Œå¯èƒ½è¦†ç›–admin_flag printf(\u0026#34;\\n--- æµ‹è¯•2: é•¿è¾“å…¥ï¼ˆå¯èƒ½çš„æ”»å‡»ï¼‰---\\n\u0026#34;); // è®¡ç®—éœ€è¦å¤šå°‘å­—ç¬¦æ‰èƒ½åˆ°è¾¾admin_flag long distance = (char*)admin_flag - (char*)user_input; if (distance \u0026gt; 0 \u0026amp;\u0026amp; distance \u0026lt; 50) { printf(\u0026#34;å°è¯•é€šè¿‡é•¿è¾“å…¥è¦†ç›–admin_flag...\\n\u0026#34;); // æ„é€ æ¶æ„è¾“å…¥ char malicious_input[100]; memset(malicious_input, \u0026#39;X\u0026#39;, distance); // å¡«å……åˆ°admin_flagä½ç½® strcpy(malicious_input + distance, \u0026#34;ADMIN\u0026#34;); // åœ¨admin_flagä½ç½®å†™å…¥\u0026#34;ADMIN\u0026#34; malicious_input[distance + 5] = \u0026#39;\\0\u0026#39;; // ç¡®ä¿å­—ç¬¦ä¸²ç»“æŸ printf(\u0026#34;æ¶æ„è¾“å…¥é•¿åº¦: %ld å­—èŠ‚\\n\u0026#34;, strlen(malicious_input)); process_user_input(malicious_input); check_admin_privileges(); printf(\u0026#34;\\nğŸ’€ æ”»å‡»æˆåŠŸï¼é€šè¿‡ç¼“å†²åŒºæº¢å‡ºè·å¾—äº†ç®¡ç†å‘˜æƒé™ï¼\\n\u0026#34;); } else { printf(\u0026#34;å½“å‰å†…å­˜å¸ƒå±€ä¸é€‚åˆæ¼”ç¤ºæ”»å‡»ï¼ˆè·ç¦»ï¼š%ldï¼‰\\n\u0026#34;, distance); } printf(\u0026#34;\\nâš ï¸ è¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†ä¸ºä»€ä¹ˆæ•°ç»„è¶Šç•Œè®¿é—®å¦‚æ­¤å±é™©ï¼\\n\u0026#34;); printf(\u0026#34;âš ï¸ åœ¨çœŸå®çš„ç¨‹åºä¸­ï¼Œè¿™ç§æ¼æ´å¯èƒ½è¢«æ¶æ„åˆ©ç”¨æ¥è·å–ç³»ç»Ÿæƒé™ã€‚\\n\u0026#34;); return 0; } 4. ç¼–è¯‘è„šæœ¬ (Makefile) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 CC = gcc CFLAGS = -Wall -Wextra -g -O0 TARGET = array_bounds_test SOURCE = array_bounds_test.c OVERWRITE_TARGET = array_overwrite_test OVERWRITE_SOURCE = array_overwrite_test.c DEMO_TARGET = dangerous_demo DEMO_SOURCE = dangerous_demo.c # é»˜è®¤ç›®æ ‡ all: $(TARGET) $(OVERWRITE_TARGET) $(DEMO_TARGET) # ç¼–è¯‘ç›®æ ‡ $(TARGET): $(SOURCE) $(CC) $(CFLAGS) -o $(TARGET) $(SOURCE) # ç¼–è¯‘æ”¹å†™æµ‹è¯•ç¨‹åº $(OVERWRITE_TARGET): $(OVERWRITE_SOURCE) $(CC) $(CFLAGS) -o $(OVERWRITE_TARGET) $(OVERWRITE_SOURCE) # ç¼–è¯‘å±é™©æ¼”ç¤ºç¨‹åº $(DEMO_TARGET): $(DEMO_SOURCE) $(CC) $(CFLAGS) -o $(DEMO_TARGET) $(DEMO_SOURCE) # è¿è¡Œæµ‹è¯• run: $(TARGET) ./$(TARGET) # è¿è¡Œæ”¹å†™æµ‹è¯• run-overwrite: $(OVERWRITE_TARGET) ./$(OVERWRITE_TARGET) # è¿è¡Œå±é™©æ¼”ç¤º run-demo: $(DEMO_TARGET) ./$(DEMO_TARGET) # ä½¿ç”¨AddressSanitizerç¼–è¯‘ asan: $(SOURCE) $(CC) $(CFLAGS) -fsanitize=address -o $(TARGET)_asan $(SOURCE) # ä½¿ç”¨AddressSanitizerç¼–è¯‘æ”¹å†™æµ‹è¯• asan-overwrite: $(OVERWRITE_SOURCE) $(CC) $(CFLAGS) -fsanitize=address -o $(OVERWRITE_TARGET)_asan $(OVERWRITE_SOURCE) # è¿è¡ŒAddressSanitizerç‰ˆæœ¬ run-asan: asan ./$(TARGET)_asan # è¿è¡ŒAddressSanitizeræ”¹å†™æµ‹è¯•ç‰ˆæœ¬ run-asan-overwrite: asan-overwrite ./$(OVERWRITE_TARGET)_asan # æ¸…ç† clean: rm -f $(TARGET) $(TARGET)_asan $(OVERWRITE_TARGET) $(OVERWRITE_TARGET)_asan $(DEMO_TARGET) # æ˜¾ç¤ºå¸®åŠ© help: @echo \u0026#34;å¯ç”¨çš„ç›®æ ‡:\u0026#34; @echo \u0026#34; all - ç¼–è¯‘æ‰€æœ‰ç¨‹åº\u0026#34; @echo \u0026#34; run - ç¼–è¯‘å¹¶è¿è¡Œè¶Šç•Œè®¿é—®æµ‹è¯•ç¨‹åº\u0026#34; @echo \u0026#34; run-overwrite - ç¼–è¯‘å¹¶è¿è¡Œæ•°ç»„æ”¹å†™æµ‹è¯•ç¨‹åº\u0026#34; @echo \u0026#34; run-demo - ç¼–è¯‘å¹¶è¿è¡Œå±é™©æ¼”ç¤ºç¨‹åº\u0026#34; @echo \u0026#34; valgrind - ä½¿ç”¨valgrindè¿è¡Œè¶Šç•Œè®¿é—®æµ‹è¯•\u0026#34; @echo \u0026#34; asan - ä½¿ç”¨AddressSanitizerç¼–è¯‘è¶Šç•Œè®¿é—®æµ‹è¯•\u0026#34; @echo \u0026#34; asan-overwrite - ä½¿ç”¨AddressSanitizerç¼–è¯‘æ”¹å†™æµ‹è¯•\u0026#34; @echo \u0026#34; run-asan - è¿è¡ŒAddressSanitizerç‰ˆæœ¬çš„è¶Šç•Œè®¿é—®æµ‹è¯•\u0026#34; @echo \u0026#34; run-asan-overwrite - è¿è¡ŒAddressSanitizerç‰ˆæœ¬çš„æ”¹å†™æµ‹è¯•\u0026#34; @echo \u0026#34; clean - æ¸…ç†ç”Ÿæˆçš„æ–‡ä»¶\u0026#34; @echo \u0026#34; help - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯\u0026#34; .PHONY: all run run-overwrite run-demo valgrind asan asan-overwrite run-asan run-asan-overwrite clean help 5. ä»£ç ä½¿ç”¨è¯´æ˜ å¿«é€Ÿå¼€å§‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # 1. ä¸‹è½½æ‰€æœ‰ä»£ç æ–‡ä»¶åˆ°åŒä¸€ç›®å½• # 2. ç¡®ä¿ç³»ç»Ÿå®‰è£…äº†GCCç¼–è¯‘å™¨ # 3. è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š # ç¼–è¯‘æ‰€æœ‰ç¨‹åº make all # è¿è¡ŒåŸºç¡€æµ‹è¯•ï¼ˆéªŒè¯A[12]è®¿é—®ï¼‰ make run # è¿è¡Œæ”¹å†™æµ‹è¯•ï¼ˆéªŒè¯Aæ”¹å†™Bï¼‰ make run-overwrite # è¿è¡Œå®‰å…¨æ¼”ç¤ºï¼ˆæƒé™æå‡æ”»å‡»ï¼‰ make run-demo é«˜çº§æµ‹è¯•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 # ä½¿ç”¨AddressSanitizeræ£€æµ‹å†…å­˜é”™è¯¯ make run-asan-overwrite # ä½¿ç”¨Valgrindæ£€æµ‹å†…å­˜é—®é¢˜ make valgrind # æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ make help # æ¸…ç†ç”Ÿæˆçš„æ–‡ä»¶ make clean ä»£ç ç»“æ„è¯´æ˜ï¼š\næ¯ä¸ªç¨‹åºéƒ½åŒ…å«æ®µé”™è¯¯å¤„ç†æœºåˆ¶ ä½¿ç”¨setjmp/longjmpæ•è·å¯èƒ½çš„å´©æºƒ è¯¦ç»†çš„å†…å­˜å¸ƒå±€åˆ†æå’Œç»“æœè¾“å‡º æ”¯æŒå¤šç§ç¼–è¯‘å™¨é€‰é¡¹å’Œè°ƒè¯•å·¥å…· B. ç¼–è¯‘å’Œè¿è¡ŒæŒ‡ä»¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # è¶Šç•Œè®¿é—®æµ‹è¯• make run # æ•°ç»„æ”¹å†™æµ‹è¯• make run-overwrite # AddressSanitizeræµ‹è¯• make run-asan make run-asan-overwrite # Valgrindæµ‹è¯• make valgrind # æŸ¥çœ‹ç¬¦å·è¡¨ objdump -t array_bounds_test | grep -E \u0026#34;(A|B)$\u0026#34; # æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ make help C. æµ‹è¯•ç»“æœç¤ºä¾‹ åŸºç¡€è¶Šç•Œè®¿é—®æµ‹è¯•è¾“å‡ºç¤ºä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 å…¨å±€å­—ç¬¦æ•°ç»„è¶Šç•Œè®¿é—®æµ‹è¯•ç¨‹åº ===================================== === æ•°ç»„ä¿¡æ¯ === æ•°ç»„Aåœ°å€: 0x564e0133f120 æ•°ç»„Båœ°å€: 0x564e0133f110 æ•°ç»„Aå¤§å°: 10 å­—èŠ‚ æ•°ç»„Bå¤§å°: 10 å­—èŠ‚ Aå’ŒBä¹‹é—´çš„è·ç¦»: -16 å­—èŠ‚ === æ•°ç»„åˆå§‹åŒ–å®Œæˆ === æ•°ç»„Aå†…å®¹: A B C D E F G H I J æ•°ç»„Bå†…å®¹: a b c d e f g h i j === æµ‹è¯•æ•°ç»„è®¿é—® === æ­£å¸¸è®¿é—®æµ‹è¯•: A[0] = A A[9] = J B[0] = a B[9] = j è¶Šç•Œè®¿é—®æµ‹è¯•: A[10] = ? (ASCII: 0) - æˆåŠŸè¯»å– A[11] = ? (ASCII: 0) - æˆåŠŸè¯»å– A[12] = ? (ASCII: 0) - æˆåŠŸè¯»å– â† å…³é”®ç»“æœï¼šA[12]å¯ä»¥è®¿é—®ï¼ A[13] = ? (ASCII: 0) - æˆåŠŸè¯»å– A[14] = ? (ASCII: 0) - æˆåŠŸè¯»å– A[15] = ? (ASCII: 0) - æˆåŠŸè¯»å– è¶Šç•Œå†™å…¥æµ‹è¯•: A[10] = \u0026#39;X\u0026#39; - æˆåŠŸå†™å…¥ A[11] = \u0026#39;X\u0026#39; - æˆåŠŸå†™å…¥ A[12] = \u0026#39;X\u0026#39; - æˆåŠŸå†™å…¥ â† å…³é”®ç»“æœï¼šA[12]å¯ä»¥å†™å…¥ï¼ æ•°ç»„æ”¹å†™æµ‹è¯•è¾“å‡ºç¤ºä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 å…¨å±€æ•°ç»„Aæ”¹å†™æ•°ç»„Bæµ‹è¯•ç¨‹åº ================================ === å†…å­˜å¸ƒå±€ä¿¡æ¯ === æ•°ç»„Aåœ°å€: 0x564a46bc3120 æ•°ç»„Båœ°å€: 0x564a46bc3110 Aå’ŒBä¹‹é—´çš„è·ç¦»: -16 å­—èŠ‚ å†…å­˜å¸ƒå±€: Båœ¨å‰ï¼ŒAåœ¨å Açš„è´Ÿç´¢å¼•å¯èƒ½å½±å“Bæ•°ç»„ === æµ‹è¯•é€šè¿‡è´Ÿç´¢å¼•æ”¹å†™Bæ•°ç»„ === Aåœ¨Båé¢ï¼Œè·ç¦»16å­—èŠ‚ï¼Œå°è¯•é€šè¿‡A[-16]è®¿é—®B[0] âœ… æˆåŠŸï¼A[-16] = \u0026#39;Y\u0026#39; æ”¹å˜äº†B[0]: \u0026#39;a\u0026#39; -\u0026gt; \u0026#39;Y\u0026#39; â† å…³é”®ç»“æœï¼šAå¯ä»¥æ”¹å†™Bï¼ === ç³»ç»Ÿæ€§æµ‹è¯•ï¼šå¯»æ‰¾èƒ½å½±å“Bçš„Aç´¢å¼• === æµ‹è¯•èŒƒå›´ï¼šA[-20] åˆ° A[30] ğŸ¯ A[-16] = \u0026#39;Z\u0026#39; å½±å“äº†B[0]: \u0026#39;a\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-15] = \u0026#39;Z\u0026#39; å½±å“äº†B[1]: \u0026#39;b\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-14] = \u0026#39;Z\u0026#39; å½±å“äº†B[2]: \u0026#39;c\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-13] = \u0026#39;Z\u0026#39; å½±å“äº†B[3]: \u0026#39;d\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-12] = \u0026#39;Z\u0026#39; å½±å“äº†B[4]: \u0026#39;e\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-11] = \u0026#39;Z\u0026#39; å½±å“äº†B[5]: \u0026#39;f\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-10] = \u0026#39;Z\u0026#39; å½±å“äº†B[6]: \u0026#39;g\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-9] = \u0026#39;Z\u0026#39; å½±å“äº†B[7]: \u0026#39;h\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-8] = \u0026#39;Z\u0026#39; å½±å“äº†B[8]: \u0026#39;i\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; ğŸ¯ A[-7] = \u0026#39;Z\u0026#39; å½±å“äº†B[9]: \u0026#39;j\u0026#39; -\u0026gt; \u0026#39;Z\u0026#39; â† A[-16]~A[-7]å®Œå…¨æ§åˆ¶Bæ•°ç»„ï¼ å®‰å…¨æ¼”ç¤ºè¾“å‡ºç¤ºä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 å±é™©çš„æ•°ç»„è¶Šç•Œè®¿é—®æ¼”ç¤º ======================== ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ ç®¡ç†å‘˜æƒé™: NOADMIN === å†…å­˜å¸ƒå±€ä¿¡æ¯ === user_inputåœ°å€: 0x5561d97b2018 admin_flagåœ°å€: 0x5561d97b2028 ä¸¤è€…è·ç¦»: 16 å­—èŠ‚ âš ï¸ admin_flagåœ¨user_inputå16å­—èŠ‚ âš ï¸ user_input[16] å¯ä»¥ä¿®æ”¹admin_flag[0] --- æµ‹è¯•1: æ­£å¸¸è¾“å…¥ --- å¤„ç†ç”¨æˆ·è¾“å…¥: hello ç”¨æˆ·è¾“å…¥å·²ä¿å­˜ æ£€æŸ¥ç®¡ç†å‘˜æƒé™... å½“å‰ç®¡ç†å‘˜æ ‡å¿—: NOADMIN ğŸ”’ æ™®é€šç”¨æˆ·æƒé™ï¼Œæ— æ³•æ‰§è¡Œç‰¹æƒæ“ä½œã€‚ --- æµ‹è¯•2: é•¿è¾“å…¥ï¼ˆå¯èƒ½çš„æ”»å‡»ï¼‰--- å°è¯•é€šè¿‡é•¿è¾“å…¥è¦†ç›–admin_flag... æ¶æ„è¾“å…¥é•¿åº¦: 21 å­—èŠ‚ å¤„ç†ç”¨æˆ·è¾“å…¥: XXXXXXXXXXXXXXXXADMIN ç”¨æˆ·è¾“å…¥å·²ä¿å­˜ æ£€æŸ¥ç®¡ç†å‘˜æƒé™... å½“å‰ç®¡ç†å‘˜æ ‡å¿—: ADMININ ğŸ”“ ç®¡ç†å‘˜æƒé™å·²æ¿€æ´»ï¼å¯ä»¥æ‰§è¡Œç‰¹æƒæ“ä½œã€‚ â† æ”»å‡»æˆåŠŸï¼ ğŸ’€ æ”»å‡»æˆåŠŸï¼é€šè¿‡ç¼“å†²åŒºæº¢å‡ºè·å¾—äº†ç®¡ç†å‘˜æƒé™ï¼ D. ç›¸å…³èµ„æº C11æ ‡å‡†æ–‡æ¡£ GCCæ–‡æ¡£ - AddressSanitizer Linuxå†…å­˜ç®¡ç† ğŸ“ ç»“è®º é€šè¿‡è¯¦ç»†çš„å®éªŒéªŒè¯ï¼Œæˆ‘ä»¬å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\nğŸ¯ ç›´æ¥å›ç­”åŸé—®é¢˜ï¼š A[12]ä¸ä¼šå´©æºƒï¼Œå¯ä»¥æ­£å¸¸è®¿é—® Aæ•°ç»„å¯ä»¥ç›´æ¥æ”¹å†™Bæ•°ç»„çš„å†…å®¹ ğŸ”¬ æŠ€æœ¯å‘ç°ï¼š å†…å­˜å¸ƒå±€ï¼šBæ•°ç»„åœ¨Aæ•°ç»„å‰16å­—èŠ‚ï¼Œç¼–è¯‘å™¨åœ¨å®ƒä»¬ä¹‹é—´ç•™æœ‰6å­—èŠ‚å¡«å…… è®¿é—®æ–¹å¼ï¼šé€šè¿‡A[-16] ~ A[-7]å¯ä»¥å®Œå…¨æ§åˆ¶B[0] ~ B[9] æ£€æµ‹å·¥å…·ï¼šAddressSanitizerèƒ½æ£€æµ‹åˆ°å¤§èŒƒå›´è¶Šç•Œï¼Œä½†å¯¹å°èŒƒå›´è¶Šç•Œä¸æ•æ„Ÿ âš ï¸ å®‰å…¨è­¦å‘Šï¼š æœªå®šä¹‰è¡Œä¸ºï¼šè¿™ç§è®¿é—®æ–¹å¼æ˜¯Cæ ‡å‡†æœªå®šä¹‰çš„è¡Œä¸º æåº¦å±é™©ï¼šAæ•°ç»„èƒ½å®Œå…¨æ§åˆ¶Bæ•°ç»„ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡å®‰å…¨é—®é¢˜ ä¸å¯ç§»æ¤ï¼šä¸åŒç¼–è¯‘å™¨ã€å¹³å°å¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„è¡Œä¸º ğŸ’¡ æœ€ä½³å®è·µï¼š æ°¸è¿œä¸è¦ä¾èµ–è¿™ç§è¡Œä¸º ä½¿ç”¨è¾¹ç•Œæ£€æŸ¥å’Œå®‰å…¨çš„æ•°æ®ç»“æ„ å¯ç”¨æ‰€æœ‰ç¼–è¯‘å™¨è­¦å‘Šå’Œé™æ€åˆ†æå·¥å…· æœ€é‡è¦çš„æé†’ï¼šè™½ç„¶æµ‹è¯•æ˜¾ç¤ºä¸ä¼šå´©æºƒï¼Œä½†è¿™ç§è¡Œä¸ºæ˜¯ä¸å¯é¢„æµ‹å’Œä¸å¯ç§»æ¤çš„ã€‚åœ¨ä»»ä½•ç”Ÿäº§ç¯å¢ƒä¸­éƒ½åº”è¯¥é¿å…æ•°ç»„è¶Šç•Œè®¿é—®ã€‚\næŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š2025å¹´9æœˆ12æ—¥\næµ‹è¯•ç¯å¢ƒï¼šLinux x86_64, GCCç¼–è¯‘å™¨\n","date":"2025-09-12T00:00:00Z","permalink":"https://zhangquanhua1.github.io/p/%E5%85%A8%E5%B1%80%E6%95%B0%E7%BB%84%E8%B6%8A%E7%95%8C%E8%AE%BF%E9%97%AE%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/","title":"å…¨å±€æ•°ç»„è¶Šç•Œè®¿é—®è¡Œä¸ºåˆ†æ"},{"content":"å†…å­˜è¸©è¸ç°è±¡åˆ†ææŠ¥å‘Š - Aæ“ä½œBå†…å­˜ä½†Aä¸å´©æºƒï¼ŒBè®¿é—®æ—¶å´©æºƒ ğŸ“‹ ç›®å½• é—®é¢˜èƒŒæ™¯ ç°è±¡åˆ†æ æµ‹è¯•éªŒè¯ æŠ€æœ¯åŸç† å®é™…æ¡ˆä¾‹ æ£€æµ‹æ–¹æ³• é˜²æŠ¤æªæ–½ å®Œæ•´æµ‹è¯•ä»£ç  é—®é¢˜èƒŒæ™¯ ğŸ” æ ¸å¿ƒé—®é¢˜ æ˜¯å¦å­˜åœ¨Aã€Bä¸¤ä¸ªå˜é‡ï¼ŒAæ“ä½œäº†Bçš„å†…å­˜ï¼Œä½†æ˜¯Aæ²¡æœ‰å´©æºƒï¼Œè€ŒBå»æ­£å¸¸è®¿é—®è‡ªå·±çš„å†…å®¹æ—¶å´©æºƒçš„æƒ…å†µï¼Ÿ\nè¿™ä¸ªé—®é¢˜æŒ‡å‘äº†ä¸€ä¸ªéå¸¸é‡è¦çš„å†…å­˜å®‰å…¨æ¦‚å¿µï¼š**å†…å­˜è¸©è¸ï¼ˆMemory Corruptionï¼‰**çš„å»¶è¿Ÿæ•ˆåº”ã€‚\nğŸ¯ é—®é¢˜çš„å®é™…æ„ä¹‰ è¿™ç§ç°è±¡åœ¨å®é™…è½¯ä»¶å¼€å‘ä¸­ç»å¸¸é‡åˆ°ï¼Œç‰¹åˆ«æ˜¯ï¼š\nç³»ç»Ÿå´©æºƒéš¾ä»¥å®šä½ï¼šå´©æºƒç‚¹ä¸æ˜¯çœŸæ­£çš„é—®é¢˜æ ¹æº é—´æ­‡æ€§bugï¼šåŒæ ·çš„æ“ä½œæœ‰æ—¶å´©æºƒæœ‰æ—¶ä¸å´©æºƒ å¤šçº¿ç¨‹ç¯å¢ƒï¼šä¸€ä¸ªçº¿ç¨‹çš„é”™è¯¯å¯¼è‡´å¦ä¸€ä¸ªçº¿ç¨‹å´©æºƒ ç°è±¡åˆ†æ âœ… ç­”æ¡ˆï¼šç¡®å®å­˜åœ¨è¿™ç§æƒ…å†µï¼ è¿™ç§ç°è±¡ä¸ä»…å­˜åœ¨ï¼Œè€Œä¸”åœ¨å®é™…å¼€å‘ä¸­ç›¸å½“å¸¸è§ã€‚ä¸»è¦åŸå› åŒ…æ‹¬ï¼š\nå†…å­˜å¸ƒå±€çš„ç‰¹æ®Šæ€§ æ“ä½œç³»ç»Ÿå†…å­˜ä¿æŠ¤çš„å»¶è¿Ÿæ€§ å†…å­˜ç®¡ç†æœºåˆ¶çš„å¤æ‚æ€§ ç¼–è¯‘å™¨ä¼˜åŒ–çš„å½±å“ ğŸ“Š å…¸å‹åœºæ™¯åˆ†æ åœºæ™¯ç±»å‹ Açš„æ“ä½œ Açš„ç»“æœ Bçš„æ“ä½œ Bçš„ç»“æœ å †å†…å­˜è¸©è¸ è¶Šç•Œå†™å…¥32å­—èŠ‚ âœ… ä¸å´©æºƒ realloc() ğŸ’¥ å´©æºƒ æ ˆå¸§ç ´å æ ˆæº¢å‡º âœ… ä¸å´©æºƒ å‡½æ•°è¿”å› ğŸ’¥ å´©æºƒ å‡½æ•°æŒ‡é’ˆç¯¡æ”¹ ä¿®æ”¹å‡½æ•°æŒ‡é’ˆè¡¨ âœ… ä¸å´©æºƒ è°ƒç”¨å‡½æ•°æŒ‡é’ˆ ğŸ’¥ æ‰§è¡Œé”™è¯¯ä»£ç  å¤šçº¿ç¨‹ç«äº‰ è¶Šç•Œå†™å…±äº«å†…å­˜ âœ… ä¸å´©æºƒ è¯»å–è¢«è¸©è¸åŒºåŸŸ ğŸ’¥ å´©æºƒ æµ‹è¯•éªŒè¯ ğŸ§ª å®éªŒè®¾è®¡ æˆ‘ä»¬è®¾è®¡äº†5ä¸ªæµ‹è¯•åœºæ™¯æ¥éªŒè¯è¿™ç§ç°è±¡ï¼š\n1. ç›¸é‚»å…¨å±€æ•°ç»„æµ‹è¯• 1 2 3 4 5 char global_A[10]; char global_B[10]; // Aé€šè¿‡è¶Šç•Œè®¿é—®ä¿®æ”¹Bçš„å†…å­˜ // Bæ­£å¸¸è®¿é—®è‡ªå·±çš„å†…å­˜æ—¶å¯èƒ½å´©æºƒ 2. å †å†…å­˜è¸©è¸æµ‹è¯• â­ 1 2 3 4 5 6 7 8 char* heap_A = malloc(16); char* heap_B = malloc(16); // Aè¶Šç•Œå†™å…¥32å­—èŠ‚ï¼Œç ´åå †ç®¡ç†ç»“æ„ memset(heap_A, \u0026#39;X\u0026#39;, 32); // Aä¸å´©æºƒ // Bè¿›è¡Œæ­£å¸¸å†…å­˜æ“ä½œ heap_B = realloc(heap_B, 32); // Bå´©æºƒï¼ 3. æ ˆå†…å­˜è¸©è¸æµ‹è¯• 1 2 3 4 5 6 7 8 9 10 11 12 void function_A() { char buffer[16]; // æ ˆæº¢å‡ºï¼Œç ´åå…¶ä»–æ ˆå¸§ char overflow[2048]; memset(overflow, \u0026#39;X\u0026#39;, sizeof(overflow)); // Aä¸å´©æºƒ } void function_B() { char local_data[16]; // æ­£å¸¸è®¿é—®æ ˆæ•°æ® printf(\u0026#34;%s\u0026#34;, local_data); // å¯èƒ½å´©æºƒ } 4. å‡½æ•°æŒ‡é’ˆè¡¨è¸©è¸ 1 2 3 4 5 6 7 FunctionPtr function_table[5]; // Aä¿®æ”¹å‡½æ•°æŒ‡é’ˆè¡¨ function_table[2] = corrupted_function; // Aä¸å´©æºƒ // Bè°ƒç”¨å‡½æ•°æŒ‡é’ˆ function_table[2](); // Bæ‰§è¡Œäº†é”™è¯¯çš„å‡½æ•° 5. å¤šçº¿ç¨‹å†…å­˜è¸©è¸ 1 2 3 4 5 6 7 8 // çº¿ç¨‹Aï¼šè¶Šç•Œå†™å…¥å…±äº«æ•°æ® for (int i = 0; i \u0026lt; 150; i++) { shared_data[i] = 0xDEADBEEF; // è¶…å‡º100çš„èŒƒå›´ } // çº¿ç¨‹Bï¼šæ­£å¸¸è®¿é—®æ•°æ® char* ptr = (char*)\u0026amp;shared_data[99] + 10; char value = *ptr; // å¯èƒ½è®¿é—®è¢«è¸©è¸çš„å†…å­˜ ğŸ“ˆ å®é™…æµ‹è¯•ç»“æœ è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ç¨‹åºå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 === æµ‹è¯•åœºæ™¯2ï¼šå †å†…å­˜è¸©è¸ === heap_Aåœ°å€: 0x55d2ef0d86b0 heap_Båœ°å€: 0x55d2ef0d86d0 è·ç¦»: 32 å­—èŠ‚ æ­¥éª¤1ï¼šAè¿›è¡Œè¶Šç•Œå†™å…¥æ“ä½œ... âœ… Açš„è¶Šç•Œå†™å…¥æ“ä½œå®Œæˆï¼ŒAæ²¡æœ‰å´©æºƒ æ­¥éª¤2ï¼šBè¿›è¡Œæ­£å¸¸çš„å†…å­˜æ“ä½œ... realloc(): invalid old size [ç¨‹åºå´©æºƒ] âœ… éªŒè¯æˆåŠŸï¼ Açš„è¶Šç•Œå†™å…¥æ²¡æœ‰å´©æºƒï¼Œä½†Bçš„æ­£å¸¸reallocæ“ä½œå´©æºƒäº†ï¼\næŠ€æœ¯åŸç† ğŸ”¬ ä¸ºä»€ä¹ˆAä¸å´©æºƒï¼Ÿ 1. å†…å­˜ä¿æŠ¤çš„ç²’åº¦é™åˆ¶ 1 2 3 4 5 6 7 8 æ“ä½œç³»ç»Ÿå†…å­˜ä¿æŠ¤ä»¥é¡µä¸ºå•ä½ï¼ˆé€šå¸¸4KBï¼‰ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ 4KB é¡µé¢ â”‚ â”‚ heap_A[16] â”‚ heap_B[16] â”‚ å…¶ä»–æ•°æ® â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†‘ â†‘ Aè¶Šç•Œå†™å…¥32å­—èŠ‚ï¼Œä»åœ¨åŒä¸€é¡µé¢å†… æ“ä½œç³»ç»Ÿä¸ä¼šè§¦å‘æ®µé”™è¯¯ 2. å †ç®¡ç†ç»“æ„çš„ä½ç½® 1 2 3 4 5 6 7 8 å…¸å‹çš„å †å†…å­˜å¸ƒå±€ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç®¡ç†å¤´éƒ¨ â”‚ heap_A â”‚ ç®¡ç†å¤´éƒ¨ â”‚ heap_B â”‚ â”‚ (8å­—èŠ‚) â”‚ (16å­—èŠ‚) â”‚ (8å­—èŠ‚) â”‚ (16å­—èŠ‚) â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†‘ â†‘ Aè¶Šç•Œå†™å…¥ç ´åäº†Bçš„ç®¡ç†å¤´éƒ¨ ä½†Açš„å†™å…¥æ“ä½œæœ¬èº«ä¸ä¼šå´©æºƒ 3. å†™å…¥æ“ä½œçš„ç‰¹æ€§ å†…å­˜å†™å…¥é€šå¸¸åªæ£€æŸ¥é¡µé¢æƒé™ ä¸æ£€æŸ¥å…·ä½“çš„å¯¹è±¡è¾¹ç•Œ åªè¦åœ°å€å¯å†™ï¼Œæ“ä½œå°±ä¼šæˆåŠŸ ğŸ’¥ ä¸ºä»€ä¹ˆBä¼šå´©æºƒï¼Ÿ 1. å †ç®¡ç†ç»“æ„è¢«ç ´å 1 2 3 4 5 6 7 8 9 // æ­£å¸¸çš„å †å—å¤´éƒ¨ä¿¡æ¯ struct heap_chunk { size_t size; // å—å¤§å° size_t prev_size; // å‰ä¸€å—å¤§å° // å…¶ä»–ç®¡ç†ä¿¡æ¯ }; // Açš„è¶Šç•Œå†™å…¥ç ´åäº†è¿™äº›ä¿¡æ¯ // å½“Bè°ƒç”¨reallocæ—¶ï¼Œå †ç®¡ç†å™¨è¯»å–åˆ°é”™è¯¯çš„ä¿¡æ¯ 2. æ•°æ®ç»“æ„ä¸€è‡´æ€§æ£€æŸ¥ 1 2 3 4 // reallocå†…éƒ¨ä¼šè¿›è¡Œä¸€è‡´æ€§æ£€æŸ¥ if (chunk-\u0026gt;size != expected_size) { abort(); // æ£€æµ‹åˆ°æ•°æ®æŸåï¼Œä¸»åŠ¨å´©æºƒ } 3. å»¶è¿Ÿçš„å†…å­˜è®¿é—® 1 2 3 4 // Açš„ç ´åæ˜¯\u0026#34;å®šæ—¶ç‚¸å¼¹\u0026#34; A_corrupts_memory(); // åŸ‹ä¸‹ç‚¸å¼¹ï¼Œä¸çˆ†ç‚¸ // ... å…¶ä»–æ“ä½œ ... B_accesses_memory(); // è§¦å‘ç‚¸å¼¹ï¼Œå´©æºƒ å®é™…æ¡ˆä¾‹ ğŸ” ä½ æåˆ°çš„softbus_serverå´©æºƒ æ ¹æ®ä½ æä¾›çš„å´©æºƒä¿¡æ¯ï¼š\n1 2 3 4 5 Pid:700, Uid:1024, Process name:softbus_server Tid:1193, Name:nStackXDFinder #00 pc 0000000000308720 Not mapped #01 pc 000000000015272c PostAuthEvent.cfi #02 pc 000000000001884c libnstackx_ctrl.z.so åˆ†æï¼š\nçº¿ç¨‹1193æœ¬ä¸åº”è¯¥è°ƒç”¨PostAuthEvent ä½†å´©æºƒå †æ ˆæ˜¾ç¤ºç¡®å®è°ƒç”¨äº† è®¿é—®äº†æœªæ˜ å°„çš„å†…å­˜åœ°å€0x308720 å¯èƒ½çš„å†…å­˜è¸©è¸åœºæ™¯ï¼š\n1 2 3 4 5 6 7 8 9 // åœºæ™¯1ï¼šå‡½æ•°æŒ‡é’ˆè¢«è¸©è¸ typedef void (*EventHandler)(int event, void* data); EventHandler handler = normal_handler; // å…¶ä»–çº¿ç¨‹çš„å†…å­˜æ“ä½œæ„å¤–ä¿®æ”¹äº†handler // handlerç°åœ¨æŒ‡å‘äº†PostAuthEvent // å½“nStackXDFinderè°ƒç”¨handleræ—¶ handler(event, data); // å®é™…è°ƒç”¨äº†PostAuthEvent 1 2 3 4 5 6 7 8 9 10 // åœºæ™¯2ï¼šå›è°ƒå‡½æ•°è¡¨è¢«ç ´å struct callback_table { EventHandler handlers[10]; }; // æŸä¸ªè¶Šç•Œå†™å…¥æ“ä½œä¿®æ”¹äº†å›è°ƒè¡¨ // handlers[5] = PostAuthEvent; // nStackXDFinderè°ƒç”¨å›è°ƒ callbacks.handlers[5](event, data); // æ„å¤–è°ƒç”¨PostAuthEvent ğŸ”§ æ’æŸ¥å»ºè®® æ£€æŸ¥nStackXDFinderçº¿ç¨‹ä¸­çš„å‡½æ•°æŒ‡é’ˆ æŸ¥çœ‹å…±äº«æ•°æ®ç»“æ„æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹è¸©è¸ ä½¿ç”¨AddressSanitizeræ£€æµ‹å†…å­˜è¸©è¸ æ·»åŠ å‡½æ•°æŒ‡é’ˆæœ‰æ•ˆæ€§æ£€æŸ¥ æ£€æµ‹æ–¹æ³• ğŸ› ï¸ ç¼–è¯‘æ—¶æ£€æµ‹ 1. AddressSanitizer 1 gcc -fsanitize=address -fno-omit-frame-pointer -o program program.c ä¼˜ç‚¹ï¼š\nèƒ½æ£€æµ‹å¤§éƒ¨åˆ†å †æ ˆè¶Šç•Œ æä¾›è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Š æ€§èƒ½å¼€é”€ç›¸å¯¹è¾ƒå° å±€é™æ€§ï¼š\nå¯èƒ½æ¼æ£€å°èŒƒå›´è¶Šç•Œ å¯¹å…¨å±€å˜é‡æ£€æµ‹ä¸å¤Ÿæ•æ„Ÿ 2. Valgrind 1 valgrind --tool=memcheck --leak-check=full ./program 3. é™æ€åˆ†æå·¥å…· 1 2 clang-static-analyzer program.c cppcheck --enable=all program.c ğŸ•µï¸ è¿è¡Œæ—¶æ£€æµ‹ 1. å†…å­˜æ¨¡å¼æ£€æµ‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // åœ¨å…³é”®ä½ç½®æ·»åŠ é­”æ•°æ£€æŸ¥ #define MAGIC_NUMBER 0xDEADBEEF struct protected_data { uint32_t magic_start; char actual_data[100]; uint32_t magic_end; }; void check_integrity(struct protected_data* data) { if (data-\u0026gt;magic_start != MAGIC_NUMBER || data-\u0026gt;magic_end != MAGIC_NUMBER) { printf(\u0026#34;å†…å­˜è¢«è¸©è¸ï¼\\n\u0026#34;); abort(); } } 2. å‡½æ•°æŒ‡é’ˆæœ‰æ•ˆæ€§æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 int is_valid_function_pointer(void* ptr) { // æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦åœ¨åˆæ³•çš„ä»£ç æ®µèŒƒå›´å†… extern char _text_start, _text_end; return (ptr \u0026gt;= (void*)\u0026amp;_text_start \u0026amp;\u0026amp; ptr \u0026lt;= (void*)\u0026amp;_text_end); } void safe_call_function(FunctionPtr func) { if (is_valid_function_pointer((void*)func)) { func(); } else { printf(\u0026#34;æ— æ•ˆçš„å‡½æ•°æŒ‡é’ˆï¼š%p\\n\u0026#34;, (void*)func); } } 3. å†…å­˜åˆ†é…è·Ÿè¸ª 1 2 3 4 5 6 7 8 9 10 // é‡å†™malloc/freeæ¥æ·»åŠ è¾¹ç•Œæ£€æŸ¥ void* debug_malloc(size_t size) { size_t total_size = size + 2 * sizeof(uint32_t); uint32_t* ptr = malloc(total_size); ptr[0] = MAGIC_NUMBER; // å‰å“¨å…µ ptr[(size + sizeof(uint32_t)) / sizeof(uint32_t)] = MAGIC_NUMBER; // åå“¨å…µ return ptr + 1; // è¿”å›å®é™…æ•°æ®åŒºåŸŸ } é˜²æŠ¤æªæ–½ ğŸ›¡ï¸ ç¼–ç¨‹å®è·µ 1. è¾¹ç•Œæ£€æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // å®‰å…¨çš„å­—ç¬¦ä¸²å¤åˆ¶ void safe_strcpy(char* dest, const char* src, size_t dest_size) { if (dest_size \u0026gt; 0) { strncpy(dest, src, dest_size - 1); dest[dest_size - 1] = \u0026#39;\\0\u0026#39;; } } // å®‰å…¨çš„æ•°ç»„è®¿é—® void safe_array_access(int* array, size_t size, size_t index, int value) { if (index \u0026lt; size) { array[index] = value; } else { printf(\u0026#34;æ•°ç»„è¶Šç•Œï¼šç´¢å¼•%zuè¶…å‡ºèŒƒå›´[0, %zu)\\n\u0026#34;, index, size); } } 2. ä½¿ç”¨å®‰å…¨çš„API 1 2 3 4 5 // æ¨èä½¿ç”¨çš„å®‰å…¨å‡½æ•° strcpy â†’ strncpy æˆ– strlcpy sprintf â†’ snprintf gets â†’ fgets memcpy â†’ å¸¦é•¿åº¦æ£€æŸ¥çš„ç‰ˆæœ¬ 3. RAIIå’Œæ™ºèƒ½æŒ‡é’ˆï¼ˆC++ï¼‰ 1 2 3 // ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆé¿å…æ‰‹åŠ¨å†…å­˜ç®¡ç† std::unique_ptr\u0026lt;char[]\u0026gt; buffer(new char[size]); std::vector\u0026lt;char\u0026gt; safe_array(size); // è‡ªåŠ¨è¾¹ç•Œæ£€æŸ¥ ğŸ”’ ç³»ç»Ÿçº§é˜²æŠ¤ 1. æ ˆä¿æŠ¤ 1 2 # ç¼–è¯‘æ—¶å¯ç”¨æ ˆä¿æŠ¤ gcc -fstack-protector-all -o program program.c 2. ASLRï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰ 1 2 3 4 5 # æ£€æŸ¥ASLRçŠ¶æ€ cat /proc/sys/kernel/randomize_va_space # å¯ç”¨ASLR echo 2 \u0026gt; /proc/sys/kernel/randomize_va_space 3. DEP/NX bitï¼ˆæ•°æ®æ‰§è¡Œä¿æŠ¤ï¼‰ 1 2 # ç¼–è¯‘æ—¶å¯ç”¨ gcc -Wl,-z,noexecstack -o program program.c ğŸ§ª æµ‹è¯•ç­–ç•¥ 1. æ¨¡ç³Šæµ‹è¯•ï¼ˆFuzzingï¼‰ 1 2 3 # ä½¿ç”¨AFLè¿›è¡Œæ¨¡ç³Šæµ‹è¯• afl-gcc -o program program.c afl-fuzz -i input_dir -o output_dir ./program 2. å‹åŠ›æµ‹è¯• 1 2 3 4 5 6 7 // å¤šçº¿ç¨‹å‹åŠ›æµ‹è¯• void stress_test() { for (int i = 0; i \u0026lt; 1000000; i++) { // è¿›è¡Œå¤§é‡å†…å­˜æ“ä½œ // è§‚å¯Ÿæ˜¯å¦å‡ºç°å†…å­˜è¸©è¸ } } 3. ä»£ç å®¡æŸ¥é‡ç‚¹ æ‰€æœ‰æ•°ç»„è®¿é—®éƒ½æœ‰è¾¹ç•Œæ£€æŸ¥ æŒ‡é’ˆè¿ç®—æœ‰èŒƒå›´éªŒè¯ å­—ç¬¦ä¸²æ“ä½œä½¿ç”¨å®‰å…¨å‡½æ•° åŠ¨æ€å†…å­˜åˆ†é…åæ£€æŸ¥è¿”å›å€¼ å¤šçº¿ç¨‹è®¿é—®å…±äº«æ•°æ®æœ‰åŒæ­¥ä¿æŠ¤ å®Œæ•´æµ‹è¯•ä»£ç  ğŸ“ æ–‡ä»¶ç»“æ„ 1 2 3 4 test/ â”œâ”€â”€ memory_corruption_test.c # ä¸»æµ‹è¯•ç¨‹åº â”œâ”€â”€ Makefile # ç¼–è¯‘è„šæœ¬ â””â”€â”€ å†…å­˜è¸©è¸åˆ†ææŠ¥å‘Š.md # æœ¬æ–‡æ¡£ ğŸ’» æ ¸å¿ƒæµ‹è¯•ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; #include \u0026lt;signal.h\u0026gt; #include \u0026lt;setjmp.h\u0026gt; #include \u0026lt;pthread.h\u0026gt; // å…¨å±€å˜é‡ç”¨äºæ®µé”™è¯¯å¤„ç† static jmp_buf segfault_buf; static int segfault_occurred = 0; void segfault_handler(int sig) { segfault_occurred = 1; longjmp(segfault_buf, 1); } // æµ‹è¯•åœºæ™¯ï¼šå †å†…å­˜è¸©è¸ void test_heap_memory_corruption() { printf(\u0026#34;=== å †å†…å­˜è¸©è¸æµ‹è¯• ===\\n\u0026#34;); char* heap_A = (char*)malloc(16); char* heap_B = (char*)malloc(16); printf(\u0026#34;heap_Aåœ°å€: %p\\n\u0026#34;, (void*)heap_A); printf(\u0026#34;heap_Båœ°å€: %p\\n\u0026#34;, (void*)heap_B); // Açš„æ¶æ„æ“ä½œï¼šè¶Šç•Œå†™å…¥ signal(SIGSEGV, segfault_handler); if (setjmp(segfault_buf) == 0) { memset(heap_A, \u0026#39;X\u0026#39;, 32); // å†™å…¥32å­—èŠ‚ï¼Œè¶…å‡º16å­—èŠ‚åˆ†é… printf(\u0026#34;âœ… Açš„è¶Šç•Œå†™å…¥å®Œæˆï¼ŒAæ²¡æœ‰å´©æºƒ\\n\u0026#34;); } else { printf(\u0026#34;âŒ Aè¶Šç•Œå†™å…¥æ—¶å´©æºƒ\\n\u0026#34;); return; } // Bçš„æ­£å¸¸æ“ä½œï¼šé‡æ–°åˆ†é…å†…å­˜ if (setjmp(segfault_buf) == 0) { heap_B = (char*)realloc(heap_B, 32); printf(\u0026#34;âœ… Bçš„å†…å­˜æ“ä½œæˆåŠŸ\\n\u0026#34;); } else { printf(\u0026#34;ğŸ’¥ Båœ¨è¿›è¡Œæ­£å¸¸å†…å­˜æ“ä½œæ—¶å´©æºƒï¼\\n\u0026#34;); } // æ¸…ç† if (setjmp(segfault_buf) == 0) { free(heap_A); free(heap_B); printf(\u0026#34;å†…å­˜æ¸…ç†æˆåŠŸ\\n\u0026#34;); } else { printf(\u0026#34;ğŸ’¥ æ¸…ç†å†…å­˜æ—¶å´©æºƒï¼\\n\u0026#34;); } } int main() { printf(\u0026#34;å†…å­˜è¸©è¸æµ‹è¯• - Aæ“ä½œBå†…å­˜ä½†Aä¸å´©æºƒï¼ŒBè®¿é—®æ—¶å´©æºƒ\\n\u0026#34;); printf(\u0026#34;================================================\\n\u0026#34;); test_heap_memory_corruption(); // å…¶ä»–æµ‹è¯•åœºæ™¯... return 0; } ğŸš€ ç¼–è¯‘å’Œè¿è¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 # ç¼–è¯‘ make run-corruption # æˆ–è€…æ‰‹åŠ¨ç¼–è¯‘ gcc -Wall -Wextra -g -O0 -pthread -o memory_corruption_test memory_corruption_test.c # è¿è¡Œ ./memory_corruption_test # ä½¿ç”¨AddressSanitizeræ£€æµ‹ gcc -fsanitize=address -pthread -o memory_corruption_test_asan memory_corruption_test.c ./memory_corruption_test_asan ğŸ“Š é¢„æœŸè¾“å‡º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 å†…å­˜è¸©è¸æµ‹è¯• - Aæ“ä½œBå†…å­˜ä½†Aä¸å´©æºƒï¼ŒBè®¿é—®æ—¶å´©æºƒ ================================================ === æµ‹è¯•åœºæ™¯1ï¼šç›¸é‚»å…¨å±€æ•°ç»„å†…å­˜è¸©è¸ === [ç»“æœæ ¹æ®å†…å­˜å¸ƒå±€è€Œå®š] === æµ‹è¯•åœºæ™¯2ï¼šå †å†…å­˜è¸©è¸ === heap_Aåœ°å€: 0x55f8a1b0a6b0 heap_Båœ°å€: 0x55f8a1b0a6d0 è·ç¦»: 32 å­—èŠ‚ æ­¥éª¤1ï¼šAè¿›è¡Œè¶Šç•Œå†™å…¥æ“ä½œ... âœ… Açš„è¶Šç•Œå†™å…¥æ“ä½œå®Œæˆï¼ŒAæ²¡æœ‰å´©æºƒ æ­¥éª¤2ï¼šBè¿›è¡Œæ­£å¸¸çš„å†…å­˜æ“ä½œ... realloc(): invalid old size [ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ - è¯æ˜äº†æˆ‘ä»¬çš„å‡è®¾] ğŸ“ ç»“è®º ğŸ¯ æ ¸å¿ƒå‘ç° âœ… ç¡®å®å­˜åœ¨Aæ“ä½œBå†…å­˜ä½†Aä¸å´©æºƒï¼ŒBè®¿é—®æ—¶å´©æºƒçš„æƒ…å†µï¼\nğŸ”¬ æŠ€æœ¯æ€»ç»“ ç°è±¡æ™®éæ€§ï¼šè¿™ç§å†…å­˜è¸©è¸ç°è±¡åœ¨å®é™…å¼€å‘ä¸­å¾ˆå¸¸è§ æ ¹æœ¬åŸå› ï¼šæ“ä½œç³»ç»Ÿå†…å­˜ä¿æŠ¤çš„ç²’åº¦å’Œå†…å­˜ç®¡ç†çš„å¤æ‚æ€§ å±é™©æ€§ï¼šå¢åŠ äº†è°ƒè¯•éš¾åº¦ï¼Œå®¹æ˜“è¯¯å¯¼é—®é¢˜å®šä½ å¯æ£€æµ‹æ€§ï¼šéœ€è¦ä¸“é—¨çš„å·¥å…·å’Œæ–¹æ³•æ‰èƒ½æœ‰æ•ˆæ£€æµ‹ âš ï¸ å¯¹ä½ çš„softbus_serveré—®é¢˜çš„å¯ç¤º nStackXDFinderçº¿ç¨‹å¾ˆå¯èƒ½æ˜¯å—å®³è€…ï¼Œè€Œä¸æ˜¯è‚‡äº‹è€… çœŸæ­£çš„é—®é¢˜å¯èƒ½åœ¨å…¶ä»–çº¿ç¨‹çš„å†…å­˜æ“ä½œ å‡½æ•°æŒ‡é’ˆæˆ–å›è°ƒè¡¨å¯èƒ½è¢«å…¶ä»–ä»£ç è¸©è¸ éœ€è¦å…¨é¢æ£€æŸ¥å…±äº«æ•°æ®ç»“æ„çš„å®Œæ•´æ€§ ğŸ’¡ é˜²æŠ¤å»ºè®® å¯ç”¨ç¼–è¯‘å™¨å®‰å…¨é€‰é¡¹ ä½¿ç”¨å†…å­˜æ£€æµ‹å·¥å…· å®æ–½é˜²å¾¡æ€§ç¼–ç¨‹ åŠ å¼ºä»£ç å®¡æŸ¥ å»ºç«‹å†…å­˜å®‰å…¨æµ‹è¯•æµç¨‹ è¿™ç§å†…å­˜è¸©è¸ç°è±¡æ˜¯C/C++ç¨‹åºä¸­æœ€éšè”½å’Œå±é™©çš„bugç±»å‹ä¹‹ä¸€ï¼Œéœ€è¦å¼€å‘è€…ä¿æŒé«˜åº¦è­¦æƒ•å¹¶é‡‡å–å¤šå±‚é˜²æŠ¤æªæ–½ã€‚\næŠ¥å‘Šç”Ÿæˆæ—¶é—´ï¼š2025å¹´9æœˆ12æ—¥\næµ‹è¯•ç¯å¢ƒï¼šLinux x86_64, GCCç¼–è¯‘å™¨\n","date":"2025-09-12T00:00:00Z","permalink":"https://zhangquanhua1.github.io/p/%E5%86%85%E5%AD%98%E8%B8%A9%E8%B8%8F%E7%8E%B0%E8%B1%A1/","title":"å†…å­˜è¸©è¸ç°è±¡"},{"content":"åŠ ç”µå¤ä½ï¼šCPUçš„\u0026quot;æœ¬èƒ½\u0026quot; å½“æŒ‰ä¸‹å¼€æœºé”®ï¼ŒCPUè·å¾—ç”µåŠ›åï¼Œå…¶è¡Œä¸ºç”±ç¡¬ä»¶è®¾è®¡é¢„å…ˆå†³å®šï¼š\né‡ç½®å¯„å­˜å™¨ï¼šå°†æ‰€æœ‰å†…éƒ¨å¯„å­˜å™¨è®¾ç½®ä¸ºå·²çŸ¥çš„åˆå§‹çŠ¶æ€ã€‚\nè¿›å…¥å®æ¨¡å¼ï¼šx86æ¶æ„CPUä¼šè¿›å…¥å®æ¨¡å¼ï¼ˆReal Modeï¼‰ï¼Œåœ¨æ­¤æ¨¡å¼ä¸‹å¯ç›´æ¥è®¿é—®æœ€åˆçš„1MBå†…å­˜ï¼Œæ— å†…å­˜ä¿æŠ¤æˆ–æƒé™åˆ†çº§ã€‚\næ‰§è¡Œç¬¬ä¸€æ¡æŒ‡ä»¤ï¼šCPUçš„ç¨‹åºè®¡æ•°å™¨ï¼ˆCS:IPå¯„å­˜å™¨ï¼‰è¢«ç¡¬ç¼–ç æŒ‡å‘å†…å­˜åœ°å€ 0xFFFF0ã€‚è¯¥åœ°å€ä½äºä¸»æ¿çš„BIOSï¼ˆæˆ–ç°ä»£è®¡ç®—æœºçš„UEFIï¼‰å›ºä»¶èŠ¯ç‰‡ä¸­ã€‚\nè‡³æ­¤ï¼ŒCPUåªæ˜¯æœºæ¢°åœ°æ‰§è¡Œç¡¬ä»¶è®¾è®¡å¥½çš„æ­¥éª¤ï¼Œå¯¹\u0026quot;å†…æ ¸\u0026quot;ä¸€æ— æ‰€çŸ¥ã€‚\nç¬¬ä¸€æ£’ï¼šå›ºä»¶ï¼ˆBIOS/UEFIï¼‰ CPUå¼€å§‹æ‰§è¡Œå›ºä»¶ä¸­çš„ä»£ç ï¼Œå…¶ä¸»è¦ä»»åŠ¡æ˜¯ï¼š\nç¡¬ä»¶è‡ªæ£€ï¼ˆPOSTï¼‰ï¼šæ£€æŸ¥å…³é”®ç¡¬ä»¶ï¼ˆå†…å­˜ã€æ˜¾å¡ã€é”®ç›˜ç­‰ï¼‰æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚\nåˆå§‹åŒ–ç¡¬ä»¶ï¼šé…ç½®ä¸»æ¿èŠ¯ç‰‡ç»„ã€ç£ç›˜æ§åˆ¶å™¨ç­‰ã€‚\nå¯»æ‰¾å¼•å¯¼ç¨‹åºï¼š\nBIOSï¼šæŒ‰ç…§é¢„è®¾é¡ºåºï¼ˆå¦‚ï¼šUç›˜-\u0026gt;ç¡¬ç›˜ï¼‰è¯»å–å­˜å‚¨è®¾å¤‡çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼ˆ512å­—èŠ‚ï¼‰ï¼Œå³ä¸»å¼•å¯¼è®°å½•ï¼ˆMBRï¼‰ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°å†…å­˜åœ°å€ 0x7C00 å¤„ã€‚\nUEFIï¼šæ›´å…ˆè¿›ï¼Œç›´æ¥ä»EFIç³»ç»Ÿåˆ†åŒºä¸­æŸ¥æ‰¾å¹¶åŠ è½½æ‰©å±•æ€§æ›´å¼ºçš„å¼•å¯¼ç¨‹åºæ–‡ä»¶ã€‚\nç§»äº¤æ§åˆ¶æƒï¼šCPUè·³è½¬åˆ° 0x7C00ï¼ˆæˆ–UEFIåŠ è½½çš„å¼•å¯¼ç¨‹åºåœ°å€ï¼‰ï¼Œå¼€å§‹æ‰§è¡Œå¼•å¯¼ç¨‹åºä»£ç ã€‚\nç¬¬äºŒæ£’ï¼šå¼•å¯¼ç¨‹åºï¼ˆBootloaderï¼‰ MBRä¸­çš„ç©ºé—´å¾ˆå°ï¼Œé€šå¸¸åªå­˜æ”¾å¼•å¯¼ç¨‹åºçš„ç¬¬ä¸€é˜¶æ®µã€‚å…¶æ ¸å¿ƒä»»åŠ¡æ˜¯åŠ è½½åŠŸèƒ½æ›´å…¨çš„ç¬¬äºŒé˜¶æ®µå¼•å¯¼ç¨‹åºï¼ˆå¦‚GRUBã€Windows Boot Managerï¼‰ã€‚\nç¬¬äºŒé˜¶æ®µå¼•å¯¼ç¨‹åºçš„å·¥ä½œï¼š\næä¾›èœå•ï¼šå…è®¸ç”¨æˆ·é€‰æ‹©è¦å¯åŠ¨çš„æ“ä½œç³»ç»Ÿï¼ˆå¦‚æœæœ‰å¤šä¸ªï¼‰ã€‚\nè¯†åˆ«æ–‡ä»¶ç³»ç»Ÿï¼šå…·å¤‡è§£æç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚EXT4, NTFSï¼‰çš„èƒ½åŠ›ï¼Œè€Œä¸ä»…ä»…æ˜¯è¯»å†™åŸå§‹æ‰‡åŒºã€‚\nåŠ è½½å†…æ ¸æ˜ åƒï¼šæ ¹æ®é…ç½®ï¼Œä»æ–‡ä»¶ç³»ç»Ÿä¸­æ‰¾åˆ°å†…æ ¸æ–‡ä»¶ï¼ˆå¦‚Linuxçš„ /boot/vmlinuz-xxxï¼‰ï¼Œå¹¶å°†å…¶è¯»å–åˆ°å†…å­˜ä¸­åˆé€‚çš„ä½ç½®ã€‚\nå‡†å¤‡å†…æ ¸è¿è¡Œç¯å¢ƒï¼šè®¾ç½®å¯åŠ¨å‚æ•°ï¼ˆå¦‚æ ¹æ–‡ä»¶ç³»ç»Ÿä½ç½®ã€åˆ†è¾¨ç‡ï¼‰ã€‚\nåˆ‡æ¢CPUæ¨¡å¼ï¼šå°†CPUä»å®æ¨¡å¼åˆ‡æ¢åˆ°ç°ä»£çš„ä¿æŠ¤æ¨¡å¼ï¼ˆProtected Modeï¼‰ æˆ– é•¿æ¨¡å¼ï¼ˆLong Mode, 64ä½ï¼‰ï¼Œä»¥å¯ç”¨è™šæ‹Ÿå†…å­˜ã€æƒé™ä¿æŠ¤ç­‰å…³é”®ç‰¹æ€§ã€‚\nè·³è½¬åˆ°å†…æ ¸ï¼šæœ€åï¼Œå¼•å¯¼ç¨‹åºè·³è½¬ï¼ˆjumpï¼‰ åˆ°å†…æ ¸åœ¨å†…å­˜ä¸­çš„å…¥å£åœ°å€ï¼Œå°†æ§åˆ¶æƒå½»åº•äº¤ç»™å†…æ ¸ã€‚\nå¼•å¯¼ç¨‹åºæ˜¯å†…æ ¸çš„\u0026quot;å¼•è·¯äºº\u0026quot;ï¼Œå®Œæˆäº†ä»\u0026quot;æ‰¾æ‰‡åŒº\u0026quot;åˆ°\u0026quot;æ‰¾æ–‡ä»¶\u0026quot;çš„å…³é”®è·¨è¶Šã€‚\nç¬¬ä¸‰æ£’ï¼šå†…æ ¸å¯åŠ¨ä¸åˆå§‹åŒ– å†…æ ¸å¯åŠ¨æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå¯åˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼š\nç¬¬ä¸€é˜¶æ®µï¼šæ¶æ„ç›¸å…³åˆå§‹åŒ–ï¼ˆæ±‡ç¼–ï¼‰ è¿™æ˜¯å†…æ ¸æœ€å…ˆæ‰§è¡Œçš„ä»£ç ï¼Œç›´æ¥ä¸CPUç¡¬ä»¶äº¤äº’ï¼Œé€šå¸¸ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ï¼š\nè®¾ç½®åˆå§‹å †æ ˆ\næ¸…é™¤BSSæ®µï¼šå°†æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡åŒºåŸŸæ¸…é›¶ã€‚\nè§£å‹å†…æ ¸ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼šè®¸å¤šå‘è¡Œç‰ˆçš„å†…æ ¸æ˜ åƒæ˜¯å‹ç¼©è¿‡çš„ï¼ˆå¦‚vmlinuzï¼‰ï¼Œæ­¤é˜¶æ®µä¼šè¿›è¡Œè‡ªè§£å‹ã€‚\nå¯ç”¨åˆ†é¡µï¼ˆPagingï¼‰ï¼šå»ºç«‹åˆå§‹é¡µè¡¨ï¼Œå¼€å¯MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰ï¼Œè®©CPUä½¿ç”¨è™šæ‹Ÿå†…å­˜åœ°å€ã€‚è¿™æ˜¯ç°ä»£æ“ä½œç³»ç»Ÿçš„åŸºçŸ³ã€‚\nè®¾ç½®ä¸­æ–­æè¿°ç¬¦è¡¨ï¼ˆIDTï¼‰ï¼šä¸ºå¤„ç†ç¡¬ä»¶ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨åšå¥½å‡†å¤‡ã€‚\nè·³è½¬åˆ°ä¸»å…¥å£ç‚¹ï¼šæœ€ç»ˆè·³è½¬åˆ°å¦‚ start_kernel() è¿™æ ·çš„Cè¯­è¨€å‡½æ•°ï¼Œè¿›å…¥å†…æ ¸ä¸»ä½“ã€‚\nç¬¬äºŒé˜¶æ®µï¼šé€šç”¨å†…æ ¸åˆå§‹åŒ–ï¼ˆCè¯­è¨€ï¼‰ start_kernel() æ˜¯å†…æ ¸åˆå§‹åŒ–çš„\u0026quot;ä¸»å‡½æ•°\u0026quot;ï¼Œå®ƒè°ƒç”¨ä¸€ç³»åˆ—åˆå§‹åŒ–å‡½æ•°æ¥æ„å»ºæ•´ä¸ªæ“ä½œç³»ç»Ÿï¼š\nsched_init(): åˆå§‹åŒ–è°ƒåº¦å™¨ï¼Œåˆ›å»º0å·è¿›ç¨‹ï¼ˆidleè¿›ç¨‹ï¼‰ã€‚\nmm_init(): åˆå§‹åŒ–å†…å­˜ç®¡ç†ç³»ç»Ÿï¼ˆä¼™ä¼´ç³»ç»Ÿã€slabåˆ†é…å™¨ï¼‰ã€‚\ntrap_init() / init_IRQ(): å®Œå–„ä¸­æ–­å’Œå¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚\ntime_init(): åˆå§‹åŒ–ç³»ç»Ÿæ—¶é’Ÿï¼Œå†…æ ¸å¼€å§‹æ„ŸçŸ¥æ—¶é—´ã€‚\nvfs_caches_init(): åˆå§‹åŒ–è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆVFSï¼‰ï¼Œä¸ºæŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿåšå‡†å¤‡ã€‚\næŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿï¼šå¯èƒ½å…ˆæŒ‚è½½å†…å­˜ä¸­çš„initramfsï¼ˆä¸´æ—¶æ ¹æ–‡ä»¶ç³»ç»Ÿï¼‰æ¥åŠ è½½å¿…è¦é©±åŠ¨ï¼Œå†æŒ‚è½½çœŸæ­£çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚\nå¯åŠ¨ç¬¬ä¸€ä¸ªç”¨æˆ·ç©ºé—´è¿›ç¨‹ï¼šè¿™æ˜¯å†…æ ¸åˆå§‹åŒ–çš„æœ€åä¸€æ­¥ã€‚å†…æ ¸çº¿ç¨‹ä¼šå°è¯•æ‰§è¡Œç”¨æˆ·ç©ºé—´çš„ /sbin/initï¼ˆæˆ–å…¶é“¾æ¥ï¼Œå¦‚ /lib/systemd/systemdï¼‰ã€‚è¿™ä¸ªè¿›ç¨‹æˆä¸ºæ‰€æœ‰ç”¨æˆ·è¿›ç¨‹çš„ç¥–å…ˆï¼ˆPID 1ï¼‰ã€‚\nä¸€æ—¦ /sbin/init è¢«æ‰§è¡Œï¼Œå†…æ ¸çš„å¯åŠ¨è¿‡ç¨‹å°±æ­£å¼ç»“æŸï¼Œæ§åˆ¶æƒäº¤ç»™äº†ç”¨æˆ·ç©ºé—´ã€‚\nå†…æ ¸å¯åŠ¨åï¼Œå®ƒæ˜¯åå°è¿è¡Œå—ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šå¦ã€‚å†…æ ¸ä¸æ˜¯ä¸€ä¸ªåœ¨\u0026quot;åå°\u0026quot;è¿è¡Œçš„è¿›ç¨‹ã€‚\nè¿™æ˜¯ä¸€ä¸ªå…³é”®åŒºåˆ«ã€‚å†…æ ¸çš„è¿è¡Œæ–¹å¼ä¸æ™®é€šç¨‹åºï¼ˆå‰å°æˆ–åå°ï¼‰æœ‰æœ¬è´¨ä¸åŒï¼š\nå†…æ ¸æ˜¯ï¼š\nå¸¸é©»å†…å­˜çš„ä»£ç å’Œæ•°æ®ï¼šå†…æ ¸å§‹ç»ˆé©»ç•™åœ¨ç‰©ç†å†…å­˜çš„å—ä¿æŠ¤åŒºåŸŸï¼ˆå†…æ ¸ç©ºé—´ï¼‰ã€‚\nè¢«åŠ¨çš„æ‰§è¡Œç¯å¢ƒå’ŒæœåŠ¡æä¾›è€…ï¼šå†…æ ¸è‡ªèº«ä¸ä¼šä¸»åŠ¨æŒç»­è¿è¡Œã€‚å®ƒçš„ä»£ç åœ¨ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸‹è¢«è¢«åŠ¨è°ƒç”¨ï¼š\nç³»ç»Ÿè°ƒç”¨ï¼ˆSyscallï¼‰ï¼šåº”ç”¨ç¨‹åºä¸»åŠ¨è¯·æ±‚æ“ä½œç³»ç»ŸæœåŠ¡ï¼ˆå¦‚è¯»å†™æ–‡ä»¶ï¼‰ï¼Œé€šè¿‡æŒ‡ä»¤ï¼ˆå¦‚syscallï¼‰é™·å…¥å†…æ ¸ã€‚\nç¡¬ä»¶ä¸­æ–­ï¼ˆInterruptï¼‰ï¼šç¡¬ä»¶è®¾å¤‡éœ€è¦CPUå…³æ³¨ï¼ˆå¦‚ç½‘å¡æ”¶åˆ°æ•°æ®ã€æ—¶é’Ÿæ»´ç­”ï¼‰ï¼Œè§¦å‘CPUæ‰§è¡Œå¯¹åº”çš„ä¸­æ–­å¤„ç†ç¨‹åºã€‚\nå¼‚å¸¸ï¼ˆExceptionï¼‰ï¼šCPUæ‰§è¡ŒæŒ‡ä»¤æ—¶å‘ç”Ÿé”™è¯¯ï¼ˆå¦‚é™¤é›¶ï¼‰ï¼Œç”±å†…æ ¸çš„å¼‚å¸¸å¤„ç†ç¨‹åºå¤„ç†ã€‚\næ‰€æœ‰è¿›ç¨‹çš„\u0026quot;åº•å±‚\u0026quot;ï¼šæ¯ä¸ªç”¨æˆ·è¿›ç¨‹éƒ½åƒæ˜¯åœ¨å†…æ ¸è¿™ä¸ª\u0026quot;åœ°åŸº\u0026quot;ä¸Šå»ºç«‹çš„\u0026quot;æˆ¿å­\u0026quot;ã€‚å½“éœ€è¦æ‰§è¡Œç‰¹æƒæ“ä½œæ—¶ï¼Œè¿›ç¨‹å°±\u0026quot;é™·å…¥\u0026quot;åœ°åŸºï¼ˆå†…æ ¸ï¼‰ä¸­å¯»æ±‚å¸®åŠ©ã€‚\nç‰¹å¾ ç”¨æˆ·è¿›ç¨‹ï¼ˆå‰å°/åå°ï¼‰ å†…æ ¸ è¿è¡Œæ–¹å¼ ä¸»åŠ¨æ‰§è¡Œè‡ªå·±çš„ä»£ç æµ è¢«åŠ¨å“åº”ï¼ˆç³»ç»Ÿè°ƒç”¨ã€ä¸­æ–­ã€å¼‚å¸¸ï¼‰ å­˜åœ¨å½¢å¼ è¿›ç¨‹åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå®ä½“ å¸¸é©»å†…å­˜çš„ä»£ç å’Œæ•°æ®ç»“æ„ï¼Œæ˜¯è¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒ CPUæ¨¡å¼ ç”¨æˆ·æ€ å†…æ ¸æ€ï¼ˆå½“è¢«è°ƒç”¨æ—¶ï¼‰ å¦‚ä½•ç»“æŸ è°ƒç”¨exit()æˆ–è¢«æ€æ‰ æ°¸ä¸ç»“æŸï¼Œç›´åˆ°è®¡ç®—æœºå…³æœº æ€»ç»“ä¸ç±»æ¯” è®¡ç®—æœºå¯åŠ¨è¿‡ç¨‹å°±åƒä¸€åœºç²¾å¿ƒè®¾è®¡çš„æ¥åŠ›èµ›ï¼š\nCPUï¼šæ˜¯è¿åŠ¨å‘˜ï¼Œåªæœ‰è·‘æ­¥çš„æœ¬èƒ½ã€‚\nBIOS/UEFIï¼šæ˜¯ç¬¬ä¸€æ£’æ•™ç»ƒï¼ˆæ¥ç”Ÿå©†ï¼‰ï¼Œç¡®ä¿è¿åŠ¨å‘˜å¥åº·å¹¶æŠŠä»–äº¤ç»™ä¸‹ä¸€æ£’ã€‚\nå¼•å¯¼ç¨‹åºï¼ˆGRUBç­‰ï¼‰ï¼šæ˜¯ç¬¬äºŒæ£’é¢†è·‘å‘˜ï¼ˆå®¶åº­æ•™å¸ˆï¼‰ï¼Œå¸¦é¢†è¿åŠ¨å‘˜åˆ°æ­£ç¡®çš„ä½ç½®å¹¶äº¤æ£’ã€‚\nå†…æ ¸ï¼šæ˜¯ç¬¬ä¸‰æ£’è¿åŠ¨å‘˜å…¼ä½“è‚²åœºå»ºç­‘å¸ˆï¼ˆå¤§å­¦ï¼‰ï¼Œå®ƒæ¥ç®¡æ¯”èµ›ï¼Œå¹¶é¦–å…ˆå»ºé€ æ•´ä¸ªä½“è‚²åœºï¼ˆåˆå§‹åŒ–ç³»ç»Ÿï¼‰ï¼Œç„¶ååˆ¶å®šè§„åˆ™ï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œè£åˆ¤æ¯”èµ›ï¼ˆè°ƒåº¦è¿›ç¨‹ï¼‰ã€‚\ninit / systemdï¼šæ˜¯èµ›åæ´»åŠ¨ç»„ç»‡è€…ï¼Œæ ¹æ®è§„åˆ™å¯åŠ¨å„ç§æ¸¸æˆå’ŒæœåŠ¡ï¼ˆç”¨æˆ·è¿›ç¨‹ï¼‰ã€‚\nå†…æ ¸å¹¶éåå°å®ˆæŠ¤è¿›ç¨‹ï¼Œè€Œæ˜¯ç³»ç»Ÿçš„åŸºçŸ³ã€‚å®ƒé™é»˜åœ°å­˜åœ¨äºå†…å­˜ä¸­ï¼Œç­‰å¾…è¢«åº”ç”¨ç¨‹åºå’Œç¡¬ä»¶äº‹ä»¶è°ƒç”¨ï¼Œä»è€Œä¸ºæ‰€æœ‰ç¨‹åºæä¾›å®‰å…¨ã€å¯é ã€ç»Ÿä¸€çš„ç¡¬ä»¶è®¿é—®å’Œç®¡ç†æœåŠ¡ã€‚\n","date":"2025-09-06T00:00:00Z","permalink":"https://zhangquanhua1.github.io/p/linux%E5%86%85%E6%A0%B8%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/","title":"Linuxå†…æ ¸å¯åŠ¨æµç¨‹"},{"content":"å†…æ ¸ç®¡ç†è¿›ç¨‹çš„æ ¸å¿ƒå¯ä»¥æ¦‚æ‹¬ä¸ºï¼šâ€œä¸€æŠ½è±¡ï¼Œä¸¤åˆ†ç¦»ï¼Œå››ç®¡ç†â€ã€‚\nä¸€æŠ½è±¡ï¼šå°†è¿è¡Œä¸­çš„ç¨‹åºæŠ½è±¡ä¸ºè¿›ç¨‹ï¼ˆProcessï¼‰ã€‚\nä¸¤åˆ†ç¦»ï¼šå®ç°CPUè™šæ‹ŸåŒ–ï¼ˆåˆ†æ—¶å¤ç”¨ï¼‰å’Œå†…å­˜è™šæ‹ŸåŒ–ï¼ˆæ¯ä¸ªè¿›ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼‰ã€‚\nå››ç®¡ç†ï¼šé€šè¿‡è¿›ç¨‹æè¿°ç¬¦ï¼ˆPCBï¼‰ã€è¿›ç¨‹è°ƒåº¦ã€å†…å­˜ç®¡ç†å’Œè¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰Â è¿™å››å¤§æœºåˆ¶æ¥å…·ä½“å®ç°ç®¡ç†ã€‚\nä¸‹é¢æˆ‘ä»¬è¯¦ç»†å±•å¼€ã€‚\n1. è¿›ç¨‹çš„æŠ½è±¡ï¼šè¿›ç¨‹æè¿°ç¬¦ï¼ˆPCBï¼‰ å†…æ ¸è¦ç®¡ç†è¿›ç¨‹ï¼Œé¦–å…ˆå¿…é¡»èƒ½æè¿°ä¸€ä¸ªè¿›ç¨‹ã€‚å†…æ ¸é€šè¿‡ä¸€ä¸ªç§°ä¸ºè¿›ç¨‹æ§åˆ¶å—ï¼ˆPCB, Process Control Blockï¼‰Â çš„æ•°æ®ç»“æ„æ¥ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹ã€‚åœ¨Linuxä¸­ï¼Œè¿™å°±æ˜¯Â task_structÂ ç»“æ„ä½“ï¼ˆéå¸¸åºå¤§ï¼ŒåŒ…å«ä¸Šç™¾ä¸ªå­—æ®µï¼‰ã€‚\nè¿™ä¸ªç»“æ„ä½“æ˜¯å†…æ ¸ç®¡ç†è¿›ç¨‹çš„æ ¸å¿ƒï¼Œå®ƒå°±åƒä¸€ä¸ªè¿›ç¨‹çš„â€œæˆ·å£æœ¬â€æˆ–â€œç—…å†â€ï¼Œè®°å½•äº†å…³äºè¯¥è¿›ç¨‹çš„ä¸€åˆ‡ä¿¡æ¯ï¼Œä¸»è¦åŒ…æ‹¬ï¼š\nè¿›ç¨‹æ ‡è¯†ç¬¦ï¼ˆPIDï¼‰ï¼šå”¯ä¸€çš„èº«ä»½è¯ï¼Œç”¨äºåŒºåˆ†ä¸åŒè¿›ç¨‹ã€‚\nè¿›ç¨‹çŠ¶æ€ï¼šè¿è¡Œã€å°±ç»ªã€ç¡çœ ã€åƒµå°¸çŠ¶æ€ç­‰ã€‚\nç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ï¼šè®°å½•ä¸‹ä¸€æ¡è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ã€‚\nCPUå¯„å­˜å™¨ï¼šå½“è¿›ç¨‹è¢«åˆ‡æ¢æ—¶ï¼Œéœ€è¦ä¿å­˜å½“å‰çš„å¯„å­˜å™¨çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡æ¢å¤ã€‚\nå†…å­˜ç®¡ç†ä¿¡æ¯ï¼šæŒ‡å‘é¡µè¡¨ï¼ˆPage Tableï¼‰çš„æŒ‡é’ˆï¼Œè¿™æ˜¯å®ç°è™šæ‹Ÿå†…å­˜çš„å…³é”®ã€‚\næ–‡ä»¶æè¿°ç¬¦è¡¨ï¼šè®°å½•è¯¥è¿›ç¨‹æ‰“å¼€äº†å“ªäº›æ–‡ä»¶ã€‚\nèµ„æºä½¿ç”¨ä¿¡æ¯ï¼šCPUæ—¶é—´ã€å†…å­˜ä½¿ç”¨é‡ç­‰ã€‚\nä¼˜å…ˆçº§ï¼šç”¨äºè°ƒåº¦å™¨å†³å®šè°å…ˆè¿è¡Œã€‚\nè¿›ç¨‹é—´å…³ç³»ï¼šçˆ¶è¿›ç¨‹ã€å­è¿›ç¨‹ã€å…„å¼Ÿè¿›ç¨‹ç­‰ä¿¡æ¯ã€‚\nå†…æ ¸å°†æ‰€æœ‰è¿›ç¨‹çš„PCBé€šè¿‡é“¾è¡¨æˆ–æ ‘ç­‰æ•°æ®ç»“æ„ç»„ç»‡èµ·æ¥ã€‚å› æ­¤ï¼Œç®¡ç†è¿›ç¨‹åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå°±æ˜¯ç®¡ç†è¿™äº›Â task_structÂ ç»“æ„ä½“ã€‚\n2. è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆçŠ¶æ€æœºï¼‰ è¿›ç¨‹å¹¶éä»ç”Ÿåˆ°æ­»éƒ½åœ¨è¿è¡Œã€‚å†…æ ¸ä¸ºå…¶å®šä¹‰äº†ä¸€ç³»åˆ—çŠ¶æ€ï¼ˆStateï¼‰ï¼Œå½¢æˆä¸€ä¸ªçŠ¶æ€æœºï¼š\nå°±ç»ªï¼ˆReadyï¼‰ï¼šè¿›ç¨‹å·²å‡†å¤‡å¥½ï¼Œåªç­‰è°ƒåº¦å™¨åˆ†é…CPUå³å¯è¿è¡Œã€‚\nè¿è¡Œï¼ˆRunningï¼‰ï¼šè¿›ç¨‹æ­£åœ¨CPUä¸Šæ‰§è¡Œã€‚\né˜»å¡/ç¡çœ ï¼ˆBlocked/Sleepingï¼‰ï¼šè¿›ç¨‹åœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶ï¼ˆå¦‚ç­‰å¾…ç”¨æˆ·è¾“å…¥ã€ç­‰å¾…ç£ç›˜IOå®Œæˆï¼‰ï¼Œæ­¤æ—¶å®ƒä¸éœ€è¦CPUã€‚\nåƒµå°¸ï¼ˆZombieï¼‰ï¼šè¿›ç¨‹å·²ç»ˆæ­¢ï¼Œä½†å…¶PCBè¿˜æœªè¢«çˆ¶è¿›ç¨‹å›æ”¶ã€‚\nç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šè¿›ç¨‹ç»“æŸï¼Œæ‰€æœ‰èµ„æºè¢«å›æ”¶ã€‚\nå†…æ ¸è´Ÿè´£æ ¹æ®äº‹ä»¶ï¼ˆå¦‚IOå®Œæˆã€æ—¶é—´ç‰‡ç”¨å®Œï¼‰æ¥é©±åŠ¨è¿›ç¨‹åœ¨è¿™äº›çŠ¶æ€é—´è½¬æ¢ã€‚\n3. CPUè™šæ‹ŸåŒ–ï¼šè¿›ç¨‹è°ƒåº¦ï¼ˆSchedulingï¼‰ CPUæ ¸å¿ƒæ•°è¿œå°‘äºè¿›ç¨‹æ•°ï¼Œå†…æ ¸é€šè¿‡è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰Â æ¥åˆ¶é€ â€œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨åŒæ—¶è¿è¡Œâ€çš„å‡è±¡ï¼Œå³åˆ†æ—¶å¤ç”¨ã€‚\nè°ƒåº¦å™¨çš„å·¥ä½œæµç¨‹ï¼š\né€‰æ‹©ï¼šä»å°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œæ ¹æ®ç‰¹å®šçš„è°ƒåº¦ç®—æ³•ï¼ˆå¦‚CFS-å®Œå…¨å…¬å¹³è°ƒåº¦å™¨ï¼‰é€‰æ‹©ä¸€ä¸ªæœ€å€¼å¾—è¿è¡Œçš„è¿›ç¨‹ã€‚\nåˆ‡æ¢ï¼š\nä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆContext Switchï¼‰ï¼šå°†å½“å‰è¿è¡Œè¿›ç¨‹çš„çŠ¶æ€ï¼ˆå¯„å­˜å™¨ã€PCç­‰ï¼‰ä¿å­˜åˆ°å…¶PCBä¸­ã€‚\nåŠ è½½ï¼šå°†ä¸‹ä¸€ä¸ªè¦è¿è¡Œè¿›ç¨‹çš„çŠ¶æ€ä»å…¶PCBä¸­åŠ è½½åˆ°CPUå¯„å­˜å™¨ä¸­ã€‚\nåˆ‡æ¢é¡µè¡¨ï¼Œä»è€Œåˆ‡æ¢å†…å­˜åœ°å€ç©ºé—´ã€‚\næ‰§è¡Œï¼šCPUå¼€å§‹æ‰§è¡Œæ–°è¿›ç¨‹çš„ä»£ç ã€‚\nè§¦å‘è°ƒåº¦çš„æ—¶æœºï¼š\nä¸»åŠ¨è®©å‡ºï¼šè¿›ç¨‹æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚sleep,Â readç­‰å¾…IOï¼‰æˆ–ä¸»åŠ¨yieldã€‚\nè¢«åŠ¨æŠ¢å ï¼šç¡¬ä»¶æ—¶é’Ÿä¸­æ–­å‘ç”Ÿï¼Œè°ƒåº¦å™¨æ£€æŸ¥å½“å‰è¿›ç¨‹çš„æ—¶é—´ç‰‡æ˜¯å¦ç”¨å®Œï¼Œå¦‚æœç”¨å®Œåˆ™å¼ºåˆ¶åˆ‡æ¢ã€‚\né€šè¿‡é¢‘ç¹çš„è°ƒåº¦å’Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå†…æ ¸å®ç°äº†å¤šä¸ªè¿›ç¨‹åœ¨CPUä¸Šçš„â€œåŒæ—¶â€è¿è¡Œã€‚\n4. å†…å­˜è™šæ‹ŸåŒ–ï¼šå†…å­˜ç®¡ç†ï¼ˆMemory Managementï¼‰ æ¯ä¸ªè¿›ç¨‹éƒ½è®¤ä¸ºè‡ªå·±ç‹¬äº«æ•´ä¸ªå†…å­˜ç©ºé—´ã€‚è¿™æ˜¯å†…æ ¸é€šè¿‡è™šæ‹Ÿå†…å­˜æœºåˆ¶å®ç°çš„é­”æ³•ã€‚\nå†…æ ¸ä¸ºæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€å¼ ç‹¬ç«‹çš„é¡µè¡¨ï¼ˆPage Tableï¼‰ï¼š\né¡µè¡¨å®šä¹‰äº†è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»ã€‚\nMMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰åœ¨CPUæ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œé€šè¿‡æŸ¥è¯¢å½“å‰è¿›ç¨‹çš„é¡µè¡¨æ¥è‡ªåŠ¨å®Œæˆåœ°å€è½¬æ¢ã€‚\nè¿™æ ·åšçš„å¥½å¤„ï¼š\néš”ç¦»æ€§ä¸ä¿æŠ¤ï¼šè¿›ç¨‹Aæ— æ³•è®¿é—®è¿›ç¨‹Bçš„å†…å­˜ï¼Œå› ä¸ºå®ƒä»¬çš„è™šæ‹Ÿåœ°å€æ˜ å°„åˆ°ä¸åŒçš„ç‰©ç†é¡µã€‚ä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“æ•´ä¸ªç³»ç»Ÿã€‚\nç®€åŒ–ç¼–ç¨‹ï¼šç¨‹åºå‘˜åªéœ€å…³å¿ƒç»Ÿä¸€çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ— éœ€å…³å¿ƒç‰©ç†å†…å­˜çš„å…·ä½“å¸ƒå±€ã€‚\nå†…æ ¸çš„å†…å­˜ç®¡ç†å­ç³»ç»Ÿè´Ÿè´£åˆ†é…å’Œå›æ”¶ç‰©ç†å†…å­˜é¡µï¼Œå¹¶åœ¨è¿›ç¨‹åˆ‡æ¢æ—¶è´Ÿè´£åˆ‡æ¢é¡µè¡¨åŸºåœ°å€å¯„å­˜å™¨ï¼ˆå¦‚x86çš„CR3ï¼‰ã€‚\n5. è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPC, Inter-Process Communicationï¼‰ è¿›ç¨‹ä¹‹é—´éœ€è¦åä½œï¼Œä½†ç”±äºå†…å­˜éš”ç¦»ï¼Œå®ƒä»¬ä¸èƒ½ç›´æ¥è®¿é—®å¯¹æ–¹çš„åœ°å€ç©ºé—´ã€‚å†…æ ¸æä¾›äº†å¤šç§è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰Â æœºåˆ¶æ¥å®‰å…¨åœ°ä¼ é€’æ•°æ®ï¼š\nç®¡é“ï¼ˆPipeï¼‰ï¼šå•å‘å­—èŠ‚æµï¼Œå¸¸ç”¨äºçˆ¶å­è¿›ç¨‹ã€‚\næ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼šå†…æ ¸ç»´æŠ¤çš„æ¶ˆæ¯é“¾è¡¨ã€‚\nå…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰ï¼šæ•ˆç‡æœ€é«˜çš„æ–¹å¼ã€‚å†…æ ¸å°†åŒä¸€å—ç‰©ç†å†…å­˜æ˜ å°„åˆ°å¤šä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ã€‚\nä¿¡å·ï¼ˆSignalï¼‰ï¼šä¸€ç§å¼‚æ­¥é€šçŸ¥æœºåˆ¶ï¼Œç”¨äºé€šçŸ¥è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²å‘ç”Ÿï¼ˆå¦‚killå‘½ä»¤ï¼‰ã€‚\nä¿¡å·é‡ï¼ˆSemaphoreï¼‰Â å’ŒÂ äº’æ–¥é”ï¼ˆMutexï¼‰ï¼šç”¨äºåŒæ­¥å¯¹å…±äº«èµ„æºçš„è®¿é—®ï¼Œé˜²æ­¢ç«äº‰æ¡ä»¶ã€‚\næ‰€æœ‰è¿™äº›æœºåˆ¶éƒ½ç”±å†…æ ¸æä¾›å’Œç®¡ç†ï¼Œç¡®ä¿äº†é€šä¿¡çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚\n6. ç³»ç»Ÿè°ƒç”¨ï¼šè¿›ç¨‹ä¸å†…æ ¸çš„æ¥å£ ç”¨æˆ·è¿›ç¨‹è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œæƒé™å—é™ã€‚å½“å®ƒéœ€è¦è¯·æ±‚å†…æ ¸çš„æœåŠ¡ï¼ˆå¦‚åˆ›å»ºè¿›ç¨‹ã€è¯»å†™æ–‡ä»¶ã€ç”³è¯·å†…å­˜ï¼‰æ—¶ï¼Œå¿…é¡»é€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callï¼‰ã€‚\nç³»ç»Ÿè°ƒç”¨æ˜¯ç”¨æˆ·è¿›ç¨‹ä¸»åŠ¨é™·å…¥å†…æ ¸çš„å”¯ä¸€æ–¹å¼ã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼š\nè¿›ç¨‹åœ¨å¯„å­˜å™¨ä¸­è®¾ç½®å¥½ç³»ç»Ÿè°ƒç”¨å·å’Œå‚æ•°ã€‚\næ‰§è¡Œä¸€æ¡ç‰¹æ®Šçš„æŒ‡ä»¤ï¼ˆå¦‚syscallæˆ–int 0x80ï¼‰ï¼Œè§¦å‘è½¯ä¸­æ–­ã€‚\nCPUåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œè·³è½¬åˆ°å†…æ ¸ä¸­é¢„å…ˆå®šä¹‰å¥½çš„ç³»ç»Ÿè°ƒç”¨å¤„ç†å‡½æ•°ã€‚\nå†…æ ¸éªŒè¯è¯·æ±‚åˆæ³•æ€§åï¼Œä»£è¡¨è¿›ç¨‹æ‰§è¡Œæ‰€éœ€æ“ä½œã€‚\næ“ä½œå®Œæˆï¼Œå†…æ ¸å°†ç»“æœè¿”å›ç»™è¿›ç¨‹ï¼Œå¹¶åˆ‡æ¢å›ç”¨æˆ·æ€ã€‚\nåˆ›å»ºæ–°è¿›ç¨‹çš„fork()å’ŒåŠ è½½æ–°ç¨‹åºçš„execve()ï¼Œæœ¬èº«å°±æ˜¯ä¸¤ä¸ªæœ€é‡è¦çš„ç³»ç»Ÿè°ƒç”¨ã€‚\næ€»ç»“ï¼šå†…æ ¸å¦‚ä½•ç®¡ç†è¿›ç¨‹ å†…æ ¸é€šè¿‡ä¸€ä¸ªç²¾å·§çš„ä½“ç³»æ¥ç®¡ç†è¿›ç¨‹ï¼š\nç”¨PCBæè¿°è¿›ç¨‹ï¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªtask_structä½œä¸ºç®¡ç†å…ƒæ•°æ®ã€‚\nç”¨çŠ¶æ€æœºç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼šè·Ÿè¸ªæ¯ä¸ªè¿›ç¨‹å¤„äºåˆ›å»ºã€å°±ç»ªã€è¿è¡Œã€é˜»å¡ã€é€€å‡ºç­‰çŠ¶æ€ã€‚\nç”¨è°ƒåº¦å™¨åˆ†é…CPUï¼šé€šè¿‡ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œåˆ†æ—¶å¤ç”¨ï¼Œå®ç°CPUçš„è™šæ‹ŸåŒ–ã€‚\nç”¨é¡µè¡¨éš”ç¦»å†…å­˜ï¼šä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå®ç°å†…å­˜çš„è™šæ‹ŸåŒ–å’Œä¿æŠ¤ã€‚\nç”¨IPCæœºåˆ¶ Facilitate åä½œï¼šæä¾›ç®¡é“ã€å…±äº«å†…å­˜ç­‰æœºåˆ¶ï¼Œè®©éš”ç¦»çš„è¿›ç¨‹èƒ½å®‰å…¨é€šä¿¡ã€‚\nç”¨ç³»ç»Ÿè°ƒç”¨æä¾›æ¥å£ï¼šä½œä¸ºç”¨æˆ·è¿›ç¨‹è¯·æ±‚å†…æ ¸æœåŠ¡çš„å”¯ä¸€å…¥å£ï¼Œä¿è¯å®‰å…¨å’Œå¯æ§ã€‚\næœ€ç»ˆï¼Œå†…æ ¸åƒä¸€ä½äº¤å“ä¹æŒ‡æŒ¥å®¶ï¼Œåè°ƒç€å„ä¸ªè¿›ç¨‹ï¼ˆä¹æ‰‹ï¼‰ï¼Œåˆç†åˆ†é…ç¡¬ä»¶èµ„æºï¼ˆä¹å™¨ï¼‰ï¼Œè®©æ•´ä¸ªç³»ç»Ÿï¼ˆä¹å›¢ï¼‰å’Œè°ã€é«˜æ•ˆåœ°è¿è¡Œã€‚\n","date":"2025-09-06T00:00:00Z","permalink":"https://zhangquanhua1.github.io/p/%E5%86%85%E6%A0%B8%E6%98%AF%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B%E7%9A%84/","title":"å†…æ ¸æ˜¯å¦‚ä½•ç®¡ç†è¿›ç¨‹çš„"},{"content":"æ€»ä½“æ¦‚è§ˆ åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–°ç¨‹åºçš„è¿‡ç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š\nå¤–å£³ï¼ˆShellï¼‰è§£æå‘½ä»¤å¹¶å‡†å¤‡å‚æ•°ã€‚\nfork()ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ã€‚è¿™ä¸ªå­è¿›ç¨‹å‡ ä¹æ˜¯çˆ¶è¿›ç¨‹ï¼ˆå¦‚ Shellï¼‰çš„å®Œç¾å¤åˆ¶å“ã€‚\nexecve()ï¼šåœ¨å­è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œâ€œç¨‹åºæ›¿æ¢â€ã€‚è¿™æ˜¯é­”æ³•å‘ç”Ÿçš„åœ°æ–¹ï¼šå†…æ ¸åœæ­¢å½“å‰å­è¿›ç¨‹çš„è¿è¡Œï¼Œæ¸…ç©ºå…¶å†…å­˜ç©ºé—´ï¼ˆé™¤äº†ä¸€äº›ä¿ç•™ä¿¡æ¯ï¼‰ï¼Œç„¶åå°†æŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°è¯¥å†…å­˜ç©ºé—´ä¸­ï¼Œå¹¶ä¸ºå…¶è®¾ç½®å…¨æ–°çš„è¿è¡Œç¯å¢ƒã€‚\nåŠ¨æ€é“¾æ¥å™¨ï¼ˆå¦‚æœå¿…è¦ï¼‰ä»‹å…¥ï¼ŒåŠ è½½ç¨‹åºæ‰€ä¾èµ–çš„å…±äº«åº“ã€‚\nç¨‹åºå¼€å§‹æ‰§è¡Œï¼Œä»Â main()Â å‡½æ•°å¼€å§‹ã€‚\næ•´ä¸ªè¿‡ç¨‹çš„æ ¸å¿ƒæ˜¯Â execve()Â ç³»ç»Ÿè°ƒç”¨ã€‚ä¸‹å›¾æç»˜äº†è¿™ä¸ªè¿‡ç¨‹çš„å®Œæ•´æµç¨‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 flowchart TD A[ç”¨æˆ·åœ¨Shellä¸­è¾“å…¥å‘½ä»¤] --\u0026gt; B[\u0026#34;Shellè§£æå‘½ä»¤è°ƒç”¨fork()åˆ›å»ºå­è¿›ç¨‹\u0026#34;] B --\u0026gt; C[å­è¿›ç¨‹è°ƒç”¨execveç³»ç»Ÿè°ƒç”¨] C --\u0026gt; D[\u0026#34;å†…æ ¸å¤„ç†execve()è¯·æ±‚\u0026#34;] subgraph D[å†…æ ¸å¤„ç†æµç¨‹] D1[éªŒè¯æ–‡ä»¶æƒé™æ ¼å¼ç­‰] --\u0026gt; D2[é‡Šæ”¾æ—§åœ°å€ç©ºé—´\u0026lt;br\u0026gt;æ‹†æ¯æ—§ä¸–ç•Œ] D2 --\u0026gt; D3[åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶\u0026lt;br\u0026gt;ELFè§£ææ˜ å°„æ–‡æœ¬/æ•°æ®æ®µç­‰] D3 --\u0026gt; D4[\u0026#34;è®¾ç½®æ–°å †æ ˆ\u0026lt;br\u0026gt;å¡«å……å‚æ•°argvã€ç¯å¢ƒå˜é‡envp\u0026#34;] D4 --\u0026gt; D5[è®¾ç½®å¯„å­˜å™¨\u0026lt;br\u0026gt;å°†eipæŒ‡å‘å…¥å£ç‚¹] end D --\u0026gt; E{\u0026#34;æ˜¯å¦ä¸ºåŠ¨æ€é“¾æ¥ç¨‹åº?\u0026#34;} E -- æ˜¯ --\u0026gt; F[\u0026#34;è½½å…¥è§£é‡Šå™¨(ld-linux)\u0026#34;\u0026lt;br\u0026gt;ç”±è§£é‡Šå™¨åŠ è½½æ‰€éœ€å…±äº«åº“] E -- å¦ --\u0026gt; G[è·³è½¬åˆ°ç¨‹åºå…¥å£ç‚¹_start] F --\u0026gt; G G --\u0026gt; H[\u0026#34;æ‰§è¡Œç”¨æˆ·ç¨‹åºçš„main()å‡½æ•°\u0026#34;] H --\u0026gt; I[ç¨‹åºæ­£å¸¸æ‰§è¡Œ] è¯¦ç»†è¿‡ç¨‹åˆ†æ ç¬¬1æ­¥ï¼šShell çš„å·¥ä½œï¼ˆç”¨æˆ·ç©ºé—´ï¼‰ å½“ä½ åœ¨ Shell ä¸­è¾“å…¥Â ./my_program arg1 arg2Â åï¼š\nShell è§£æå‘½ä»¤ï¼Œå°†Â \u0026quot;my_program\u0026quot;,Â \u0026quot;arg1\u0026quot;,Â \u0026quot;arg2\u0026quot;Â åˆ†åˆ«å­˜å‚¨èµ·æ¥ã€‚\nShell è°ƒç”¨Â fork()Â ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ›å»ºä¸€ä¸ªå‡ ä¹æ˜¯è‡ªèº«å‰¯æœ¬çš„å­è¿›ç¨‹ã€‚\nç¬¬2æ­¥ï¼šfork()Â - åˆ›å»ºè¿›ç¨‹èƒšå­ï¼ˆå†…æ ¸ç©ºé—´ï¼‰ fork()Â ç³»ç»Ÿè°ƒç”¨è¢«æ‰§è¡Œï¼ŒCPU é™·å…¥å†…æ ¸ã€‚\nå†…æ ¸åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æè¿°ç¬¦ï¼ˆtask_structï¼‰ï¼Œä¸ºå…¶åˆ†é…ä¸€ä¸ªæ–°çš„Â PIDã€‚\nå†…æ ¸å¤åˆ¶çˆ¶è¿›ç¨‹çš„å‡ ä¹æ‰€æœ‰èµ„æºç»™å­è¿›ç¨‹ï¼ŒåŒ…æ‹¬ï¼š\nå†…å­˜ç©ºé—´ï¼šé€šè¿‡å†™æ—¶å¤åˆ¶ï¼ˆCopy-on-Write, COWï¼‰æŠ€æœ¯ï¼Œåˆ›å»ºä¸€ä¸ªå½“å‰å’Œçˆ¶è¿›ç¨‹å®Œå…¨ä¸€æ ·çš„åœ°å€ç©ºé—´æ˜ å°„ï¼ˆä½†å®é™…ç‰©ç†å†…å­˜é¡µæš‚æ—¶å…±äº«ï¼‰ã€‚\næ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼šå­è¿›ç¨‹ä¹Ÿç»§æ‰¿äº†çˆ¶è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ï¼ˆstdin, stdout, stderrç­‰ï¼‰ã€‚\nè¿›ç¨‹ä¸Šä¸‹æ–‡ï¼ˆå¯„å­˜å™¨çŠ¶æ€ç­‰ï¼‰ã€‚\nç°åœ¨ï¼Œç³»ç»Ÿä¸­æœ‰äº†ä¸¤ä¸ªå‡ ä¹ä¸€æ ·çš„è¿›ç¨‹ï¼šçˆ¶è¿›ç¨‹ï¼ˆShellï¼‰å’Œå­è¿›ç¨‹ã€‚å®ƒä»¬éƒ½ä»Â fork()Â è¿”å›å¼€å§‹æ‰§è¡Œã€‚fork()Â å¯¹çˆ¶è¿›ç¨‹è¿”å›å­è¿›ç¨‹çš„ PIDï¼Œå¯¹å­è¿›ç¨‹è¿”å› 0ã€‚ä»£ç å¯ä»¥é€šè¿‡è¿”å›å€¼åˆ¤æ–­è‡ªå·±æ˜¯çˆ¶æ˜¯å­ã€‚\nç¬¬3æ­¥ï¼šexecve()Â - é­”æ³•æ ¸å¿ƒï¼ˆä»ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´ï¼‰ åœ¨å­è¿›ç¨‹ä¸­ï¼ŒShell çš„å­è¿›ç¨‹å‰¯æœ¬ä¼šè°ƒç”¨Â execve()Â ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶åŸå‹å¤§è‡´å¦‚ä¸‹ï¼š\nint execve(const char *filename, char *const argv[], char *const envp[]);\nfilenameï¼šè¦åŠ è½½çš„ç¨‹åºè·¯å¾„ï¼ˆ\u0026quot;/home/user/my_program\u0026quot;ï¼‰ã€‚\nargvï¼šå‚æ•°æ•°ç»„ï¼ˆ{\u0026quot;my_program\u0026quot;, \u0026quot;arg1\u0026quot;, \u0026quot;arg2\u0026quot;, NULL}ï¼‰ã€‚\nenvpï¼šç¯å¢ƒå˜é‡æ•°ç»„ã€‚\nä¸€æ—¦è°ƒç”¨Â execve()ï¼Œå†…æ ¸å°±å¼€å§‹æ‰§è¡Œä»¥ä¸‹ç¹é‡çš„å·¥ä½œï¼š\na. éªŒè¯ä¸å‡†å¤‡\næ£€æŸ¥æ–‡ä»¶Â filenameÂ æ˜¯å¦å­˜åœ¨ã€æ˜¯å¦å…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚\nè¯»å–æ–‡ä»¶çš„å¤´éƒ¨ï¼ˆHeaderï¼‰ï¼Œè¯†åˆ«å…¶æ ¼å¼ï¼ˆä¾‹å¦‚ ELFã€Mach-Oã€PEï¼‰ã€‚\nb. â€œæ‹†æ¯æ—§ä¸–ç•Œâ€ - é‡Šæ”¾æ—§åœ°å€ç©ºé—´\nå†…æ ¸é‡Šæ”¾å­è¿›ç¨‹å½“å‰æ‹¥æœ‰çš„å‡ ä¹æ‰€æœ‰èµ„æºï¼ˆå†…å­˜ã€ä¿¡å·å¤„ç†å‡½æ•°ç­‰ï¼‰ã€‚ç”±äºä¹‹å‰ç”¨çš„æ˜¯å†™æ—¶å¤åˆ¶ï¼Œæ‰€ä»¥å®é™…å¤åˆ¶çš„ç‰©ç†å†…å­˜é¡µå¾ˆå°‘ï¼Œé‡Šæ”¾ä»£ä»·ä½ã€‚\næ³¨æ„ï¼šè¿™é‡Œä¼šå¤„ç†ä¸€äº›ä¾‹å¤–ï¼Œæ¯”å¦‚æ˜ç¡®è®¾ç½®ä¸ºâ€œæ‰§è¡Œæ—¶å…³é—­â€ï¼ˆclose-on-execï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ä¼šè¢«ä¿ç•™ï¼Œè¿™æ˜¯è¿›ç¨‹é—´é€šä¿¡çš„é‡è¦æ‰‹æ®µã€‚\nc. â€œå»ºç«‹æ–°ä¸–ç•Œâ€ - åŠ è½½æ–°ç¨‹åº\nè§£æå¯æ‰§è¡Œæ–‡ä»¶ï¼šä»¥æœ€å¸¸è§çš„ ELF æ ¼å¼ä¸ºä¾‹ï¼Œå†…æ ¸ä¼šè§£æç¨‹åºå¤´è¡¨ï¼ˆProgram Header Tableï¼‰ï¼Œæ‰¾åˆ°éœ€è¦åŠ è½½çš„æ®µï¼ˆSegmentï¼‰ï¼Œå¦‚ï¼š\n.textÂ æ®µï¼ˆä»£ç æ®µï¼‰ï¼šæ˜ å°„åˆ°å†…å­˜çš„åªè¯»å¯æ‰§è¡ŒåŒºåŸŸã€‚\n.dataÂ æ®µï¼ˆå·²åˆå§‹åŒ–æ•°æ®ï¼‰ï¼šæ˜ å°„åˆ°å†…å­˜çš„å¯è¯»å†™åŒºåŸŸã€‚\n.bssÂ æ®µï¼ˆæœªåˆå§‹åŒ–æ•°æ®ï¼‰ï¼šæ˜ å°„åˆ°åˆå§‹ä¸ºé›¶çš„å¯è¯»å†™åŒºåŸŸã€‚\næ˜ å°„åˆ°å†…å­˜ï¼šå†…æ ¸å¹¶ä¸æ€¥äºå°†æ–‡ä»¶å†…å®¹å…¨éƒ¨è¯»å…¥ç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯åŸºäºå†…å­˜æ˜ å°„ï¼ˆmmapï¼‰Â æœºåˆ¶ï¼Œå»ºç«‹è™šæ‹Ÿåœ°å€åˆ°æ–‡ä»¶åç§»çš„æ˜ å°„å…³ç³»ã€‚åªæœ‰å½“ç¨‹åºå®é™…è®¿é—®æŸå—å†…å­˜æ—¶ï¼Œæ‰ä¼šé€šè¿‡ç¼ºé¡µä¸­æ–­ï¼ˆPage Faultï¼‰Â å°†å¯¹åº”çš„æ–‡ä»¶å†…å®¹åŠ è½½åˆ°ç‰©ç†å†…å­˜ã€‚è¿™æ˜¯æ‡’åŠ è½½ï¼ˆLazy Loadingï¼‰ï¼Œéå¸¸é«˜æ•ˆã€‚\nåŠ è½½è§£é‡Šå™¨ï¼ˆåŠ¨æ€é“¾æ¥å™¨ï¼‰ï¼šå¦‚æœç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥çš„ï¼ˆç»å¤§å¤šæ•°éƒ½æ˜¯ï¼‰ï¼ŒELF æ–‡ä»¶ä¸­ä¼šæŒ‡å®šä¸€ä¸ªâ€œè§£é‡Šå™¨â€ï¼ˆInterpreterï¼‰ï¼Œé€šå¸¸æ˜¯Â /lib64/ld-linux-x86-64.so.2ã€‚å†…æ ¸ä¼šå…ˆå°†è¿™ä¸ªåŠ¨æ€é“¾æ¥å™¨æœ¬èº«åŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´å¹¶æ˜ å°„ã€‚\nd. è®¾ç½®æ–°å †æ ˆå’Œå¯„å­˜å™¨\nè®¾ç½®æ–°å †æ ˆï¼šå†…æ ¸ä¸ºè¿›ç¨‹åˆ†é…æ–°çš„ç”¨æˆ·æ€å †æ ˆï¼Œå¹¶å°†Â argvÂ å’ŒÂ envpÂ ä¸­çš„å‚æ•°å’Œç¯å¢ƒå˜é‡å­—ç¬¦ä¸²å‹å…¥ï¼ˆæˆ–æ”¾ç½®åˆ°ï¼‰å †æ ˆçš„ç‰¹å®šä½ç½®ã€‚\nè®¾ç½®å¯„å­˜å™¨ï¼šåœ¨è¿›ç¨‹çš„å†…æ ¸æ ˆä¸­å‡†å¤‡ä¸€ä¸ªæ–°çš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚æœ€å…³é”®çš„æ˜¯ï¼š\nå°†Â æŒ‡ä»¤æŒ‡é’ˆï¼ˆEIP/RIPï¼‰Â è®¾ç½®ä¸ºæ–°ç¨‹åºçš„å…¥å£ç‚¹ï¼ˆEntry Pointï¼‰ã€‚å¯¹äºé™æ€é“¾æ¥çš„ç¨‹åºï¼Œå…¥å£ç‚¹å°±æ˜¯ç¨‹åºæœ¬èº«çš„Â _startã€‚å¯¹äºåŠ¨æ€é“¾æ¥çš„ç¨‹åºï¼Œå…¥å£ç‚¹æ˜¯åŠ¨æ€é“¾æ¥å™¨çš„å…¥å£ç‚¹ã€‚\nå°†Â æ ˆæŒ‡é’ˆï¼ˆESP/RSPï¼‰Â æŒ‡å‘æ–°è®¾ç½®çš„ç”¨æˆ·å †æ ˆçš„é¡¶éƒ¨ã€‚\nç¬¬4æ­¥ï¼šè¿”å›ç”¨æˆ·ç©ºé—´ï¼Œå¼€å§‹æ‰§è¡Œ å½“Â execve()Â ç³»ç»Ÿè°ƒç”¨åœ¨å†…æ ¸ä¸­å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œåï¼š\nå†…æ ¸å°†ç²¾å¿ƒå‡†å¤‡çš„æ–°ä¸Šä¸‹æ–‡æ¢å¤åˆ° CPU å¯„å­˜å™¨ã€‚\nCPU åˆ‡æ¢å›ç”¨æˆ·æ€ã€‚\næ ¹æ®è®¾ç½®å¥½çš„æŒ‡ä»¤æŒ‡é’ˆï¼ˆEIP/RIPï¼‰ï¼Œå¼€å§‹æ‰§è¡Œä»£ç ã€‚\nç°åœ¨æœ‰ä¸¤ç§æƒ…å†µï¼š\næƒ…å†µAï¼šç¨‹åºæ˜¯é™æ€é“¾æ¥çš„\nCPU ç›´æ¥ä»ç¨‹åºçš„Â _startÂ ç¬¦å·å¼€å§‹æ‰§è¡Œã€‚_startÂ æ˜¯ç¨‹åºçœŸæ­£çš„èµ·ç‚¹ï¼Œç”±å®ƒæ¥åˆå§‹åŒ–è¿è¡Œç¯å¢ƒï¼Œæœ€åè°ƒç”¨Â main()Â å‡½æ•°ã€‚ æƒ…å†µBï¼šç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥çš„ï¼ˆç»å¤§å¤šæ•°ï¼‰\nCPU é¦–å…ˆè·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ï¼ˆld.soï¼‰Â çš„å…¥å£ç‚¹ã€‚\nåŠ¨æ€é“¾æ¥å™¨å¼€å§‹å·¥ä½œï¼š\nå®ƒæ£€æŸ¥ç¨‹åºä¾èµ–å“ªäº›å…±äº«åº“ï¼ˆå¦‚Â libc.so.6ï¼‰ã€‚\né€šè¿‡Â mmap()Â å°†è¿™äº›å…±äº«åº“ä¹ŸåŠ è½½åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚\næ‰§è¡Œé‡å®šä½ï¼ˆRelocationï¼‰Â æ“ä½œï¼Œä¿®æ­£ç¨‹åºä¸­æ‰€æœ‰å¯¹å…±äº«åº“å‡½æ•°ï¼ˆå¦‚Â printfï¼‰çš„å¼•ç”¨åœ°å€ï¼ˆå°†å ä½ç¬¦æ›¿æ¢ä¸ºå®é™…åŠ è½½çš„åœ°å€ï¼‰ã€‚\næ‰§è¡Œå…±äº«åº“çš„åˆå§‹åŒ–ä»£ç ã€‚\næœ€åï¼ŒåŠ¨æ€é“¾æ¥å™¨è·³è½¬åˆ°åŸå§‹ç¨‹åºçš„Â _startÂ å…¥å£ç‚¹ã€‚\nç¬¬5æ­¥ï¼šæ‰§è¡ŒÂ main()Â å‡½æ•° æ— è®ºæ˜¯å¦ç»è¿‡åŠ¨æ€é“¾æ¥ï¼Œæœ€ç»ˆæ§åˆ¶æƒéƒ½ä¼šäº¤åˆ°ç¨‹åºæœ¬èº«çš„Â _startÂ å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ç”±ç¼–è¯‘å™¨æä¾›çš„ï¼Œå®ƒè´Ÿè´£ï¼š\nè®¾ç½®å…¨å±€å˜é‡ã€‚\nåˆå§‹åŒ–æ ‡å‡†åº“ã€‚\nå°†Â argvÂ å’ŒÂ argcÂ ä»å †æ ˆä¸­å–å‡ºï¼Œå‡†å¤‡å¥½å‚æ•°ã€‚\nè°ƒç”¨ç”¨æˆ·ç¼–å†™çš„Â main(int argc, char *argv[])Â å‡½æ•°ã€‚\nè‡³æ­¤ï¼Œä½ çš„Â mainÂ å‡½æ•°ç»ˆäºè¢«è°ƒç”¨ï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œä½ å†™çš„ä»£ç ã€‚\næ€»ç»“ æ­¥éª¤ å…³é”®åŠ¨ä½œ æ‰§è¡Œè€… 1. Shellè§£æ è§£æå‘½ä»¤ï¼Œè·å–å‚æ•° Shell (ç”¨æˆ·æ€) 2.Â fork() åˆ›å»ºå­è¿›ç¨‹å‰¯æœ¬ å†…æ ¸ 3.Â execve() ç³»ç»Ÿè°ƒç”¨ï¼Œé™·å…¥å†…æ ¸ å­è¿›ç¨‹ -\u0026gt; å†…æ ¸ 4. å†…æ ¸å¤„ç† éªŒè¯æ–‡ä»¶ã€é‡Šæ”¾æ—§ç©ºé—´ã€æ˜ å°„æ–°ç¨‹åºã€è®¾ç½®å †æ ˆå’Œå¯„å­˜å™¨ å†…æ ¸ 5. åŠ¨æ€é“¾æ¥ åŠ è½½å¹¶é“¾æ¥å…±äº«åº“ åŠ¨æ€é“¾æ¥å™¨Â ld.soÂ (ç”¨æˆ·æ€) 6. ç¨‹åºå¯åŠ¨ è¿è¡ŒÂ _startï¼Œè°ƒç”¨Â main() ç”¨æˆ·ç¨‹åº æ‰€ä»¥ï¼ŒmainÂ å‡½æ•°çš„åŠ è½½å’Œæ‰§è¡Œæ˜¯å†…æ ¸ä¸åŠ¨æ€é“¾æ¥å™¨ï¼ˆå¦‚æœéœ€è¦ï¼‰ååŒå·¥ä½œçš„ç»“æœï¼Œæ˜¯ä¸€ä¸ªâ€œå…ˆç ´åç«‹â€çš„è¿‡ç¨‹ï¼šå…ˆé€šè¿‡Â execve()Â æ¸…ç©ºå½“å‰è¿›ç¨‹çš„ç¯å¢ƒï¼Œå†ä¸ºå…¶æ³¨å…¥ä¸€ä¸ªå…¨æ–°çš„ç¨‹åºç”Ÿå‘½ã€‚\n","date":"2025-09-06T00:00:00Z","permalink":"https://zhangquanhua1.github.io/p/%E5%8A%A0%E8%BD%BD%E4%B8%80%E4%B8%AA%E6%96%B0%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%BF%87%E7%A8%8B/","title":"åŠ è½½ä¸€ä¸ªæ–°ç¨‹åºçš„è¿‡ç¨‹"},{"content":"ä¸€ã€è‚¡ç¥¨ç±»å‹ç›¸å…³åè¯ â€¢ Aè‚¡ï¼šäººæ°‘å¸æ™®é€šè‚¡ç¥¨ï¼Œå¢ƒå†…å…¬å¸å‘è¡Œï¼Œå¢ƒå†…æŠ•èµ„è€…ä»¥äººæ°‘å¸äº¤æ˜“ã€‚å®è¡Œâ€œT+1â€äº¤æ˜“å’Œæ¶¨è·Œå¹…é™åˆ¶ã€‚\nâ€¢ Bè‚¡ï¼šäººæ°‘å¸é¢å€¼ã€å¤–å¸äº¤æ˜“ï¼Œåœ¨ä¸Šäº¤æ‰€æˆ–æ·±äº¤æ‰€ä¸Šå¸‚çš„å¤–èµ„è‚¡ã€‚äº¤æ”¶å‘¨æœŸè¾ƒé•¿ï¼ˆå†å²ä¸Šå¤šä¸ºT+3ï¼‰ï¼Œæœ‰æ¶¨è·Œå¹…é™åˆ¶ã€‚\nâ€¢ Hè‚¡ï¼šå†…åœ°æ³¨å†Œå…¬å¸åœ¨é¦™æ¸¯è”åˆäº¤æ˜“æ‰€ä¸Šå¸‚çš„è‚¡ç¥¨ï¼ˆå¸¸ç§°å›½ä¼è‚¡ï¼‰ã€‚â€œT+0â€äº¤æ˜“ï¼Œæ— æ¶¨è·Œå¹…é™åˆ¶ã€‚\nâ€¢ Nè‚¡ï¼šåœ¨ä¸­å›½å¤§é™†æ³¨å†Œã€äºçº½çº¦äº¤æ˜“æ‰€æˆ–çº³æ–¯è¾¾å…‹ä¸Šå¸‚çš„å¤–èµ„è‚¡ã€‚â€œT+0â€äº¤æ˜“ï¼Œæ— æ¶¨è·Œå¹…é™åˆ¶ã€‚\nâ€¢ Sè‚¡ï¼šä¸»è¦ä¸šåŠ¡åœ¨ä¸­å›½å¤§é™†ã€åœ¨æ–°åŠ å¡äº¤æ˜“æ‰€ä¸Šå¸‚çš„ä¸­èµ„èƒŒæ™¯å…¬å¸è‚¡ç¥¨ã€‚â€œT+0â€äº¤æ˜“ï¼Œäº¤æ˜“æ‰€è®¾æœ‰æ¶¨è·Œå¹…é™åˆ¶ã€‚\nâ€¢ æ™®é€šè‚¡ï¼šäº«æœ‰è¡¨å†³æƒã€åˆ†çº¢æƒã€å‰©ä½™è´¢äº§åˆ†é…æƒï¼Œè‚¡æ¯ä¸å›ºå®šã€‚\nâ€¢ ä¼˜å…ˆè‚¡ï¼šåˆ†çº¢ä¼˜å…ˆã€æ¸…ç®—ä¼˜å…ˆï¼Œé€šå¸¸æ— æˆ–æœ‰é™è¡¨å†³æƒï¼Œè‚¡æ¯ç‡ç›¸å¯¹å›ºå®šã€‚\nâ€¢ åŸå§‹è‚¡ï¼šå…¬å¸ä¸Šå¸‚å‰å‘è¡Œç»™æ ¸å¿ƒç®¡ç†å±‚ã€å‘˜å·¥æˆ–æœºæ„çš„è‚¡ä»½ã€‚\nâ€¢ è“ç­¹è‚¡ï¼šä¸šç»©ç¨³å¥ã€è§„æ¨¡è¾ƒå¤§ã€åˆ†çº¢ç¨³å®šçš„é¾™å¤´å‹å…¬å¸è‚¡ç¥¨ã€‚\nâ€¢ çº¢ç­¹è‚¡ï¼šå¢ƒå¤–æ³¨å†Œã€åœ¨æ¸¯ä¸Šå¸‚ï¼Œç”±ä¸­èµ„æœºæ„å®é™…æ§åˆ¶çš„å…¬å¸è‚¡ç¥¨ã€‚\nâ€¢ ç™½é©¬è‚¡ï¼šé•¿æœŸä¸šç»©ä¼˜è‰¯ã€æˆé•¿æ€§è¾ƒæ˜ç¡®ã€é£é™©ç›¸å¯¹è¾ƒä½çš„è‚¡ç¥¨ã€‚\nâ€¢ é¾™å¤´è‚¡ï¼šè¡Œä¸šå†…å…·æœ‰æ˜¾è‘—å¸¦åŠ¨æ•ˆåº”ã€å¯¹æ¿å—èµ°åŠ¿æœ‰ç¤ºèŒƒä½œç”¨çš„è‚¡ç¥¨ã€‚\nâ€¢ ç»©ä¼˜è‚¡ï¼šå†å²ä¸šç»©ä¼˜ç§€ã€æœªæ¥é¢„æœŸç¨³å¥ä½†é«˜æˆé•¿æ€§æœ‰é™çš„è‚¡ç¥¨ã€‚\nâ€¢ åƒåœ¾è‚¡ï¼šåŸºæœ¬é¢å·®ã€é£é™©è¾ƒé«˜çš„å…¬å¸è‚¡ç¥¨ã€‚\nâ€¢ æˆé•¿è‚¡ï¼šå¤„äºé«˜æˆé•¿é˜¶æ®µã€åˆ©æ¶¦å¢é€Ÿè¾ƒé«˜çš„å…¬å¸è‚¡ç¥¨ã€‚\nâ€¢ å†·é—¨è‚¡ï¼šæˆäº¤é‡å°ã€æµåŠ¨æ€§å¼±ã€ä»·æ ¼æ³¢åŠ¨è¾ƒå°çš„è‚¡ç¥¨ã€‚\nâ€¢ æ¦‚å¿µè‚¡ï¼šå—æŸä¸€æ”¿ç­–æˆ–çƒ­ç‚¹æ¦‚å¿µé©±åŠ¨è€Œè¢«å¸‚åœºå…³æ³¨çš„è‚¡ç¥¨ã€‚\nâ€¢ è¡Œä¸šè‚¡ï¼šæŒ‰ç…§ä¸»è¥ä¸šåŠ¡åˆ’åˆ†åœ¨åŒä¸€è¡Œä¸šæ¿å—å†…çš„è‚¡ç¥¨ã€‚\näºŒã€æŠ•èµ„å¸‚åœºç›¸å…³åè¯ â€¢ ä¸€çº§å¸‚åœºï¼šè¯åˆ¸å‘è¡Œå¸‚åœºï¼Œè¿›è¡Œæ–°è‚¡å‘è¡Œä¸è®¤è´­ï¼Œä¸å…è®¸è‡ªç”±äº¤æ˜“ã€‚\nâ€¢ äºŒçº§å¸‚åœºï¼šå·²å‘è¡Œè¯åˆ¸çš„æµé€šè½¬è®©å¸‚åœºï¼ŒåŒ…æ‹¬ä¸Šäº¤æ‰€ã€æ·±äº¤æ‰€ã€åŒ—äº¤æ‰€ç­‰é›†ä¸­äº¤æ˜“å¸‚åœºä¸åœºå¤–å¸‚åœºã€‚\nâ€¢ ç¬¬ä¸‰å¸‚åœºï¼šç”±éäº¤æ˜“æ‰€ä¼šå‘˜åœ¨åœºå¤–äº¤æ˜“æ‰€ä¸Šå¸‚è¯åˆ¸çš„å¸‚åœºï¼ˆå¦‚é“¶è¡Œä¿¡æ‰˜éƒ¨ç­‰å‚ä¸ï¼‰ã€‚\nâ€¢ ç¬¬å››å¸‚åœºï¼šæœºæ„æˆ–å¤§æˆ·ç»•å¼€äº¤æ˜“æ‰€ä¸ç»çºªå•†ï¼Œç›´æ¥é€šè¿‡ç½‘ç»œæ’®åˆäº¤æ˜“çš„å¸‚åœºã€‚\nâ€¢ åŒ—å‘èµ„é‡‘ï¼šé€šè¿‡æ²ª/æ·±è‚¡é€šæµå…¥Aè‚¡çš„æ¸¯èµ„ä¸å¤–èµ„ã€‚\nâ€¢ å—ä¸‹èµ„é‡‘ï¼šå†…åœ°èµ„é‡‘é€šè¿‡æ¸¯è‚¡é€šæµå…¥é¦™æ¸¯å¸‚åœºçš„èµ„é‡‘ã€‚\nâ€¢ ç†Šå¸‚ï¼ˆç©ºå¤´ï¼‰ï¼šä»·æ ¼é•¿æœŸä¸‹è¡Œã€é¢„æœŸåæ‚²è§‚çš„å¸‚åœºç¯å¢ƒã€‚\nâ€¢ ç‰›å¸‚ï¼ˆå¤šå¤´ï¼‰ï¼šä»·æ ¼é•¿æœŸä¸Šè¡Œã€é¢„æœŸåä¹è§‚çš„å¸‚åœºç¯å¢ƒã€‚\nâ€¢ ç‰›çš®å¸‚ï¼šä»·æ ¼é•¿æ—¶é—´çª„å¹…æ³¢åŠ¨ï¼Œç¼ºä¹è¶‹åŠ¿ã€‚\nâ€¢ åˆ©å¤š/åˆ©ç©ºï¼šåˆ†åˆ«æŒ‡æœ‰åˆ©äºä¸Šæ¶¨/ä¸‹è·Œçš„å› ç´ æˆ–æ¶ˆæ¯ã€‚\nä¸‰ã€è‚¡ç¥¨åˆ†æç›¸å…³åè¯ä¸æŒ‡æ ‡ â€¢ åŸºæœ¬é¢ï¼šå®è§‚ç¯å¢ƒä¸å…¬å¸ç»è¥ã€è´¢åŠ¡ã€æ²»ç†ã€ç«äº‰åŠ›ç­‰åŸºæœ¬æƒ…å†µã€‚\nâ€¢ æŠ€æœ¯é¢ï¼šä»·æ ¼ä¸é‡èƒ½è¡ç”Ÿçš„å½¢æ€ã€è¶‹åŠ¿ä¸æŠ€æœ¯æŒ‡æ ‡ã€‚\nâ€¢ å¤©åœ°æ¿ï¼šç›˜ä¸­å…ˆæ¶¨åœåè·Œåœã€‚\nâ€¢ åœ°å¤©æ¿ï¼šç›˜ä¸­å…ˆè·Œåœåæ¶¨åœã€‚\nâ€¢ æ¶¨åœ/è·Œåœï¼šå½“æ—¥ä»·æ ¼æ³¢åŠ¨çš„æœ€é«˜/æœ€ä½é™åˆ¶ä»·ã€‚\nâ€¢ æ¢æ‰‹ç‡ï¼šä¸€å®šæœŸé—´æˆäº¤é‡å æµé€šè‚¡æœ¬æ¯”ä¾‹ã€‚å…¬å¼ï¼šæ¢æ‰‹ç‡ï¼æˆäº¤é‡ï¼æµé€šè‚¡æœ¬Ã—100%ã€‚\nâ€¢ ç­¹ç é›†ä¸­åº¦ï¼šæµé€šç­¹ç åœ¨éƒ¨åˆ†è´¦æˆ·æˆ–ä»·ä½åŒºé—´çš„é›†ä¸­ç¨‹åº¦ã€‚\nâ€¢ å¸‚ç›ˆç‡ï¼ˆPEï¼‰ï¼šè‚¡ä»·/æ¯è‚¡å‡€åˆ©æ¶¦ï¼›è¾ƒä½é€šå¸¸æ„å‘³ç€ä¼°å€¼è¾ƒä½ï¼ˆéœ€ç»“åˆè¡Œä¸šï¼‰ã€‚\nâ€¢ å¸‚å‡€ç‡ï¼ˆPBï¼‰ï¼šè‚¡ä»·/æ¯è‚¡å‡€èµ„äº§ï¼›å¸¸ç”¨äºé‡‘èã€å‘¨æœŸå“ç­‰ä¼°å€¼å‚è€ƒã€‚\nâ€¢ å¸‚é”€ç‡ï¼ˆPSï¼‰ï¼šè‚¡ä»·/æ¯è‚¡é”€å”®æ”¶å…¥ï¼›é€‚ç”¨äºæ—©æœŸã€é«˜æˆé•¿æˆ–äºæŸå…¬å¸æ¯”è¾ƒã€‚\nâ€¢ è‚¡æ¯ç‡ï¼šæ¯è‚¡è‚¡æ¯/è‚¡ä»·ï¼›è¡¡é‡åˆ†çº¢å›æŠ¥ã€‚\nâ€¢ æ¯è‚¡æ”¶ç›Šï¼ˆEPSï¼‰ï¼šå‡€åˆ©æ¶¦/æ€»è‚¡æœ¬ã€‚\nâ€¢ ä¼°å€¼æ‰©å±•æŒ‡æ ‡ï¼šPEGï¼ˆPE/åˆ©æ¶¦å¢é€Ÿï¼‰ã€EV/EBITDA ç­‰ã€‚\nâ€¢ Kçº¿ï¼šç”±å¼€ç›˜ã€æ”¶ç›˜ã€æœ€é«˜ã€æœ€ä½æ„æˆï¼Œåæ˜ åŒºé—´ä»·æ ¼æ³¢åŠ¨ã€‚\nâ€¢ å‡çº¿ï¼ˆMAï¼‰ï¼šä¸€å®šæœŸé—´æ”¶ç›˜ä»·çš„ç§»åŠ¨å¹³å‡ï¼Œå¦‚5/10/20/60/120/250æ—¥ã€‚\nâ€¢ MACDï¼šç”±DIFã€DEAã€æŸ±çŠ¶å›¾ä¸é›¶è½´æ„æˆï¼Œåæ˜ è¶‹åŠ¿å¼ºå¼±ä¸æ‹ç‚¹ã€‚\nâ€¢ KDJï¼šåæ˜ è¶…ä¹°è¶…å–ä¸çŸ­æœŸæ‹ç‚¹ã€‚\nâ€¢ OBVï¼šå°†æˆäº¤é‡æ–¹å‘ä¸ä»·æ ¼å˜åŠ¨ç»“åˆï¼Œè§‚å¯Ÿé‡ä»·é…åˆã€‚\nâ€¢ BIASï¼šä»·æ ¼ç›¸å¯¹å‡çº¿çš„åç¦»ç¨‹åº¦ã€‚\nâ€¢ RSIï¼šä¸€å®šæœŸé—´ä¸Šæ¶¨å¹…åº¦å æ€»æ³¢åŠ¨å¹…åº¦çš„æ¯”ä¾‹ã€‚\nâ€¢ BRARï¼šBRé‡æ”¶ç›˜ä»·ï¼ŒARé‡å¼€ç›˜ä»·ï¼Œåæ˜ å¸‚åœºäººæ°”ä¸æ„æ„¿ã€‚\nâ€¢ BOLLï¼ˆå¸ƒæ—å¸¦ï¼‰ï¼šä»¥ä¸Šè½¨/ä¸­è½¨/ä¸‹è½¨åˆ»ç”»æ³¢åŠ¨åŒºé—´ï¼ˆå¸¸ä»¥20æ—¥å‡çº¿ä¸æ ‡å‡†å·®è®¡ç®—ï¼‰ã€‚\nâ€¢ å†…ç›˜/å¤–ç›˜ï¼šåˆ†åˆ«ä¸ºä»¥ä¹°ä¸€ä»·æˆäº¤çš„è¢«åŠ¨å–å‡ºé‡/ä»¥å–ä¸€ä»·æˆäº¤çš„ä¸»åŠ¨ä¹°å…¥é‡ã€‚\nâ€¢ ç¼©é‡/æ”¾é‡ï¼šä¸å‰æœŸç›¸æ¯”ï¼Œæˆäº¤é‡å‡å°‘ä¸ºâ€œç¼©é‡â€ï¼Œå¢åŠ ä¸ºâ€œæ”¾é‡â€ã€‚\nå››ã€äº¤æ˜“åŸºç¡€ä¸ç«ä»·æœºåˆ¶ â€¢ äº¤æ˜“æ—¶é—´ï¼ˆAè‚¡ï¼‰ï¼š\n9:15â€“9:25 å¼€ç›˜é›†åˆç«ä»·ï¼ˆ9:20â€“9:25ä¸å¯æ’¤å•ï¼‰ 9:30â€“11:30ã€13:00â€“15:00 è¿ç»­ç«ä»· 14:57â€“15:00 æ”¶ç›˜é›†åˆç«ä»·ï¼ˆä¸»æ¿/ç§‘åˆ›/åˆ›ä¸šæ¿ï¼‰ â€¢ ç«ä»·è§„åˆ™ï¼š\né›†åˆç«ä»·ï¼šä»¥æœ€å¤§æˆäº¤é‡åŸåˆ™ç¡®å®šå¼€/æ”¶ç›˜ä»·ï¼›æœªæˆäº¤éƒ¨åˆ†è½¬å…¥è¿ç»­ç«ä»·ã€‚ è¿ç»­ç«ä»·ï¼šä»·æ ¼ä¼˜å…ˆã€æ—¶é—´ä¼˜å…ˆæ’®åˆæˆäº¤ã€‚ â€¢ æ¶¨è·Œå¹…é™åˆ¶ï¼ˆä»¥äº¤æ˜“æ‰€æœ€æ–°è§„å®šä¸ºå‡†ï¼‰ï¼š\nä¸»æ¿ï¼šä¸€èˆ¬ä¸ºÂ±10%ï¼›STç±»è‚¡ç¥¨ä¸€èˆ¬ä¸ºÂ±5%ã€‚ åˆ›ä¸šæ¿/ç§‘åˆ›æ¿ï¼šä¸€èˆ¬ä¸ºÂ±20%ã€‚ æ–°è‚¡ä¸Šå¸‚å‰5ä¸ªäº¤æ˜“æ—¥é€šå¸¸ä¸è®¾æ¶¨è·Œå¹…é™åˆ¶ï¼ˆè®¾æœ‰ç›˜ä¸­ä¸´åœæœºåˆ¶ï¼‰ã€‚ â€¢ T+1/T+0ï¼š\nAè‚¡è‚¡ç¥¨ä¸€èˆ¬â€œT+1â€å–å‡ºï¼›èµ„é‡‘ä¸äº¤æ”¶â€œT+1/ T+2â€ç»“ç®—ã€‚ æ¸¯è‚¡ã€ç¾è‚¡å¤šä¸ºâ€œT+0â€å›è½¬äº¤æ˜“ã€‚ â€¢ ä¸´æ—¶åœç‰Œï¼ˆç›˜ä¸­ï¼‰ï¼š\nå› å¼‚å¸¸æ³¢åŠ¨ã€é‡å¤§äº‹é¡¹ã€æˆ–æ–°è‚¡ä¸Šå¸‚ç›˜ä¸­ä»·æ ¼ç¨³å®šæœºåˆ¶è§¦å‘è€Œä¸´åœã€‚ â€¢ ç›˜åäº¤æ˜“ï¼š\n15:00â€“15:30 ç›˜åå›ºå®šä»·æ ¼äº¤æ˜“ï¼ˆéƒ¨åˆ†æ¿å—é€‚ç”¨ï¼‰ã€‚ åã€å§”æ‰˜ä¸è®¢å•ç±»å‹ â€¢ é™ä»·å§”æ‰˜ï¼šæŒ‡å®šä»·æ ¼æˆ–æ›´ä¼˜ä»·æ ¼æˆäº¤ï¼Œæœªæˆäº¤éƒ¨åˆ†æŒ‚å•ç­‰å¾…ã€‚\nâ€¢ å¸‚ä»·å§”æ‰˜ï¼ˆAè‚¡å¸¸è§å˜ç§ï¼‰ï¼š\næœ€ä¼˜äº”æ¡£å³æ—¶æˆäº¤å‰©ä½™æ’¤é”€ï¼ˆFOKå±€éƒ¨å˜ä½“ï¼‰ï¼šä¸å¯¹æ‰‹æ–¹å‰äº”æ¡£å³æ—¶æˆäº¤ï¼Œå‰©ä½™æ’¤å•ã€‚ æœ€ä¼˜äº”æ¡£å³æ—¶æˆäº¤å‰©ä½™è½¬é™ä»·ï¼ˆIOCè½¬é™ä»·ï¼‰ï¼šå³æ—¶æˆäº¤åï¼Œå‰©ä½™éƒ¨åˆ†ä»¥æˆäº¤å‡ä»·æˆ–å¯¹æ‰‹ä»·æŒ‚ä¸ºé™ä»·å•ã€‚ æœ¬æ–¹æœ€ä¼˜ä»·æ ¼ï¼šä»¥æœ¬æ–¹é˜Ÿåˆ—æœ€ä¼˜ä»·ç”³æŠ¥ï¼Œæé«˜æˆäº¤æ¦‚ç‡ã€‚ å¯¹æ‰‹æ–¹æœ€ä¼˜ä»·æ ¼ï¼šä»¥å¯¹æ‰‹æ–¹é˜Ÿåˆ—æœ€ä¼˜ä»·ç”³æŠ¥ï¼Œè¿½æ±‚å³æ—¶æˆäº¤ã€‚ æ³¨ï¼šå…·ä½“å¯ç”¨çš„å¸‚ä»·ç±»å‹ä»¥äº¤æ˜“æ‰€ä¸åˆ¸å•†æ”¯æŒä¸ºå‡†ã€‚ â€¢ æœ‰æ•ˆæœŸï¼šAè‚¡åœºå†…å§”æ‰˜ä¸ºå½“æ—¥æœ‰æ•ˆï¼Œæ”¶ç›˜æœªæˆäº¤è‡ªåŠ¨å¤±æ•ˆï¼›ä¸æ”¯æŒGTCï¼ˆé•¿æœŸæœ‰æ•ˆï¼‰ã€‚\nåä¸€ã€ç”³æŠ¥å•ä½ä¸ä»·æ ¼æœ€å°å˜åŠ¨ â€¢ ä»·æ ¼æœ€å°å˜åŠ¨ä»·ä½ï¼ˆTickï¼‰ï¼šå¤šæ•°è‚¡ç¥¨ä¸º0.01å…ƒï¼›åŒ—äº¤æ‰€ã€å¯è½¬å€ºç­‰ä»¥äº¤æ˜“æ‰€è§„åˆ™ä¸ºå‡†ã€‚\nâ€¢ ç”³æŠ¥æ•°é‡å•ä½ï¼š\nè‚¡ç¥¨ï¼šä¸€èˆ¬ä»¥â€œæ‰‹â€ä¸ºå•ä½ï¼Œ1æ‰‹=100è‚¡ã€‚ å¯è½¬å€ºï¼š1æ‰‹=10å¼ ï¼ˆé¢å€¼é€šå¸¸100å…ƒ/å¼ ï¼‰ã€‚ ETFï¼šå¤šä¸º1æ‰‹=100ä»½ï¼Œéƒ¨åˆ†è´§å¸ETFå¯èƒ½ä¸åŒã€‚ â€¢ é›¶è‚¡äº¤æ˜“ï¼š\nå–å‡ºå¯å‡ºç°â€œéæ•´æ‰‹â€ï¼ˆå¦‚å‰©ä½™ä¸è¶³100è‚¡ï¼‰ï¼Œå…è®¸ä¸€æ¬¡æ€§å–å‡ºï¼›ä¹°å…¥é€šå¸¸éœ€æ•´æ‰‹ã€‚ ç›˜åå›ºå®šä»·æ ¼äº¤æ˜“ä¸åŒ—äº¤æ‰€ç­‰å¯¹é›¶è‚¡è§„åˆ™å¯èƒ½ä¸åŒï¼Œä»¥æœ€æ–°è§„å®šä¸ºå‡†ã€‚ åäºŒã€æ’¤å•ã€è®¢å•çŠ¶æ€ä¸æ’®åˆä¼˜å…ˆçº§ â€¢ æ’¤å•è§„åˆ™ï¼š\nå¼€ç›˜é›†åˆç«ä»·ï¼š9:15â€“9:20å¯æ’¤ï¼Œ9:20â€“9:25ä¸å¯æ’¤ã€‚ è¿ç»­ç«ä»·ï¼šå§”æ‰˜æœªæˆäº¤å¯éšæ—¶æ’¤å•ï¼ˆä¸å«ä¸´åœç­‰ç‰¹æ®Šæ—¶æ®µï¼‰ã€‚ æ”¶ç›˜é›†åˆç«ä»·ï¼š14:57â€“15:00ä¸€èˆ¬ä¸å¯æ’¤å•ã€‚ â€¢ å¸¸è§è®¢å•çŠ¶æ€ï¼šå·²æŠ¥ã€éƒ¨æˆã€å…¨æˆã€å·²æ’¤ã€åºŸå•ï¼ˆä»·æ ¼/æ•°é‡æ— æ•ˆã€è´¦æˆ·é™åˆ¶ç­‰ï¼‰ã€‚\nâ€¢ æ’®åˆä¼˜å…ˆçº§ï¼šä»·æ ¼ä¼˜å…ˆã€æ—¶é—´ä¼˜å…ˆï¼›åŒä»·ä½æŒ‰æ’é˜Ÿæ—¶é—´å…ˆåæˆäº¤ã€‚\nåä¸‰ã€èµ„é‡‘å¯ç”¨ä¸ç»“ç®—æ—¶é—´çº¿ â€¢ å–å‡ºå›æ¬¾ï¼š\nå½“æ—¥å–å‡ºåï¼Œèµ„é‡‘é€šå¸¸â€œå¯ç”¨ä¸å¯å–â€ï¼›æ¬¡æ—¥ç»“ç®—åå¯å–ï¼ˆä»¥åˆ¸å•†èµ„é‡‘è§„åˆ™ä¸ºå‡†ï¼‰ã€‚ â€¢ ä¹°å…¥ä¸å–å‡ºï¼š\nä¹°å…¥åå½“æ—¥ä¸å¾—å–å‡ºï¼ˆT+1ï¼‰ï¼›å¯è½¬å€ºã€éƒ¨åˆ†åŸºé‡‘ç­‰å“ç§å¯èƒ½ä¸ºT+0ï¼Œä»¥è§„åˆ™ä¸ºå‡†ã€‚ â€¢ åˆ†çº¢æ´¾æ¯ä¸é…è‚¡ç¼´æ¬¾ï¼šèµ„é‡‘åŠè‚¡ä»½åˆ°ä½æ—¶é—´ä»¥å…¬å‘Šä¸ç»“ç®—æœºæ„å®‰æ’ä¸ºå‡†ã€‚\nåå››ã€èèµ„èåˆ¸åŸºç¡€ â€¢ å®šä¹‰ï¼š\nèèµ„ï¼šå‘åˆ¸å•†å€Ÿé’±ä¹°å…¥æ ‡çš„è¯åˆ¸ï¼Œè´Ÿå€ºè®¡æ¯ã€‚ èåˆ¸ï¼šå€Ÿå…¥æ ‡çš„è¯åˆ¸å–å‡ºï¼ˆåšç©ºï¼‰ï¼Œåˆ°æœŸéœ€ä¹°åˆ¸å½’è¿˜å¹¶æ”¯ä»˜è´¹ç”¨ã€‚ â€¢ æ ‡çš„ä¸é—¨æ§›ï¼šéœ€å¼€é€šä¿¡ç”¨è´¦æˆ·ã€é£é™©è¯„ä¼°è¾¾æ ‡ï¼Œæ ‡çš„è¯åˆ¸ç”±äº¤æ˜“æ‰€å®šæœŸè°ƒæ•´ã€‚\nâ€¢ é£é™©è¦ç‚¹ï¼š\nä¿è¯é‡‘æ¯”ä¾‹ä¸ç»´æŒæ‹…ä¿æ¯”ä¾‹ï¼Œä½äºç»´ä¿çº¿å¯èƒ½è¢«å¹³ä»“ã€‚ åˆ©æ¯ä¸è´¹ç‡æˆæœ¬ã€ä»·æ ¼æ³¢åŠ¨ä¸æµåŠ¨æ€§é£é™©ã€‚ åäº”ã€ç›˜åäº¤æ˜“ä¸å¤§å®—äº¤æ˜“è¡¥å…… â€¢ ç›˜åå›ºå®šä»·æ ¼äº¤æ˜“ï¼š\n15:00â€“15:30 ä»¥å½“æ—¥æ”¶ç›˜ä»·æ’®åˆï¼›ä»…é™é™ä»·å§”æ‰˜ï¼Œéƒ¨åˆ†æ¿å—æˆ–è¯åˆ¸æ”¯æŒã€‚ â€¢ å¤§å®—äº¤æ˜“ï¼ˆBlock Tradeï¼‰ï¼š\né€‚ç”¨äºå¤§é¢äº¤æ˜“ï¼Œåœºå¤–åè®®è¾¾æˆã€åœºå†…ç”³æŠ¥è¿‡æˆ·ï¼Œä»·æ ¼åŒºé—´ä¸æœ€å°æˆäº¤æ•°é‡æœ‰è§„å®šã€‚ å¯¹äºŒçº§å¸‚åœºå³æ—¶ä»·æ ¼å½±å“è¾ƒå°ï¼Œä½†å¯èƒ½ä¼ é€’ä¾›éœ€ä¸æœºæ„åŠ¨å‘ä¿¡æ¯ã€‚ åå…­ã€IPOç”³è´­ä¸é…å”®åŸºç¡€ â€¢ ç”³è´­æ¡ä»¶ï¼š\néœ€æŒæœ‰ç›¸åº”å¸‚å€¼ï¼ˆä»¥T-2æ—¥è´¦æˆ·æŒæœ‰ä¸ºå‡†ï¼‰ï¼Œä¸åŒæ¿å—å¸‚å€¼é—¨æ§›ä¸åŒã€‚ â€¢ ç”³è´­æµç¨‹ï¼š\nå…¬å‘Šæ—¥æŸ¥çœ‹ä»£ç ä¸ç”³è´­ä¸Šé™ â†’ ç”³è´­æ—¥æŒ‰ä»£ç ä¸æ•°é‡ä¸‹å• â†’ ä¸­ç­¾å…¬å¸ƒåæŒ‰æ—¶ç¼´æ¬¾ã€‚ â€¢ é…å”®ä¸ä¸­ç­¾ï¼š\né‡‡å–æ‘‡å·/é…å·æœºåˆ¶ï¼ŒæŒ‰å¸‚å€¼è·å¾—é…å·ï¼Œä¸­ç­¾æ¦‚ç‡ä¸å¸‚å€¼ã€å‘è¡Œè§„æ¨¡ç­‰ç›¸å…³ã€‚ â€¢ ä¸Šå¸‚é¦–æ—¥ï¼š\nå‰5ä¸ªäº¤æ˜“æ—¥é€šå¸¸ä¸è®¾æ¶¨è·Œå¹…é™åˆ¶ï¼ˆæœ‰ä¸´åœï¼‰ï¼Œæ³¨æ„æµåŠ¨æ€§ä¸æ³¢åŠ¨é£é™©ã€‚ äº”ã€è´¦æˆ·ä¸å¸¸è§æŠ•èµ„å“ç§ â€¢ è´¦æˆ·ç±»å‹ï¼š\næ™®é€šè´¦æˆ·ï¼šäº¤æ˜“æ²ªæ·±ä¸»æ¿ã€åŒ—äº¤æ‰€ç­‰ã€‚ ä¿¡ç”¨è´¦æˆ·ï¼šèèµ„èåˆ¸ï¼ˆéœ€é£é™©è¯„ä¼°ä¸æƒé™å¼€é€šï¼‰ã€‚ ç§‘åˆ›æ¿ä¸åˆ›ä¸šæ¿æƒé™ï¼šæ»¡è¶³æ¡ä»¶åå•ç‹¬å¼€é€šã€‚ æ¸¯è‚¡é€šæƒé™ï¼šæ»¡è¶³èµ„äº§æ¡ä»¶åå¼€é€šã€‚ â€¢ å¸¸è§å“ç§ï¼š\nETF/LOFï¼šåœºå†…åŸºé‡‘ï¼ˆETFï¼‰ä¸å¯åœºå†…å¤–ç”³èµ/äº¤æ˜“çš„åŸºé‡‘ï¼ˆLOFï¼‰ã€‚ å°é—­å¼åŸºé‡‘ã€æŒ‡æ•°åŸºé‡‘ã€ä¸»åŠ¨å‹åŸºé‡‘ã€‚ å¯è½¬å€ºï¼šå€ºåˆ¸ä¸æœŸæƒæ€§å…¼å…·ï¼Œå¯æŒ‰çº¦å®šæ¡ä»¶è½¬æ¢ä¸ºè‚¡ç¥¨ã€‚ æ–°è‚¡ç”³è´­ï¼šæ»¡è¶³æ¡ä»¶å¯æŒ‰å¸‚å€¼ç”³è´­ï¼Œé…å”®ä¸­ç­¾åç¼´æ¬¾ã€‚ ä¼˜å…ˆè‚¡ã€å­˜æ‰˜å‡­è¯ï¼ˆCDRï¼‰ã€å…¬å‹ŸREITsï¼ˆä¸åŠ¨äº§æŠ•èµ„ä¿¡æ‰˜ï¼‰ã€‚ å…­ã€å…¬å¸è¡Œä¸ºä¸é™¤æƒé™¤æ¯ â€¢ å¸¸è§å…¬å¸è¡Œä¸ºï¼šåˆ†çº¢ã€é€è‚¡ã€è½¬å¢ã€é…è‚¡ã€å¹¶è´­é‡ç»„ã€è‚¡ä»½å›è´­ç­‰ã€‚\nâ€¢ é™¤æƒ/é™¤æ¯ï¼š\né™¤æ¯ï¼šæ´¾å‘ç°é‡‘è‚¡åˆ©åè‚¡ä»·ç›¸åº”å‘ä¸‹è°ƒæ•´ã€‚ é™¤æƒï¼šé€è‚¡æˆ–è½¬å¢åå› è‚¡æœ¬æ‰©å¤§ï¼Œè‚¡ä»·ç›¸åº”æŒ‰æ¯”ä¾‹ä¸‹è°ƒã€‚ â€¢ ç®€åŒ–è®¡ç®—ï¼š\nç°é‡‘åˆ†çº¢åå‚è€ƒä»· â‰ˆ é™¤æƒå‰æ”¶ç›˜ä»· âˆ’ æ¯è‚¡ç°é‡‘åˆ†çº¢ã€‚ é€/è½¬å¢åå‚è€ƒä»· â‰ˆ é™¤æƒå‰æ”¶ç›˜ä»· Ã·ï¼ˆ1 + é€è½¬æ¯”ä¾‹ï¼‰ã€‚ å®é™…ä»¥äº¤æ˜“æ‰€ä¸ç™»è®°ç»“ç®—æœºæ„æŠ«éœ²ä¸ºå‡†ã€‚ ä¸ƒã€è´¹ç”¨ã€ç¨è´¹ä¸ç»“ç®— â€¢ ä½£é‡‘ï¼šæŒ‰æˆäº¤é‡‘é¢çš„ä¸€å®šæ¯”ä¾‹æ”¶å–ï¼Œåˆ¸å•†é—´å·®å¼‚è¾ƒå¤§ï¼ˆè®¾æœ‰æœ€ä½æ”¶è´¹ï¼‰ã€‚\nâ€¢ è¿‡æˆ·è´¹ï¼šæ²ªå¸‚è‚¡ç¥¨æŒ‰æˆäº¤é‡‘é¢ä¸€å®šæ¯”ä¾‹æ”¶å–ï¼›æ·±å¸‚è‚¡ç¥¨ç›®å‰å¤šä¸æ”¶ï¼ˆä»¥æœ€æ–°è§„åˆ™ä¸ºå‡†ï¼‰ã€‚\nâ€¢ äº¤æ˜“ç»æ‰‹è´¹ä¸ç›‘ç®¡è´¹ï¼šæŒ‰äº¤æ˜“æ‰€/ç›‘ç®¡æœºæ„æ ‡å‡†æ”¶å–ã€‚\nâ€¢ å°èŠ±ç¨ï¼šå–å‡ºè‚¡ç¥¨å•è¾¹å¾æ”¶ï¼Œç¨ç‡ä»¥æœ€æ–°å›½å®¶è§„å®šä¸ºå‡†ã€‚\nâ€¢ ç»“ç®—ï¼šAè‚¡é‡‡ç”¨ä¸­å›½ç»“ç®—çš„é›†ä¸­ç™»è®°ä¸èµ„é‡‘è¯åˆ¸äº¤æ”¶ä½“ç³»ï¼Œé€šå¸¸T+1/T+2å®Œæˆæ¸…ç®—äº¤æ”¶ã€‚\nå…«ã€äº¤æ˜“æœ¯è¯­è¡¥å…… â€¢ ç­¹ç ï¼šæŠ•èµ„è€…æŒæœ‰çš„è‚¡ç¥¨æ•°é‡ã€‚\nâ€¢ å¸ç­¹/å»ºä»“ï¼šèµ„é‡‘åœ¨æŸä»·ä½åŒºé—´æŒç»­ä¹°å…¥ã€å»ºç«‹å¤´å¯¸ã€‚\nâ€¢ æ´—ç›˜ï¼šé€šè¿‡çŸ­æœŸæ‰“å‹æˆ–éœ‡è¡æ¸…æ´—ä¸ç¨³å®šæŒä»“ã€‚\nâ€¢ å‡ºè´§ï¼šåœ¨é«˜ä½æˆ–åˆ©å¥½åˆºæ¿€ä¸‹åˆ†æ‰¹å–å‡ºå®ç°æ”¶ç›Šã€‚\nâ€¢ æŠ¤ç›˜ï¼šä¸ºç¨³å®šä»·æ ¼è¿›è¡Œä¹°å…¥ç»´ç¨³çš„è¡Œä¸ºã€‚\nâ€¢ å´©ç›˜/è·³æ°´ï¼šçŸ­æ—¶é—´å†…ä»·æ ¼å¿«é€Ÿå¤§å¹…ä¸‹è·Œã€‚\nâ€¢ é«˜å¼€/ä½å¼€/å¹³å¼€ï¼šå½“æ—¥å¼€ç›˜ä»·é«˜äº/ä½äº/ç­‰äºæ˜¨æ—¥æ”¶ç›˜ä»·ã€‚\nâ€¢ å¥—ç‰¢ï¼šä¹°å…¥åä»·æ ¼æŒç»­ä¸‹è·Œè€Œæš‚æ—¶äºæŸæ— æ³•å–å‡ºçš„çŠ¶æ€ã€‚\nâ€¢ ç›˜æ•´ï¼šä»·æ ¼åœ¨ä¸€å®šåŒºé—´å†…æ¨ªå‘æ³¢åŠ¨ã€‚\nä¹ã€è‚¡ç¥¨å­—æ¯æ ‡è¯†ä¸ç‰¹åˆ«æ ‡è®° â€¢ Nï¼šæ–°è‚¡ä¸Šå¸‚é¦–æ—¥åŠ â€œNâ€ï¼Œæ¬¡æ—¥å–æ¶ˆã€‚\nâ€¢ Cï¼šä¸Šå¸‚ç¬¬2â€“5æ—¥æ ‡æ³¨â€œCâ€ï¼Œç¬¬6æ—¥å–æ¶ˆã€‚\nâ€¢ Rï¼šå¯èèµ„èåˆ¸ã€‚\nâ€¢ krï¼šç§‘åˆ›æ¿å¯èèµ„èåˆ¸ï¼ˆk=ç§‘åˆ›ï¼Œr=èèµ„èåˆ¸ï¼‰ã€‚\nâ€¢ Uï¼šç§‘åˆ›æ¿å°šæœªç›ˆåˆ©ä¼ä¸šï¼›é¦–æ¬¡å®ç°ç›ˆåˆ©åå–æ¶ˆã€‚\nâ€¢ Wï¼šåŒè‚¡ä¸åŒæƒï¼ˆè¡¨å†³æƒå·®å¼‚å®‰æ’ï¼‰ï¼›ä¸å†é€‚ç”¨æ—¶å–æ¶ˆã€‚\nâ€¢ Vï¼šåè®®æ§åˆ¶æ¶æ„ï¼ˆVIEç­‰ï¼‰æˆ–ç±»ä¼¼ç‰¹æ®Šå®‰æ’ï¼›ä¸å†é€‚ç”¨æ—¶å–æ¶ˆã€‚\nâ€¢ Gï¼šæŒ‡æ•°è´¡çŒ®åº¦è§†å›¾å…¥å£ï¼ˆâ€œè´¡â€ï¼‰ã€‚\nâ€¢ Lï¼šå­˜åœ¨å…³è”å“ç§ï¼ˆBè‚¡ã€å¯è½¬å€ºã€Hè‚¡ã€æƒè¯ç­‰ï¼‰ã€‚\nâ€¢ XRï¼šå·²é™¤æƒï¼Œä¹°å…¥åä¸å†äº«æœ‰é€è‚¡/è½¬å¢ç­‰æƒåˆ©ã€‚\nâ€¢ XDï¼šå·²é™¤æ¯ï¼Œä¹°å…¥åä¸å†äº«æœ‰å½“æœŸæ´¾æ¯æƒåˆ©ã€‚\nâ€¢ DRï¼šé™¤æƒé™¤æ¯ï¼Œä¹°å…¥åä¸å†äº«æœ‰é€è‚¡ä¸æ´¾æ¯æƒåˆ©ã€‚\nâ€¢ STï¼šè¿ç»­ä¸¤ä¸ªä¼šè®¡å¹´åº¦äºæŸç­‰ç‰¹æ®Šæƒ…å½¢çš„ç‰¹åˆ«å¤„ç†ã€‚\nâ€¢ *STï¼šå­˜åœ¨é€€å¸‚é£é™©çš„ç‰¹åˆ«å¤„ç†ä¸è­¦ç¤ºã€‚\nâ€¢ PTï¼šå·²é€€å¸‚æˆ–è¿›å…¥é€€å¸‚æ•´ç†é˜¶æ®µçš„è‚¡ç¥¨ã€‚\nâ€¢ NSTï¼šé‡ç»„æˆ–è‚¡æ”¹åæ¢å¤ä¸Šå¸‚çš„STè‚¡ã€‚\nâ€¢ SZ/SH/BJï¼šåˆ†åˆ«ä»£è¡¨æ·±äº¤æ‰€/ä¸Šäº¤æ‰€/åŒ—äº¤æ‰€ä¸Šå¸‚ã€‚\nâ€”â€”\n","date":"2025-09-04T22:55:17+08:00","permalink":"https://zhangquanhua1.github.io/p/%E9%9B%86%E4%B8%AD%E7%AB%9E%E4%BB%B7%E4%B8%8E%E8%BF%9E%E7%BB%AD%E7%AB%9E%E4%BB%B7/","title":"é›†ä¸­ç«ä»·ä¸è¿ç»­ç«ä»·"},{"content":"æ ¸å¿ƒæ¯”å–» é›†ä¸­ç«ä»·ï¼šåƒ \u0026ldquo;é›†ä½“æŠ•ç¥¨ï¼Œä¸€é”¤å®šéŸ³\u0026rdquo;ã€‚å¤§å®¶å…ˆå„è‡ªå‡ºä»·ï¼Œä½†éƒ½ä¸äº¤æ˜“ï¼Œç­‰åˆ°ä¸€ä¸ªç‰¹å®šæ—¶åˆ»ï¼Œç³»ç»Ÿæ‰¾ä¸€ä¸ªèƒ½è®©æœ€å¤šäº¤æ˜“æˆäº¤çš„ä»·æ ¼ï¼Œç»Ÿä¸€æŒ‰è¿™ä¸ªä»·æ ¼æˆäº¤ã€‚\nè¿ç»­ç«ä»·ï¼šåƒ \u0026ldquo;è‡ªç”±å¸‚åœºï¼Œéšåˆ°éšè°ˆ\u0026rdquo;ã€‚ä¹°å–åŒæ–¹ä½ æŒ‚ä¸€ä¸ªä¹°å•ï¼Œæˆ‘æŒ‚ä¸€ä¸ªå–å•ï¼Œä»·æ ¼åˆé€‚å°±ç«‹åˆ»æˆäº¤ï¼Œäº¤æ˜“æ˜¯è¿ç»­ä¸æ–­è¿›è¡Œçš„ã€‚\nä¸€ã€é›†ä¸­ç«ä»· é›†ä¸­ç«ä»·å‘ç”Ÿåœ¨ä¸¤ä¸ªç‰¹å®šçš„æ—¶é—´æ®µï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†äº§ç”Ÿä¸€ä¸ªå…¬å¹³çš„ã€èƒ½åæ˜ å¸‚åœºé›†ä¸­æ„æ„¿çš„å¼€ç›˜ä»·æˆ–æ”¶ç›˜ä»·ã€‚\n1. å‘ç”Ÿæ—¶é—´ï¼š\nå¼€ç›˜é›†åˆç«ä»·ï¼šæ¯ä¸ªäº¤æ˜“æ—¥çš„ 9:15 - 9:25\næ”¶ç›˜é›†åˆç«ä»·ï¼šæ¯ä¸ªäº¤æ˜“æ—¥çš„ 14:57 - 15:00 ï¼ˆæ³¨æ„ï¼šç›®å‰ä»…æ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€ã€åˆ›ä¸šæ¿ã€ç§‘åˆ›æ¿é‡‡ç”¨ï¼Œä¸Šæµ·è¯åˆ¸äº¤æ˜“æ‰€çš„æ”¶ç›˜ä»·æ˜¯æœ€åä¸€ç¬”è¿ç»­ç«ä»·çš„æˆäº¤ä»·ï¼‰\n2. æ ¸å¿ƒè§„åˆ™ä¸è¿‡ç¨‹ï¼š\næ”¶é›†ç”³æŠ¥ï¼šåœ¨ä»¥ä¸Šæ—¶é—´æ®µå†…ï¼ŒæŠ•èµ„è€…å¯ä»¥æäº¤æˆ–æ’¤é”€ä¹°å–å§”æ‰˜ï¼ˆä½†9:20-9:25ä¹‹é—´åªèƒ½æäº¤ï¼Œä¸èƒ½æ’¤é”€ï¼‰ã€‚\nä¸ç«‹å³æˆäº¤ï¼šåœ¨æ­¤æœŸé—´ï¼Œæ‰€æœ‰çš„æŠ¥å•åªä¼šè¢«ç³»ç»Ÿæ”¶é›†ï¼Œå¹¶ä¸ä¼šçœŸæ­£æˆäº¤ã€‚\né›†ä¸­æ’®åˆï¼šåœ¨æ—¶é—´ç‚¹ç»“æŸæ—¶ï¼ˆ9:25æˆ–15:00ï¼‰ï¼Œäº¤æ˜“ç³»ç»Ÿçš„ç”µè„‘ä¸»æœºå°†æ‰€æœ‰æœ‰æ•ˆçš„ä¹°å–ç”³æŠ¥ä¸€æ¬¡æ€§é›†ä¸­æ’®åˆã€‚\næˆäº¤ä»·ç¡®å®šåŸåˆ™ï¼šè¿™ä¸ª\u0026quot;å”¯ä¸€ä»·æ ¼\u0026quot;å¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰ï¼š\næœ€å¤§æˆäº¤é‡åŸåˆ™ï¼šåœ¨è¿™ä¸ªä»·æ ¼ä¸‹ï¼Œæ‰€èƒ½æˆäº¤çš„è‚¡ç¥¨æ•°é‡æœ€å¤šã€‚\né«˜äºè¯¥ä»·æ ¼çš„æ‰€æœ‰ä¹°ç›˜å’Œä½äºè¯¥ä»·æ ¼çš„æ‰€æœ‰å–ç›˜éƒ½èƒ½å…¨éƒ¨æˆäº¤ã€‚\nä¸è¯¥ä»·æ ¼ç›¸åŒçš„ä¹°å–åŒæ–¹ä¸­æœ‰ä¸€æ–¹ç”³æŠ¥å…¨éƒ¨æˆäº¤ã€‚\n3. ä¸¾ä¸ªä¾‹å­ï¼ˆå¼€ç›˜é›†åˆç«ä»·ï¼‰ï¼š\nå‡è®¾æŸè‚¡ç¥¨å‰æ”¶ç›˜ä»·ä¸º10.00å…ƒã€‚åœ¨9:15-9:25æœŸé—´ï¼Œå¤§å®¶çº·çº·æŒ‚å•ï¼š\næœ‰äººæ„¿ä»¥10.10å…ƒä¹°å…¥500æ‰‹\næœ‰äººæ„¿ä»¥10.05å…ƒä¹°å…¥800æ‰‹\næœ‰äººæ„¿ä»¥10.00å…ƒä¹°å…¥1000æ‰‹\næœ‰äººæ„¿ä»¥10.00å…ƒå–å‡º600æ‰‹\næœ‰äººæ„¿ä»¥10.05å…ƒå–å‡º700æ‰‹\næœ‰äººæ„¿ä»¥10.10å…ƒå–å‡º900æ‰‹\nç³»ç»Ÿä¼šå°è¯•10.10å…ƒã€10.05å…ƒã€10.00å…ƒç­‰å¤šä¸ªä»·æ ¼ï¼Œè®¡ç®—åœ¨æ¯ä¸ªä»·æ ¼ä¸‹èƒ½æˆäº¤å¤šå°‘æ‰‹ã€‚æœ€ç»ˆå‘ç°ï¼Œåœ¨10.05å…ƒè¿™ä¸ªä»·æ ¼æ—¶ï¼Œèƒ½å®ç°çš„æˆäº¤é‡æœ€å¤§ï¼ˆä¾‹å¦‚800æ‰‹ï¼‰ã€‚é‚£ä¹ˆï¼Œ10.05å…ƒå°±è¢«ç¡®å®šä¸ºå½“æ—¥çš„å¼€ç›˜ä»·ã€‚æ‰€æœ‰ç¬¦åˆæ¡ä»¶ï¼ˆä¹°å•ä»·â‰¥10.05å…ƒï¼Œå–å•ä»·â‰¤10.05å…ƒï¼‰çš„å§”æ‰˜å•éƒ½æŒ‰10.05å…ƒæˆäº¤ã€‚\n4. ç‰¹ç‚¹æ€»ç»“ï¼š\nä»·æ ¼å”¯ä¸€ï¼šå½¢æˆä¸€ä¸ªç»Ÿä¸€çš„ä»·æ ¼ï¼ˆå¼€ç›˜ä»·/æ”¶ç›˜ä»·ï¼‰ã€‚\næ—¶é—´é©±åŠ¨ï¼šåˆ°ç‚¹äº†æ‰ç»Ÿä¸€å¤„ç†ã€‚\né˜²æ­¢æ“çºµï¼šæ”¶ç›˜é›†åˆç«ä»·èƒ½æœ‰æ•ˆé˜²æ­¢åœ¨æ”¶ç›˜æœ€åä¸€åˆ»é€šè¿‡å¤§å¹…æ‹‰æŠ¬æˆ–æ‰“å‹è‚¡ä»·æ¥æ“çºµæ”¶ç›˜ä»·çš„è¡Œä¸ºã€‚\näºŒã€è¿ç»­ç«ä»· è¿ç»­ç«ä»·æ˜¯äº¤æ˜“æ—¥ä¸­æœ€ä¸»è¦çš„äº¤æ˜“æ–¹å¼ï¼Œæˆ‘ä»¬å¹³æ—¶çœ‹ç›˜æ—¶çš„å®æ—¶ä»·æ ¼æ³¢åŠ¨å°±æ˜¯åœ¨è¿ç»­ç«ä»·ä¸­äº§ç”Ÿçš„ã€‚\n1. å‘ç”Ÿæ—¶é—´ï¼š\næ—©å¸‚ï¼š9:30 - 11:30 ï¼ˆå¼€ç›˜é›†åˆç«ä»·ç»“æŸåç«‹å³å¼€å§‹ï¼‰\nåˆå¸‚ï¼š13:00 - 14:57 ï¼ˆå¯¹äºæœ‰æ”¶ç›˜é›†åˆç«ä»·çš„æ·±å¸‚ç­‰ï¼‰\n2. æ ¸å¿ƒè§„åˆ™ï¼š\nä»·æ ¼ä¼˜å…ˆï¼šè¾ƒé«˜çš„ä¹°è¿›ç”³æŠ¥ä¼˜å…ˆäºè¾ƒä½çš„ä¹°è¿›ç”³æŠ¥ï¼›è¾ƒä½çš„å–å‡ºç”³æŠ¥ä¼˜å…ˆäºè¾ƒé«˜çš„å–å‡ºç”³æŠ¥ã€‚\næ—¶é—´ä¼˜å…ˆï¼šåŒä»·ä½çš„ç”³æŠ¥ï¼Œè°å…ˆæäº¤è®¢å•ï¼ˆæŒ‚å•æ—©ï¼‰ï¼Œè°å°±ä¼˜å…ˆæˆäº¤ã€‚\n3. æˆäº¤è¿‡ç¨‹ï¼š\næ–°è¿›å…¥çš„ä¹°å•ä¼šä¸å–å•é˜Ÿåˆ—ä¸­ä»·æ ¼æœ€ä½çš„å–å•ï¼ˆå–ä¸€ï¼‰æ¯”è¾ƒã€‚\næ–°è¿›å…¥çš„å–å•ä¼šä¸ä¹°å•é˜Ÿåˆ—ä¸­ä»·æ ¼æœ€é«˜çš„ä¹°å•ï¼ˆä¹°ä¸€ï¼‰æ¯”è¾ƒã€‚\nåªè¦æŠ¥å•ä»·æ ¼åŒ¹é…ï¼ˆä¹°ä»· â‰¥ å–ä»·ï¼‰ï¼Œå°±ç«‹å³æˆäº¤ã€‚\n4. ä¸¾ä¸ªä¾‹å­ï¼š\nå‡è®¾æŸè‚¡ç¥¨å®æ—¶äº”æ¡£è¡Œæƒ…ä¸ºï¼š\nå–äº” \u0026hellip; 10.10\nå–å›› \u0026hellip; 10.09\n","date":"2025-09-04T22:55:17+08:00","permalink":"https://zhangquanhua1.github.io/p/%E9%9B%86%E4%B8%AD%E7%AB%9E%E4%BB%B7%E4%B8%8E%E8%BF%9E%E7%BB%AD%E7%AB%9E%E4%BB%B7/","title":"é›†ä¸­ç«ä»·ä¸è¿ç»­ç«ä»·"}]